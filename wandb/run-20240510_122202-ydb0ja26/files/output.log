2024-05-10 12:22:04,041	WARNING algorithm_config.py:3959 -- You have specified 1 evaluation workers, but your `evaluation_interval` is 0 or None! Therefore, evaluation will not occur automatically with each call to `Algorithm.train()`. Instead, you will have to call `Algorithm.evaluate()` manually in order to trigger an evaluation run.
C:\Users\riyaa\Documents\Uni Stuff\Masters\Semester 2\Subjects\Deep Reinforcement Learning\CW_Individual\INM707_CW_Individual_Task\INM707_CW_env\Lib\site-packages\ray\rllib\algorithms\algorithm.py:525: RayDeprecationWarning: This API is deprecated and may be removed in future Ray releases. You could suppress this warning by setting env variable PYTHONWARNINGS="ignore::DeprecationWarning"
`UnifiedLogger` will be removed in Ray 2.7.
  return UnifiedLogger(config, logdir, loggers=None)
C:\Users\riyaa\Documents\Uni Stuff\Masters\Semester 2\Subjects\Deep Reinforcement Learning\CW_Individual\INM707_CW_Individual_Task\INM707_CW_env\Lib\site-packages\ray\tune\logger\unified.py:53: RayDeprecationWarning: This API is deprecated and may be removed in future Ray releases. You could suppress this warning by setting env variable PYTHONWARNINGS="ignore::DeprecationWarning"
The `JsonLogger interface is deprecated in favor of the `ray.tune.json.JsonLoggerCallback` interface and will be removed in Ray 2.7.
  self._loggers.append(cls(self.config, self.logdir, self.trial))
C:\Users\riyaa\Documents\Uni Stuff\Masters\Semester 2\Subjects\Deep Reinforcement Learning\CW_Individual\INM707_CW_Individual_Task\INM707_CW_env\Lib\site-packages\ray\tune\logger\unified.py:53: RayDeprecationWarning: This API is deprecated and may be removed in future Ray releases. You could suppress this warning by setting env variable PYTHONWARNINGS="ignore::DeprecationWarning"
The `CSVLogger interface is deprecated in favor of the `ray.tune.csv.CSVLoggerCallback` interface and will be removed in Ray 2.7.
  self._loggers.append(cls(self.config, self.logdir, self.trial))
C:\Users\riyaa\Documents\Uni Stuff\Masters\Semester 2\Subjects\Deep Reinforcement Learning\CW_Individual\INM707_CW_Individual_Task\INM707_CW_env\Lib\site-packages\ray\tune\logger\unified.py:53: RayDeprecationWarning: This API is deprecated and may be removed in future Ray releases. You could suppress this warning by setting env variable PYTHONWARNINGS="ignore::DeprecationWarning"
The `TBXLogger interface is deprecated in favor of the `ray.tune.tensorboardx.TBXLoggerCallback` interface and will be removed in Ray 2.7.
  self._loggers.append(cls(self.config, self.logdir, self.trial))
2024-05-10 12:22:04,070	WARNING deprecation.py:50 -- DeprecationWarning: `max_num_worker_restarts` has been deprecated. Use `AlgorithmConfig.max_num_env_runner_restarts` instead. This will raise an error in the future!
2024-05-10 12:22:05,854	INFO worker.py:1749 -- Started a local Ray instance.
[36m(RolloutWorker pid=12460)[39m A.L.E: Arcade Learning Environment (version 0.8.1+53f58b7)
[36m(RolloutWorker pid=12460)[39m [Powered by Stella]
[36m(RolloutWorker pid=12460)[39m C:\Users\riyaa\Documents\Uni Stuff\Masters\Semester 2\Subjects\Deep Reinforcement Learning\CW_Individual\INM707_CW_Individual_Task\INM707_CW_env\Lib\site-packages\gymnasium\core.py:311: UserWarning: [33mWARN: env.single_observation_space to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.single_observation_space` for environment variables or `env.get_wrapper_attr('single_observation_space')` that will search the reminding wrappers.
[36m(RolloutWorker pid=12460)[39m   logger.warn(
[36m(RolloutWorker pid=12460)[39m C:\Users\riyaa\Documents\Uni Stuff\Masters\Semester 2\Subjects\Deep Reinforcement Learning\CW_Individual\INM707_CW_Individual_Task\INM707_CW_env\Lib\site-packages\gymnasium\core.py:311: UserWarning: [33mWARN: env.single_action_space to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.single_action_space` for environment variables or `env.get_wrapper_attr('single_action_space')` that will search the reminding wrappers.
[36m(RolloutWorker pid=12460)[39m   logger.warn(
[36m(RolloutWorker pid=21236)[39m 2024-05-10 12:22:12,487	WARNING deprecation.py:50 -- DeprecationWarning: `num_envs_per_worker` has been deprecated. Use `AlgorithmConfig.num_envs_per_env_runner` instead. This will raise an error in the future!
[36m(RolloutWorker pid=12460)[39m C:\Users\riyaa\Documents\Uni Stuff\Masters\Semester 2\Subjects\Deep Reinforcement Learning\CW_Individual\INM707_CW_Individual_Task\INM707_CW_env\Lib\site-packages\torch\nn\modules\conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at ..\aten\src\ATen\native\cudnn\Conv_v8.cpp:919.)
[36m(RolloutWorker pid=12460)[39m   return F.conv2d(input, weight, bias, self.stride,
2024-05-10 12:22:14,137	WARNING deprecation.py:50 -- DeprecationWarning: `num_envs_per_worker` has been deprecated. Use `AlgorithmConfig.num_envs_per_env_runner` instead. This will raise an error in the future!
2024-05-10 12:22:15,419	WARNING algorithm_config.py:3959 -- You have specified 1 evaluation workers, but your `evaluation_interval` is 0 or None! Therefore, evaluation will not occur automatically with each call to `Algorithm.train()`. Instead, you will have to call `Algorithm.evaluate()` manually in order to trigger an evaluation run.
[36m(RolloutWorker pid=22672)[39m A.L.E: Arcade Learning Environment (version 0.8.1+53f58b7)[32m [repeated 2x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)
[36m(RolloutWorker pid=22672)[39m [Powered by Stella][32m [repeated 2x across cluster]
[36m(RolloutWorker pid=21236)[39m C:\Users\riyaa\Documents\Uni Stuff\Masters\Semester 2\Subjects\Deep Reinforcement Learning\CW_Individual\INM707_CW_Individual_Task\INM707_CW_env\Lib\site-packages\gymnasium\core.py:311: UserWarning: [33mWARN: env.single_observation_space to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.single_observation_space` for environment variables or `env.get_wrapper_attr('single_observation_space')` that will search the reminding wrappers.
[36m(RolloutWorker pid=21236)[39m   logger.warn([32m [repeated 2x across cluster]
[36m(RolloutWorker pid=21236)[39m C:\Users\riyaa\Documents\Uni Stuff\Masters\Semester 2\Subjects\Deep Reinforcement Learning\CW_Individual\INM707_CW_Individual_Task\INM707_CW_env\Lib\site-packages\gymnasium\core.py:311: UserWarning: [33mWARN: env.single_action_space to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.single_action_space` for environment variables or `env.get_wrapper_attr('single_action_space')` that will search the reminding wrappers.
[36m(RolloutWorker pid=21236)[39m C:\Users\riyaa\Documents\Uni Stuff\Masters\Semester 2\Subjects\Deep Reinforcement Learning\CW_Individual\INM707_CW_Individual_Task\INM707_CW_env\Lib\site-packages\torch\nn\modules\conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at ..\aten\src\ATen\native\cudnn\Conv_v8.cpp:919.)
[36m(RolloutWorker pid=21236)[39m   return F.conv2d(input, weight, bias, self.stride,
[36m(RolloutWorker pid=22672)[39m C:\Users\riyaa\Documents\Uni Stuff\Masters\Semester 2\Subjects\Deep Reinforcement Learning\CW_Individual\INM707_CW_Individual_Task\INM707_CW_env\Lib\site-packages\gymnasium\core.py:311: UserWarning: [33mWARN: env.single_observation_space to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.single_observation_space` for environment variables or `env.get_wrapper_attr('single_observation_space')` that will search the reminding wrappers.
[36m(RolloutWorker pid=22672)[39m C:\Users\riyaa\Documents\Uni Stuff\Masters\Semester 2\Subjects\Deep Reinforcement Learning\CW_Individual\INM707_CW_Individual_Task\INM707_CW_env\Lib\site-packages\gymnasium\core.py:311: UserWarning: [33mWARN: env.single_action_space to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.single_action_space` for environment variables or `env.get_wrapper_attr('single_action_space')` that will search the reminding wrappers.
[36m(RolloutWorker pid=22672)[39m C:\Users\riyaa\Documents\Uni Stuff\Masters\Semester 2\Subjects\Deep Reinforcement Learning\CW_Individual\INM707_CW_Individual_Task\INM707_CW_env\Lib\site-packages\torch\nn\modules\conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at ..\aten\src\ATen\native\cudnn\Conv_v8.cpp:919.)
[36m(RolloutWorker pid=22672)[39m   return F.conv2d(input, weight, bias, self.stride,
2024-05-10 12:22:21,590	INFO trainable.py:161 -- Trainable.setup took 17.522 seconds. If your trainable is slow to initialize, consider setting reuse_actors=True to reduce actor creation overheads.
2024-05-10 12:22:21,591	WARNING util.py:61 -- Install gputil for GPU system monitoring.
	Step: 0
2024-05-10 12:22:37,701	WARNING deprecation.py:50 -- DeprecationWarning: `ray.rllib.execution.train_ops.multi_gpu_train_one_step` has been deprecated. This will raise an error in the future!
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 0.9054737124231553, 'cur_kl_coeff': 0.20000000000000004, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.028853608988305572, 'policy_loss': -0.00812651544248545, 'vf_loss': 0.03502373407691804, 'vf_explained_var': 0.4820555610041464, 'kl': 0.0097819572278183, 'entropy': 1.3791790799428059, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 465.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 4000, 'num_env_steps_trained': 4000, 'num_agent_steps_sampled': 4000, 'num_agent_steps_trained': 4000}, 'sampler_results': {'episode_reward_max': 1.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 0.3333333333333333, 'episode_len_mean': 535.6666666666666, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 3214, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0], 'episode_lengths': [497, 489, 626, 492, 494, 616]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.544300143686549, 'mean_inference_ms': 7.080424195346327, 'mean_action_processing_ms': 0.11497494699000597, 'mean_env_wait_ms': 0.18244341336030592, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.18324454625447592, 'StateBufferConnector_ms': 0.01664559046427409, 'ViewRequirementAgentConnector_ms': 0.034236907958984375}, 'num_episodes': 6, 'episode_return_max': 1.0, 'episode_return_min': 0.0, 'episode_return_mean': 0.3333333333333333}, 'env_runner_results': {'episode_reward_max': 1.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 0.3333333333333333, 'episode_len_mean': 535.6666666666666, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 3214, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0], 'episode_lengths': [497, 489, 626, 492, 494, 616]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.544300143686549, 'mean_inference_ms': 7.080424195346327, 'mean_action_processing_ms': 0.11497494699000597, 'mean_env_wait_ms': 0.18244341336030592, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.18324454625447592, 'StateBufferConnector_ms': 0.01664559046427409, 'ViewRequirementAgentConnector_ms': 0.034236907958984375}, 'num_episodes': 6, 'episode_return_max': 1.0, 'episode_return_min': 0.0, 'episode_return_mean': 0.3333333333333333}, 'episode_reward_max': 1.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 0.3333333333333333, 'episode_len_mean': 535.6666666666666, 'episodes_this_iter': 6, 'episodes_timesteps_total': 3214, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0], 'episode_lengths': [497, 489, 626, 492, 494, 616]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.544300143686549, 'mean_inference_ms': 7.080424195346327, 'mean_action_processing_ms': 0.11497494699000597, 'mean_env_wait_ms': 0.18244341336030592, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.18324454625447592, 'StateBufferConnector_ms': 0.01664559046427409, 'ViewRequirementAgentConnector_ms': 0.034236907958984375}, 'num_episodes': 6, 'episode_return_max': 1.0, 'episode_return_min': 0.0, 'episode_return_mean': 0.3333333333333333, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 4000, 'num_agent_steps_trained': 4000, 'num_env_steps_sampled': 4000, 'num_env_steps_trained': 4000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 38.1244116265792, 'num_env_steps_trained_throughput_per_sec': 38.1244116265792, 'timesteps_total': 4000, 'num_env_steps_sampled_lifetime': 4000, 'num_agent_steps_sampled_lifetime': 4000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 4000, 'timers': {'training_iteration_time_ms': 104919.652, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 104919.652, 'sample_time_ms': 16103.642, 'load_time_ms': 1.014, 'load_throughput': 3943868.359, 'learn_time_ms': 88798.162, 'learn_throughput': 45.046, 'synch_weights_time_ms': 15.155}, 'counters': {'num_env_steps_sampled': 4000, 'num_env_steps_trained': 4000, 'num_agent_steps_sampled': 4000, 'num_agent_steps_trained': 4000}, 'done': False, 'episodes_total': 6, 'training_iteration': 1, 'trial_id': 'default', 'date': '2024-05-10_12-24-06', 'timestamp': 1715340246, 'time_this_iter_s': 104.96208167076111, 'time_total_s': 104.96208167076111, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 104.96208167076111, 'iterations_since_restore': 1, 'perf': {'cpu_util_percent': 41.4261744966443, 'ram_util_percent': 91.44429530201343}}
Saving weights...
	Step: 1
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.117622903678366, 'cur_kl_coeff': 0.20000000000000004, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.05270874811917223, 'policy_loss': -0.005341565689092042, 'vf_loss': 0.05647257226307634, 'vf_explained_var': -0.10343843410092016, 'kl': 0.007888705449856235, 'entropy': 1.3616654712666747, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 1395.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 8000, 'num_env_steps_trained': 8000, 'num_agent_steps_sampled': 8000, 'num_agent_steps_trained': 8000}, 'sampler_results': {'episode_reward_max': 2.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 0.75, 'episode_len_mean': 602.0, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 7224, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0], 'episode_lengths': [497, 489, 626, 492, 494, 616, 501, 791, 619, 687, 620, 792]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.564426832922818, 'mean_inference_ms': 7.511503755688033, 'mean_action_processing_ms': 0.11574276803165938, 'mean_env_wait_ms': 0.1886118527044379, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.19408265749613443, 'StateBufferConnector_ms': 0.025345881779988606, 'ViewRequirementAgentConnector_ms': 0.10133981704711914}, 'num_episodes': 6, 'episode_return_max': 2.0, 'episode_return_min': 0.0, 'episode_return_mean': 0.75}, 'env_runner_results': {'episode_reward_max': 2.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 0.75, 'episode_len_mean': 602.0, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 7224, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0], 'episode_lengths': [497, 489, 626, 492, 494, 616, 501, 791, 619, 687, 620, 792]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.564426832922818, 'mean_inference_ms': 7.511503755688033, 'mean_action_processing_ms': 0.11574276803165938, 'mean_env_wait_ms': 0.1886118527044379, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.19408265749613443, 'StateBufferConnector_ms': 0.025345881779988606, 'ViewRequirementAgentConnector_ms': 0.10133981704711914}, 'num_episodes': 6, 'episode_return_max': 2.0, 'episode_return_min': 0.0, 'episode_return_mean': 0.75}, 'episode_reward_max': 2.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 0.75, 'episode_len_mean': 602.0, 'episodes_this_iter': 6, 'episodes_timesteps_total': 7224, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0], 'episode_lengths': [497, 489, 626, 492, 494, 616, 501, 791, 619, 687, 620, 792]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.564426832922818, 'mean_inference_ms': 7.511503755688033, 'mean_action_processing_ms': 0.11574276803165938, 'mean_env_wait_ms': 0.1886118527044379, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.19408265749613443, 'StateBufferConnector_ms': 0.025345881779988606, 'ViewRequirementAgentConnector_ms': 0.10133981704711914}, 'num_episodes': 6, 'episode_return_max': 2.0, 'episode_return_min': 0.0, 'episode_return_mean': 0.75, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 8000, 'num_agent_steps_trained': 8000, 'num_env_steps_sampled': 8000, 'num_env_steps_trained': 8000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 30.347303696407028, 'num_env_steps_trained_throughput_per_sec': 30.347303696407028, 'timesteps_total': 8000, 'num_env_steps_sampled_lifetime': 8000, 'num_agent_steps_sampled_lifetime': 8000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 8000, 'timers': {'training_iteration_time_ms': 118363.539, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 118363.539, 'sample_time_ms': 17899.09, 'load_time_ms': 6.866, 'load_throughput': 582582.679, 'learn_time_ms': 100444.132, 'learn_throughput': 39.823, 'synch_weights_time_ms': 12.612}, 'counters': {'num_env_steps_sampled': 8000, 'num_env_steps_trained': 8000, 'num_agent_steps_sampled': 8000, 'num_agent_steps_trained': 8000}, 'done': False, 'episodes_total': 12, 'training_iteration': 2, 'trial_id': 'default', 'date': '2024-05-10_12-26-18', 'timestamp': 1715340378, 'time_this_iter_s': 131.83536744117737, 'time_total_s': 236.79744911193848, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 236.79744911193848, 'iterations_since_restore': 2, 'perf': {'cpu_util_percent': 41.21176470588235, 'ram_util_percent': 88.34117647058824}}
	Step: 2
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.0513964495671693, 'cur_kl_coeff': 0.20000000000000004, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.05138160096736805, 'policy_loss': -0.0009274544146773155, 'vf_loss': 0.05156381278144201, 'vf_explained_var': -0.46058198867305633, 'kl': 0.0037262250972582944, 'entropy': 1.3687223870267151, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 2325.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 12000, 'num_env_steps_trained': 12000, 'num_agent_steps_sampled': 12000, 'num_agent_steps_trained': 12000}, 'sampler_results': {'episode_reward_max': 3.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 0.631578947368421, 'episode_len_mean': 588.3684210526316, 'episode_media': {}, 'episodes_this_iter': 7, 'episodes_timesteps_total': 11179, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0], 'episode_lengths': [497, 489, 626, 492, 494, 616, 501, 791, 619, 687, 620, 792, 500, 493, 984, 495, 500, 492, 491]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5646048057111267, 'mean_inference_ms': 7.773291654414219, 'mean_action_processing_ms': 0.11536664148464293, 'mean_env_wait_ms': 0.19240975577351777, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.17661671889455696, 'StateBufferConnector_ms': 0.016007925334729646, 'ViewRequirementAgentConnector_ms': 0.13952882666336863}, 'num_episodes': 7, 'episode_return_max': 3.0, 'episode_return_min': 0.0, 'episode_return_mean': 0.631578947368421}, 'env_runner_results': {'episode_reward_max': 3.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 0.631578947368421, 'episode_len_mean': 588.3684210526316, 'episode_media': {}, 'episodes_this_iter': 7, 'episodes_timesteps_total': 11179, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0], 'episode_lengths': [497, 489, 626, 492, 494, 616, 501, 791, 619, 687, 620, 792, 500, 493, 984, 495, 500, 492, 491]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5646048057111267, 'mean_inference_ms': 7.773291654414219, 'mean_action_processing_ms': 0.11536664148464293, 'mean_env_wait_ms': 0.19240975577351777, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.17661671889455696, 'StateBufferConnector_ms': 0.016007925334729646, 'ViewRequirementAgentConnector_ms': 0.13952882666336863}, 'num_episodes': 7, 'episode_return_max': 3.0, 'episode_return_min': 0.0, 'episode_return_mean': 0.631578947368421}, 'episode_reward_max': 3.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 0.631578947368421, 'episode_len_mean': 588.3684210526316, 'episodes_this_iter': 7, 'episodes_timesteps_total': 11179, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0], 'episode_lengths': [497, 489, 626, 492, 494, 616, 501, 791, 619, 687, 620, 792, 500, 493, 984, 495, 500, 492, 491]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5646048057111267, 'mean_inference_ms': 7.773291654414219, 'mean_action_processing_ms': 0.11536664148464293, 'mean_env_wait_ms': 0.19240975577351777, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.17661671889455696, 'StateBufferConnector_ms': 0.016007925334729646, 'ViewRequirementAgentConnector_ms': 0.13952882666336863}, 'num_episodes': 7, 'episode_return_max': 3.0, 'episode_return_min': 0.0, 'episode_return_mean': 0.631578947368421, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 12000, 'num_agent_steps_trained': 12000, 'num_env_steps_sampled': 12000, 'num_env_steps_trained': 12000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 30.22554297321554, 'num_env_steps_trained_throughput_per_sec': 30.22554297321554, 'timesteps_total': 12000, 'num_env_steps_sampled_lifetime': 12000, 'num_agent_steps_sampled_lifetime': 12000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 12000, 'timers': {'training_iteration_time_ms': 123021.826, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 123021.826, 'sample_time_ms': 18405.716, 'load_time_ms': 5.577, 'load_throughput': 717199.806, 'learn_time_ms': 104596.899, 'learn_throughput': 38.242, 'synch_weights_time_ms': 12.741}, 'counters': {'num_env_steps_sampled': 12000, 'num_env_steps_trained': 12000, 'num_agent_steps_sampled': 12000, 'num_agent_steps_trained': 12000}, 'done': False, 'episodes_total': 19, 'training_iteration': 3, 'trial_id': 'default', 'date': '2024-05-10_12-28-30', 'timestamp': 1715340510, 'time_this_iter_s': 132.36510467529297, 'time_total_s': 369.16255378723145, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 369.16255378723145, 'iterations_since_restore': 3, 'perf': {'cpu_util_percent': 39.44919786096256, 'ram_util_percent': 88.6101604278075}}
	Step: 3
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.090180685389186, 'cur_kl_coeff': 0.10000000000000002, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.058184788016269424, 'policy_loss': -0.007438997035065005, 'vf_loss': 0.06407861185375281, 'vf_explained_var': -0.0413131244080041, 'kl': 0.015451731449591466, 'entropy': 1.36074420444427, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 3255.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 16000, 'num_env_steps_trained': 16000, 'num_agent_steps_sampled': 16000, 'num_agent_steps_trained': 16000}, 'sampler_results': {'episode_reward_max': 3.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 0.76, 'episode_len_mean': 606.36, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 15159, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0], 'episode_lengths': [497, 489, 626, 492, 494, 616, 501, 791, 619, 687, 620, 792, 500, 493, 984, 495, 500, 492, 491, 490, 493, 491, 984, 717, 805]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5617703606009228, 'mean_inference_ms': 7.894572753805275, 'mean_action_processing_ms': 0.11473679799534484, 'mean_env_wait_ms': 0.1932285562170077, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.17626571655273438, 'StateBufferConnector_ms': 0.012166023254394531, 'ViewRequirementAgentConnector_ms': 0.14207077026367188}, 'num_episodes': 6, 'episode_return_max': 3.0, 'episode_return_min': 0.0, 'episode_return_mean': 0.76}, 'env_runner_results': {'episode_reward_max': 3.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 0.76, 'episode_len_mean': 606.36, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 15159, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0], 'episode_lengths': [497, 489, 626, 492, 494, 616, 501, 791, 619, 687, 620, 792, 500, 493, 984, 495, 500, 492, 491, 490, 493, 491, 984, 717, 805]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5617703606009228, 'mean_inference_ms': 7.894572753805275, 'mean_action_processing_ms': 0.11473679799534484, 'mean_env_wait_ms': 0.1932285562170077, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.17626571655273438, 'StateBufferConnector_ms': 0.012166023254394531, 'ViewRequirementAgentConnector_ms': 0.14207077026367188}, 'num_episodes': 6, 'episode_return_max': 3.0, 'episode_return_min': 0.0, 'episode_return_mean': 0.76}, 'episode_reward_max': 3.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 0.76, 'episode_len_mean': 606.36, 'episodes_this_iter': 6, 'episodes_timesteps_total': 15159, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0], 'episode_lengths': [497, 489, 626, 492, 494, 616, 501, 791, 619, 687, 620, 792, 500, 493, 984, 495, 500, 492, 491, 490, 493, 491, 984, 717, 805]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5617703606009228, 'mean_inference_ms': 7.894572753805275, 'mean_action_processing_ms': 0.11473679799534484, 'mean_env_wait_ms': 0.1932285562170077, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.17626571655273438, 'StateBufferConnector_ms': 0.012166023254394531, 'ViewRequirementAgentConnector_ms': 0.14207077026367188}, 'num_episodes': 6, 'episode_return_max': 3.0, 'episode_return_min': 0.0, 'episode_return_mean': 0.76, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 16000, 'num_agent_steps_trained': 16000, 'num_env_steps_sampled': 16000, 'num_env_steps_trained': 16000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 29.382727783840398, 'num_env_steps_trained_throughput_per_sec': 29.382727783840398, 'timesteps_total': 16000, 'num_env_steps_sampled_lifetime': 16000, 'num_agent_steps_sampled_lifetime': 16000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 16000, 'timers': {'training_iteration_time_ms': 126299.969, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 126299.969, 'sample_time_ms': 18459.796, 'load_time_ms': 4.932, 'load_throughput': 810983.251, 'learn_time_ms': 107821.114, 'learn_throughput': 37.098, 'synch_weights_time_ms': 12.86}, 'counters': {'num_env_steps_sampled': 16000, 'num_env_steps_trained': 16000, 'num_agent_steps_sampled': 16000, 'num_agent_steps_trained': 16000}, 'done': False, 'episodes_total': 25, 'training_iteration': 4, 'trial_id': 'default', 'date': '2024-05-10_12-30-47', 'timestamp': 1715340647, 'time_this_iter_s': 136.16239762306213, 'time_total_s': 505.3249514102936, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 505.3249514102936, 'iterations_since_restore': 4, 'perf': {'cpu_util_percent': 43.08082901554403, 'ram_util_percent': 89.71761658031087}}
	Step: 4
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.1053536447906687, 'cur_kl_coeff': 0.10000000000000002, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.0495663129804676, 'policy_loss': -0.015133538608619523, 'vf_loss': 0.06165415692896634, 'vf_explained_var': 0.12631141831797937, 'kl': 0.030456940179290178, 'entropy': 1.318903233287155, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 4185.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 20000, 'num_env_steps_trained': 20000, 'num_agent_steps_sampled': 20000, 'num_agent_steps_trained': 20000}, 'sampler_results': {'episode_reward_max': 3.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 0.8709677419354839, 'episode_len_mean': 621.8387096774194, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 19277, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0], 'episode_lengths': [497, 489, 626, 492, 494, 616, 501, 791, 619, 687, 620, 792, 500, 493, 984, 495, 500, 492, 491, 490, 493, 491, 984, 717, 805, 818, 604, 794, 614, 489, 799]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5585631057075628, 'mean_inference_ms': 7.967968012719598, 'mean_action_processing_ms': 0.11368725200950311, 'mean_env_wait_ms': 0.1933792454310694, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.18767464545465284, 'StateBufferConnector_ms': 0.009811309076124621, 'ViewRequirementAgentConnector_ms': 0.14368180305727066}, 'num_episodes': 6, 'episode_return_max': 3.0, 'episode_return_min': 0.0, 'episode_return_mean': 0.8709677419354839}, 'env_runner_results': {'episode_reward_max': 3.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 0.8709677419354839, 'episode_len_mean': 621.8387096774194, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 19277, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0], 'episode_lengths': [497, 489, 626, 492, 494, 616, 501, 791, 619, 687, 620, 792, 500, 493, 984, 495, 500, 492, 491, 490, 493, 491, 984, 717, 805, 818, 604, 794, 614, 489, 799]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5585631057075628, 'mean_inference_ms': 7.967968012719598, 'mean_action_processing_ms': 0.11368725200950311, 'mean_env_wait_ms': 0.1933792454310694, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.18767464545465284, 'StateBufferConnector_ms': 0.009811309076124621, 'ViewRequirementAgentConnector_ms': 0.14368180305727066}, 'num_episodes': 6, 'episode_return_max': 3.0, 'episode_return_min': 0.0, 'episode_return_mean': 0.8709677419354839}, 'episode_reward_max': 3.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 0.8709677419354839, 'episode_len_mean': 621.8387096774194, 'episodes_this_iter': 6, 'episodes_timesteps_total': 19277, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0], 'episode_lengths': [497, 489, 626, 492, 494, 616, 501, 791, 619, 687, 620, 792, 500, 493, 984, 495, 500, 492, 491, 490, 493, 491, 984, 717, 805, 818, 604, 794, 614, 489, 799]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5585631057075628, 'mean_inference_ms': 7.967968012719598, 'mean_action_processing_ms': 0.11368725200950311, 'mean_env_wait_ms': 0.1933792454310694, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.18767464545465284, 'StateBufferConnector_ms': 0.009811309076124621, 'ViewRequirementAgentConnector_ms': 0.14368180305727066}, 'num_episodes': 6, 'episode_return_max': 3.0, 'episode_return_min': 0.0, 'episode_return_mean': 0.8709677419354839, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 20000, 'num_agent_steps_trained': 20000, 'num_env_steps_sampled': 20000, 'num_env_steps_trained': 20000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 29.42955212953888, 'num_env_steps_trained_throughput_per_sec': 29.42955212953888, 'timesteps_total': 20000, 'num_env_steps_sampled_lifetime': 20000, 'num_agent_steps_sampled_lifetime': 20000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 20000, 'timers': {'training_iteration_time_ms': 128223.536, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 128223.536, 'sample_time_ms': 18420.913, 'load_time_ms': 4.547, 'load_throughput': 879631.731, 'learn_time_ms': 109783.973, 'learn_throughput': 36.435, 'synch_weights_time_ms': 12.888}, 'counters': {'num_env_steps_sampled': 20000, 'num_env_steps_trained': 20000, 'num_agent_steps_sampled': 20000, 'num_agent_steps_trained': 20000}, 'done': False, 'episodes_total': 31, 'training_iteration': 5, 'trial_id': 'default', 'date': '2024-05-10_12-33-03', 'timestamp': 1715340783, 'time_this_iter_s': 135.94606566429138, 'time_total_s': 641.271017074585, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 641.271017074585, 'iterations_since_restore': 5, 'perf': {'cpu_util_percent': 46.04922279792746, 'ram_util_percent': 89.22279792746114}}
	Step: 5
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 2.108755368515048, 'cur_kl_coeff': 0.15, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.18608702709773176, 'policy_loss': -0.009889456894128554, 'vf_loss': 0.19344541519030337, 'vf_explained_var': -0.29357514240408455, 'kl': 0.01687379668504724, 'entropy': 1.2626453732931486, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 5115.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 24000, 'num_env_steps_trained': 24000, 'num_agent_steps_sampled': 24000, 'num_agent_steps_trained': 24000}, 'sampler_results': {'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.054054054054054, 'episode_len_mean': 629.6486486486486, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 23297, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0], 'episode_lengths': [497, 489, 626, 492, 494, 616, 501, 791, 619, 687, 620, 792, 500, 493, 984, 495, 500, 492, 491, 490, 493, 491, 984, 717, 805, 818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5589948476904848, 'mean_inference_ms': 8.029895028094849, 'mean_action_processing_ms': 0.11314652424614577, 'mean_env_wait_ms': 0.1949770853015669, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.20331756488696948, 'StateBufferConnector_ms': 0.008220285982699008, 'ViewRequirementAgentConnector_ms': 0.13671952324944572}, 'num_episodes': 6, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.054054054054054}, 'env_runner_results': {'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.054054054054054, 'episode_len_mean': 629.6486486486486, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 23297, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0], 'episode_lengths': [497, 489, 626, 492, 494, 616, 501, 791, 619, 687, 620, 792, 500, 493, 984, 495, 500, 492, 491, 490, 493, 491, 984, 717, 805, 818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5589948476904848, 'mean_inference_ms': 8.029895028094849, 'mean_action_processing_ms': 0.11314652424614577, 'mean_env_wait_ms': 0.1949770853015669, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.20331756488696948, 'StateBufferConnector_ms': 0.008220285982699008, 'ViewRequirementAgentConnector_ms': 0.13671952324944572}, 'num_episodes': 6, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.054054054054054}, 'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.054054054054054, 'episode_len_mean': 629.6486486486486, 'episodes_this_iter': 6, 'episodes_timesteps_total': 23297, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0], 'episode_lengths': [497, 489, 626, 492, 494, 616, 501, 791, 619, 687, 620, 792, 500, 493, 984, 495, 500, 492, 491, 490, 493, 491, 984, 717, 805, 818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5589948476904848, 'mean_inference_ms': 8.029895028094849, 'mean_action_processing_ms': 0.11314652424614577, 'mean_env_wait_ms': 0.1949770853015669, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.20331756488696948, 'StateBufferConnector_ms': 0.008220285982699008, 'ViewRequirementAgentConnector_ms': 0.13671952324944572}, 'num_episodes': 6, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.054054054054054, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 24000, 'num_agent_steps_trained': 24000, 'num_env_steps_sampled': 24000, 'num_env_steps_trained': 24000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 27.45218258134496, 'num_env_steps_trained_throughput_per_sec': 27.45218258134496, 'timesteps_total': 24000, 'num_env_steps_sampled_lifetime': 24000, 'num_agent_steps_sampled_lifetime': 24000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 24000, 'timers': {'training_iteration_time_ms': 131137.597, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 131137.597, 'sample_time_ms': 18618.03, 'load_time_ms': 4.303, 'load_throughput': 929545.732, 'learn_time_ms': 112501.012, 'learn_throughput': 35.555, 'synch_weights_time_ms': 13.073}, 'counters': {'num_env_steps_sampled': 24000, 'num_env_steps_trained': 24000, 'num_agent_steps_sampled': 24000, 'num_agent_steps_trained': 24000}, 'done': False, 'episodes_total': 37, 'training_iteration': 6, 'trial_id': 'default', 'date': '2024-05-10_12-35-28', 'timestamp': 1715340928, 'time_this_iter_s': 145.736013174057, 'time_total_s': 787.007030248642, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 787.007030248642, 'iterations_since_restore': 6, 'perf': {'cpu_util_percent': 49.34417475728156, 'ram_util_percent': 89.32184466019419}}
	Step: 6
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.696302071357927, 'cur_kl_coeff': 0.15, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.08471333090571426, 'policy_loss': -0.007566089014853201, 'vf_loss': 0.08952402805218533, 'vf_explained_var': -0.12386617102930622, 'kl': 0.018369242580376848, 'entropy': 1.3186420709856095, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 6045.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 28000, 'num_env_steps_trained': 28000, 'num_agent_steps_sampled': 28000, 'num_agent_steps_trained': 28000}, 'sampler_results': {'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.2380952380952381, 'episode_len_mean': 659.0714285714286, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 27681, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0], 'episode_lengths': [497, 489, 626, 492, 494, 616, 501, 791, 619, 687, 620, 792, 500, 493, 984, 495, 500, 492, 491, 490, 493, 491, 984, 717, 805, 818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5604477463004089, 'mean_inference_ms': 8.073229568367756, 'mean_action_processing_ms': 0.11287453353872087, 'mean_env_wait_ms': 0.19668688063226009, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.21749167215256465, 'StateBufferConnector_ms': 0.007241680508568173, 'ViewRequirementAgentConnector_ms': 0.12755337215605236}, 'num_episodes': 5, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.2380952380952381}, 'env_runner_results': {'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.2380952380952381, 'episode_len_mean': 659.0714285714286, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 27681, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0], 'episode_lengths': [497, 489, 626, 492, 494, 616, 501, 791, 619, 687, 620, 792, 500, 493, 984, 495, 500, 492, 491, 490, 493, 491, 984, 717, 805, 818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5604477463004089, 'mean_inference_ms': 8.073229568367756, 'mean_action_processing_ms': 0.11287453353872087, 'mean_env_wait_ms': 0.19668688063226009, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.21749167215256465, 'StateBufferConnector_ms': 0.007241680508568173, 'ViewRequirementAgentConnector_ms': 0.12755337215605236}, 'num_episodes': 5, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.2380952380952381}, 'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.2380952380952381, 'episode_len_mean': 659.0714285714286, 'episodes_this_iter': 5, 'episodes_timesteps_total': 27681, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0], 'episode_lengths': [497, 489, 626, 492, 494, 616, 501, 791, 619, 687, 620, 792, 500, 493, 984, 495, 500, 492, 491, 490, 493, 491, 984, 717, 805, 818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5604477463004089, 'mean_inference_ms': 8.073229568367756, 'mean_action_processing_ms': 0.11287453353872087, 'mean_env_wait_ms': 0.19668688063226009, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.21749167215256465, 'StateBufferConnector_ms': 0.007241680508568173, 'ViewRequirementAgentConnector_ms': 0.12755337215605236}, 'num_episodes': 5, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.2380952380952381, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 28000, 'num_agent_steps_trained': 28000, 'num_env_steps_sampled': 28000, 'num_env_steps_trained': 28000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 27.917718734440424, 'num_env_steps_trained_throughput_per_sec': 27.917718734440424, 'timesteps_total': 28000, 'num_env_steps_sampled_lifetime': 28000, 'num_agent_steps_sampled_lifetime': 28000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 28000, 'timers': {'training_iteration_time_ms': 132871.967, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 132871.967, 'sample_time_ms': 18747.501, 'load_time_ms': 4.117, 'load_throughput': 971570.373, 'learn_time_ms': 114105.704, 'learn_throughput': 35.055, 'synch_weights_time_ms': 13.634}, 'counters': {'num_env_steps_sampled': 28000, 'num_env_steps_trained': 28000, 'num_agent_steps_sampled': 28000, 'num_agent_steps_trained': 28000}, 'done': False, 'episodes_total': 42, 'training_iteration': 7, 'trial_id': 'default', 'date': '2024-05-10_12-37-52', 'timestamp': 1715341072, 'time_this_iter_s': 143.3081829547882, 'time_total_s': 930.3152132034302, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 930.3152132034302, 'iterations_since_restore': 7, 'perf': {'cpu_util_percent': 45.98226600985222, 'ram_util_percent': 89.25320197044336}}
	Step: 7
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.5297123271891828, 'cur_kl_coeff': 0.15, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.06540383790289202, 'policy_loss': 0.0007162912207986078, 'vf_loss': 0.06429266451405154, 'vf_explained_var': -0.4366747082561575, 'kl': 0.002632536146343074, 'entropy': 1.3150085544073453, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 6975.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 32000, 'num_env_steps_trained': 32000, 'num_agent_steps_sampled': 32000, 'num_agent_steps_trained': 32000}, 'sampler_results': {'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.1458333333333333, 'episode_len_mean': 647.2083333333334, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 31066, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0], 'episode_lengths': [497, 489, 626, 492, 494, 616, 501, 791, 619, 687, 620, 792, 500, 493, 984, 495, 500, 492, 491, 490, 493, 491, 984, 717, 805, 818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5632308094949817, 'mean_inference_ms': 8.120580994675509, 'mean_action_processing_ms': 0.1129795525624721, 'mean_env_wait_ms': 0.19904647218911117, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.21311293045679727, 'StateBufferConnector_ms': 0.006336470444997151, 'ViewRequirementAgentConnector_ms': 0.12260476748148601}, 'num_episodes': 6, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.1458333333333333}, 'env_runner_results': {'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.1458333333333333, 'episode_len_mean': 647.2083333333334, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 31066, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0], 'episode_lengths': [497, 489, 626, 492, 494, 616, 501, 791, 619, 687, 620, 792, 500, 493, 984, 495, 500, 492, 491, 490, 493, 491, 984, 717, 805, 818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5632308094949817, 'mean_inference_ms': 8.120580994675509, 'mean_action_processing_ms': 0.1129795525624721, 'mean_env_wait_ms': 0.19904647218911117, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.21311293045679727, 'StateBufferConnector_ms': 0.006336470444997151, 'ViewRequirementAgentConnector_ms': 0.12260476748148601}, 'num_episodes': 6, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.1458333333333333}, 'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.1458333333333333, 'episode_len_mean': 647.2083333333334, 'episodes_this_iter': 6, 'episodes_timesteps_total': 31066, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0], 'episode_lengths': [497, 489, 626, 492, 494, 616, 501, 791, 619, 687, 620, 792, 500, 493, 984, 495, 500, 492, 491, 490, 493, 491, 984, 717, 805, 818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5632308094949817, 'mean_inference_ms': 8.120580994675509, 'mean_action_processing_ms': 0.1129795525624721, 'mean_env_wait_ms': 0.19904647218911117, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.21311293045679727, 'StateBufferConnector_ms': 0.006336470444997151, 'ViewRequirementAgentConnector_ms': 0.12260476748148601}, 'num_episodes': 6, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.1458333333333333, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 32000, 'num_agent_steps_trained': 32000, 'num_env_steps_sampled': 32000, 'num_env_steps_trained': 32000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 29.036035904582118, 'num_env_steps_trained_throughput_per_sec': 29.036035904582118, 'timesteps_total': 32000, 'num_env_steps_sampled_lifetime': 32000, 'num_agent_steps_sampled_lifetime': 32000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 32000, 'timers': {'training_iteration_time_ms': 133482.952, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 133482.952, 'sample_time_ms': 18904.841, 'load_time_ms': 4.227, 'load_throughput': 946248.135, 'learn_time_ms': 114559.194, 'learn_throughput': 34.916, 'synch_weights_time_ms': 13.68}, 'counters': {'num_env_steps_sampled': 32000, 'num_env_steps_trained': 32000, 'num_agent_steps_sampled': 32000, 'num_agent_steps_trained': 32000}, 'done': False, 'episodes_total': 48, 'training_iteration': 8, 'trial_id': 'default', 'date': '2024-05-10_12-40-10', 'timestamp': 1715341210, 'time_this_iter_s': 137.7979679107666, 'time_total_s': 1068.1131811141968, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 1068.1131811141968, 'iterations_since_restore': 8, 'perf': {'cpu_util_percent': 35.465306122448986, 'ram_util_percent': 88.46887755102041}}
	Step: 8
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.6288760442246673, 'cur_kl_coeff': 0.075, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.0626843672926708, 'policy_loss': -0.005358155552418001, 'vf_loss': 0.0673094612367261, 'vf_explained_var': -0.19675336486549788, 'kl': 0.00977411132439194, 'entropy': 1.2983526168331023, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 7905.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 36000, 'num_env_steps_trained': 36000, 'num_agent_steps_sampled': 36000, 'num_agent_steps_trained': 36000}, 'sampler_results': {'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.2641509433962264, 'episode_len_mean': 662.5283018867924, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 35114, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0], 'episode_lengths': [497, 489, 626, 492, 494, 616, 501, 791, 619, 687, 620, 792, 500, 493, 984, 495, 500, 492, 491, 490, 493, 491, 984, 717, 805, 818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5643074481965937, 'mean_inference_ms': 8.15262366565064, 'mean_action_processing_ms': 0.11300611716830378, 'mean_env_wait_ms': 0.20016103221849196, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.21503286541632885, 'StateBufferConnector_ms': 0.005738690214337043, 'ViewRequirementAgentConnector_ms': 0.11745443883931862}, 'num_episodes': 5, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.2641509433962264}, 'env_runner_results': {'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.2641509433962264, 'episode_len_mean': 662.5283018867924, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 35114, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0], 'episode_lengths': [497, 489, 626, 492, 494, 616, 501, 791, 619, 687, 620, 792, 500, 493, 984, 495, 500, 492, 491, 490, 493, 491, 984, 717, 805, 818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5643074481965937, 'mean_inference_ms': 8.15262366565064, 'mean_action_processing_ms': 0.11300611716830378, 'mean_env_wait_ms': 0.20016103221849196, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.21503286541632885, 'StateBufferConnector_ms': 0.005738690214337043, 'ViewRequirementAgentConnector_ms': 0.11745443883931862}, 'num_episodes': 5, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.2641509433962264}, 'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.2641509433962264, 'episode_len_mean': 662.5283018867924, 'episodes_this_iter': 5, 'episodes_timesteps_total': 35114, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0], 'episode_lengths': [497, 489, 626, 492, 494, 616, 501, 791, 619, 687, 620, 792, 500, 493, 984, 495, 500, 492, 491, 490, 493, 491, 984, 717, 805, 818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5643074481965937, 'mean_inference_ms': 8.15262366565064, 'mean_action_processing_ms': 0.11300611716830378, 'mean_env_wait_ms': 0.20016103221849196, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.21503286541632885, 'StateBufferConnector_ms': 0.005738690214337043, 'ViewRequirementAgentConnector_ms': 0.11745443883931862}, 'num_episodes': 5, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.2641509433962264, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 36000, 'num_agent_steps_trained': 36000, 'num_env_steps_sampled': 36000, 'num_env_steps_trained': 36000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 29.744633086909925, 'num_env_steps_trained_throughput_per_sec': 29.744633086909925, 'timesteps_total': 36000, 'num_env_steps_sampled_lifetime': 36000, 'num_agent_steps_sampled_lifetime': 36000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 36000, 'timers': {'training_iteration_time_ms': 133593.518, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 133593.518, 'sample_time_ms': 18895.509, 'load_time_ms': 4.413, 'load_throughput': 906348.518, 'learn_time_ms': 114678.845, 'learn_throughput': 34.88, 'synch_weights_time_ms': 13.853}, 'counters': {'num_env_steps_sampled': 36000, 'num_env_steps_trained': 36000, 'num_agent_steps_sampled': 36000, 'num_agent_steps_trained': 36000}, 'done': False, 'episodes_total': 53, 'training_iteration': 9, 'trial_id': 'default', 'date': '2024-05-10_12-42-24', 'timestamp': 1715341344, 'time_this_iter_s': 134.5099012851715, 'time_total_s': 1202.6230823993683, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 1202.6230823993683, 'iterations_since_restore': 9, 'perf': {'cpu_util_percent': 35.82263157894737, 'ram_util_percent': 88.01473684210526}}
	Step: 9
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.5866081378813233, 'cur_kl_coeff': 0.075, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.053669421474940034, 'policy_loss': -0.0036991131642172413, 'vf_loss': 0.05628856277213462, 'vf_explained_var': -0.40928639968236286, 'kl': 0.014399656522846157, 'entropy': 1.3214201920775956, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 8835.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 40000, 'num_env_steps_trained': 40000, 'num_agent_steps_sampled': 40000, 'num_agent_steps_trained': 40000}, 'sampler_results': {'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.271186440677966, 'episode_len_mean': 662.3898305084746, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 39081, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0], 'episode_lengths': [497, 489, 626, 492, 494, 616, 501, 791, 619, 687, 620, 792, 500, 493, 984, 495, 500, 492, 491, 490, 493, 491, 984, 717, 805, 818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.564707739093208, 'mean_inference_ms': 8.184875873925813, 'mean_action_processing_ms': 0.11291986083026087, 'mean_env_wait_ms': 0.201007961895704, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.21933620258913203, 'StateBufferConnector_ms': 0.005155094599319717, 'ViewRequirementAgentConnector_ms': 0.11526810920844643}, 'num_episodes': 6, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.271186440677966}, 'env_runner_results': {'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.271186440677966, 'episode_len_mean': 662.3898305084746, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 39081, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0], 'episode_lengths': [497, 489, 626, 492, 494, 616, 501, 791, 619, 687, 620, 792, 500, 493, 984, 495, 500, 492, 491, 490, 493, 491, 984, 717, 805, 818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.564707739093208, 'mean_inference_ms': 8.184875873925813, 'mean_action_processing_ms': 0.11291986083026087, 'mean_env_wait_ms': 0.201007961895704, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.21933620258913203, 'StateBufferConnector_ms': 0.005155094599319717, 'ViewRequirementAgentConnector_ms': 0.11526810920844643}, 'num_episodes': 6, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.271186440677966}, 'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.271186440677966, 'episode_len_mean': 662.3898305084746, 'episodes_this_iter': 6, 'episodes_timesteps_total': 39081, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0], 'episode_lengths': [497, 489, 626, 492, 494, 616, 501, 791, 619, 687, 620, 792, 500, 493, 984, 495, 500, 492, 491, 490, 493, 491, 984, 717, 805, 818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.564707739093208, 'mean_inference_ms': 8.184875873925813, 'mean_action_processing_ms': 0.11291986083026087, 'mean_env_wait_ms': 0.201007961895704, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.21933620258913203, 'StateBufferConnector_ms': 0.005155094599319717, 'ViewRequirementAgentConnector_ms': 0.11526810920844643}, 'num_episodes': 6, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.271186440677966, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 40000, 'num_agent_steps_trained': 40000, 'num_env_steps_sampled': 40000, 'num_env_steps_trained': 40000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 29.204693328234974, 'num_env_steps_trained_throughput_per_sec': 29.204693328234974, 'timesteps_total': 40000, 'num_env_steps_sampled_lifetime': 40000, 'num_agent_steps_sampled_lifetime': 40000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 40000, 'timers': {'training_iteration_time_ms': 133930.595, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 133930.595, 'sample_time_ms': 18899.983, 'load_time_ms': 4.328, 'load_throughput': 924206.664, 'learn_time_ms': 115011.708, 'learn_throughput': 34.779, 'synch_weights_time_ms': 13.668}, 'counters': {'num_env_steps_sampled': 40000, 'num_env_steps_trained': 40000, 'num_agent_steps_sampled': 40000, 'num_agent_steps_trained': 40000}, 'done': False, 'episodes_total': 59, 'training_iteration': 10, 'trial_id': 'default', 'date': '2024-05-10_12-44-41', 'timestamp': 1715341481, 'time_this_iter_s': 136.9932885169983, 'time_total_s': 1339.6163709163666, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 1339.6163709163666, 'iterations_since_restore': 10, 'perf': {'cpu_util_percent': 36.54278350515464, 'ram_util_percent': 87.95515463917528}}
	Step: 10
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.52066764628054, 'cur_kl_coeff': 0.075, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.061995027847187495, 'policy_loss': 0.011509931183630421, 'vf_loss': 0.0491917413097815, 'vf_explained_var': -0.6642232829524625, 'kl': 0.017244719652700195, 'entropy': 1.2972481235381095, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 9765.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 44000, 'num_env_steps_trained': 44000, 'num_agent_steps_sampled': 44000, 'num_agent_steps_trained': 44000}, 'sampler_results': {'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.2121212121212122, 'episode_len_mean': 656.3030303030303, 'episode_media': {}, 'episodes_this_iter': 7, 'episodes_timesteps_total': 43316, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0], 'episode_lengths': [497, 489, 626, 492, 494, 616, 501, 791, 619, 687, 620, 792, 500, 493, 984, 495, 500, 492, 491, 490, 493, 491, 984, 717, 805, 818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5649381892475885, 'mean_inference_ms': 8.216336856920886, 'mean_action_processing_ms': 0.11286438935290696, 'mean_env_wait_ms': 0.2015755119839425, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.21583347609548859, 'StateBufferConnector_ms': 0.004608342141816111, 'ViewRequirementAgentConnector_ms': 0.12189222104621655}, 'num_episodes': 7, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.2121212121212122}, 'env_runner_results': {'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.2121212121212122, 'episode_len_mean': 656.3030303030303, 'episode_media': {}, 'episodes_this_iter': 7, 'episodes_timesteps_total': 43316, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0], 'episode_lengths': [497, 489, 626, 492, 494, 616, 501, 791, 619, 687, 620, 792, 500, 493, 984, 495, 500, 492, 491, 490, 493, 491, 984, 717, 805, 818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5649381892475885, 'mean_inference_ms': 8.216336856920886, 'mean_action_processing_ms': 0.11286438935290696, 'mean_env_wait_ms': 0.2015755119839425, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.21583347609548859, 'StateBufferConnector_ms': 0.004608342141816111, 'ViewRequirementAgentConnector_ms': 0.12189222104621655}, 'num_episodes': 7, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.2121212121212122}, 'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.2121212121212122, 'episode_len_mean': 656.3030303030303, 'episodes_this_iter': 7, 'episodes_timesteps_total': 43316, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0], 'episode_lengths': [497, 489, 626, 492, 494, 616, 501, 791, 619, 687, 620, 792, 500, 493, 984, 495, 500, 492, 491, 490, 493, 491, 984, 717, 805, 818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5649381892475885, 'mean_inference_ms': 8.216336856920886, 'mean_action_processing_ms': 0.11286438935290696, 'mean_env_wait_ms': 0.2015755119839425, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.21583347609548859, 'StateBufferConnector_ms': 0.004608342141816111, 'ViewRequirementAgentConnector_ms': 0.12189222104621655}, 'num_episodes': 7, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.2121212121212122, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 44000, 'num_agent_steps_trained': 44000, 'num_env_steps_sampled': 44000, 'num_env_steps_trained': 44000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 29.70154639215684, 'num_env_steps_trained_throughput_per_sec': 29.70154639215684, 'timesteps_total': 44000, 'num_env_steps_sampled_lifetime': 44000, 'num_agent_steps_sampled_lifetime': 44000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 44000, 'timers': {'training_iteration_time_ms': 136905.942, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 136905.942, 'sample_time_ms': 19199.765, 'load_time_ms': 4.923, 'load_throughput': 812585.837, 'learn_time_ms': 117687.266, 'learn_throughput': 33.988, 'synch_weights_time_ms': 13.248}, 'counters': {'num_env_steps_sampled': 44000, 'num_env_steps_trained': 44000, 'num_agent_steps_sampled': 44000, 'num_agent_steps_trained': 44000}, 'done': False, 'episodes_total': 66, 'training_iteration': 11, 'trial_id': 'default', 'date': '2024-05-10_12-46-56', 'timestamp': 1715341616, 'time_this_iter_s': 134.71097683906555, 'time_total_s': 1474.3273477554321, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 1474.3273477554321, 'iterations_since_restore': 11, 'perf': {'cpu_util_percent': 39.616753926701584, 'ram_util_percent': 87.76701570680628}}
Saving weights...
	Step: 11
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.795413317186858, 'cur_kl_coeff': 0.075, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.04515614057740858, 'policy_loss': -0.007967651839698515, 'vf_loss': 0.052038862349347195, 'vf_explained_var': -0.3793278423047835, 'kl': 0.01446572667693556, 'entropy': 1.2648092794161971, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 10695.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 48000, 'num_env_steps_trained': 48000, 'num_agent_steps_sampled': 48000, 'num_agent_steps_trained': 48000}, 'sampler_results': {'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.2083333333333333, 'episode_len_mean': 655.3611111111111, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 47186, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0], 'episode_lengths': [497, 489, 626, 492, 494, 616, 501, 791, 619, 687, 620, 792, 500, 493, 984, 495, 500, 492, 491, 490, 493, 491, 984, 717, 805, 818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.564500933563185, 'mean_inference_ms': 8.237481912079195, 'mean_action_processing_ms': 0.11277266260269528, 'mean_env_wait_ms': 0.20185047670594422, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.21741787592569986, 'StateBufferConnector_ms': 0.005613432990180122, 'ViewRequirementAgentConnector_ms': 0.1228226555718316}, 'num_episodes': 6, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.2083333333333333}, 'env_runner_results': {'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.2083333333333333, 'episode_len_mean': 655.3611111111111, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 47186, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0], 'episode_lengths': [497, 489, 626, 492, 494, 616, 501, 791, 619, 687, 620, 792, 500, 493, 984, 495, 500, 492, 491, 490, 493, 491, 984, 717, 805, 818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.564500933563185, 'mean_inference_ms': 8.237481912079195, 'mean_action_processing_ms': 0.11277266260269528, 'mean_env_wait_ms': 0.20185047670594422, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.21741787592569986, 'StateBufferConnector_ms': 0.005613432990180122, 'ViewRequirementAgentConnector_ms': 0.1228226555718316}, 'num_episodes': 6, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.2083333333333333}, 'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.2083333333333333, 'episode_len_mean': 655.3611111111111, 'episodes_this_iter': 6, 'episodes_timesteps_total': 47186, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0], 'episode_lengths': [497, 489, 626, 492, 494, 616, 501, 791, 619, 687, 620, 792, 500, 493, 984, 495, 500, 492, 491, 490, 493, 491, 984, 717, 805, 818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.564500933563185, 'mean_inference_ms': 8.237481912079195, 'mean_action_processing_ms': 0.11277266260269528, 'mean_env_wait_ms': 0.20185047670594422, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.21741787592569986, 'StateBufferConnector_ms': 0.005613432990180122, 'ViewRequirementAgentConnector_ms': 0.1228226555718316}, 'num_episodes': 6, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.2083333333333333, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 48000, 'num_agent_steps_trained': 48000, 'num_env_steps_sampled': 48000, 'num_env_steps_trained': 48000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 27.99150111085387, 'num_env_steps_trained_throughput_per_sec': 27.99150111085387, 'timesteps_total': 48000, 'num_env_steps_sampled_lifetime': 48000, 'num_agent_steps_sampled_lifetime': 48000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 48000, 'timers': {'training_iteration_time_ms': 138015.251, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 138015.251, 'sample_time_ms': 19068.504, 'load_time_ms': 4.351, 'load_throughput': 919354.92, 'learn_time_ms': 118927.927, 'learn_throughput': 33.634, 'synch_weights_time_ms': 13.541}, 'counters': {'num_env_steps_sampled': 48000, 'num_env_steps_trained': 48000, 'num_agent_steps_sampled': 48000, 'num_agent_steps_trained': 48000}, 'done': False, 'episodes_total': 72, 'training_iteration': 12, 'trial_id': 'default', 'date': '2024-05-10_12-49-19', 'timestamp': 1715341759, 'time_this_iter_s': 142.92932868003845, 'time_total_s': 1617.2566764354706, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 1617.2566764354706, 'iterations_since_restore': 12, 'perf': {'cpu_util_percent': 44.828217821782175, 'ram_util_percent': 87.81138613861386}}
	Step: 12
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.6490897000797333, 'cur_kl_coeff': 0.075, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.05106603685886629, 'policy_loss': -0.005819437871136332, 'vf_loss': 0.05552368309729518, 'vf_explained_var': -0.22299288395912417, 'kl': 0.01815723386823334, 'entropy': 1.2797197297055234, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 11625.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 52000, 'num_env_steps_trained': 52000, 'num_agent_steps_sampled': 52000, 'num_agent_steps_trained': 52000}, 'sampler_results': {'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.205128205128205, 'episode_len_mean': 655.1025641025641, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 51098, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0], 'episode_lengths': [497, 489, 626, 492, 494, 616, 501, 791, 619, 687, 620, 792, 500, 493, 984, 495, 500, 492, 491, 490, 493, 491, 984, 717, 805, 818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.564989598576603, 'mean_inference_ms': 8.257858442893738, 'mean_action_processing_ms': 0.11282339684534315, 'mean_env_wait_ms': 0.20236225182474227, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.22480334991063827, 'StateBufferConnector_ms': 0.005181630452473958, 'ViewRequirementAgentConnector_ms': 0.12511442869137496}, 'num_episodes': 6, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.205128205128205}, 'env_runner_results': {'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.205128205128205, 'episode_len_mean': 655.1025641025641, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 51098, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0], 'episode_lengths': [497, 489, 626, 492, 494, 616, 501, 791, 619, 687, 620, 792, 500, 493, 984, 495, 500, 492, 491, 490, 493, 491, 984, 717, 805, 818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.564989598576603, 'mean_inference_ms': 8.257858442893738, 'mean_action_processing_ms': 0.11282339684534315, 'mean_env_wait_ms': 0.20236225182474227, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.22480334991063827, 'StateBufferConnector_ms': 0.005181630452473958, 'ViewRequirementAgentConnector_ms': 0.12511442869137496}, 'num_episodes': 6, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.205128205128205}, 'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.205128205128205, 'episode_len_mean': 655.1025641025641, 'episodes_this_iter': 6, 'episodes_timesteps_total': 51098, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0], 'episode_lengths': [497, 489, 626, 492, 494, 616, 501, 791, 619, 687, 620, 792, 500, 493, 984, 495, 500, 492, 491, 490, 493, 491, 984, 717, 805, 818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.564989598576603, 'mean_inference_ms': 8.257858442893738, 'mean_action_processing_ms': 0.11282339684534315, 'mean_env_wait_ms': 0.20236225182474227, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.22480334991063827, 'StateBufferConnector_ms': 0.005181630452473958, 'ViewRequirementAgentConnector_ms': 0.12511442869137496}, 'num_episodes': 6, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.205128205128205, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 52000, 'num_agent_steps_trained': 52000, 'num_env_steps_sampled': 52000, 'num_env_steps_trained': 52000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 28.04176074939029, 'num_env_steps_trained_throughput_per_sec': 28.04176074939029, 'timesteps_total': 52000, 'num_env_steps_sampled_lifetime': 52000, 'num_agent_steps_sampled_lifetime': 52000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 52000, 'timers': {'training_iteration_time_ms': 139045.85, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 139045.85, 'sample_time_ms': 19142.067, 'load_time_ms': 4.521, 'load_throughput': 884794.929, 'learn_time_ms': 119884.887, 'learn_throughput': 33.365, 'synch_weights_time_ms': 13.548}, 'counters': {'num_env_steps_sampled': 52000, 'num_env_steps_trained': 52000, 'num_agent_steps_sampled': 52000, 'num_agent_steps_trained': 52000}, 'done': False, 'episodes_total': 78, 'training_iteration': 13, 'trial_id': 'default', 'date': '2024-05-10_12-51-42', 'timestamp': 1715341902, 'time_this_iter_s': 142.67335724830627, 'time_total_s': 1759.9300336837769, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 1759.9300336837769, 'iterations_since_restore': 13, 'perf': {'cpu_util_percent': 43.82178217821782, 'ram_util_percent': 88.37079207920793}}
	Step: 13
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.1266271531501766, 'cur_kl_coeff': 0.075, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.023957817412171793, 'policy_loss': -0.0072885806902602155, 'vf_loss': 0.029321966969995804, 'vf_explained_var': -0.6100805761993572, 'kl': 0.025659087043758546, 'entropy': 1.3294867806537176, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 12555.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 56000, 'num_env_steps_trained': 56000, 'num_agent_steps_sampled': 56000, 'num_agent_steps_trained': 56000}, 'sampler_results': {'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.1511627906976745, 'episode_len_mean': 647.2209302325581, 'episode_media': {}, 'episodes_this_iter': 8, 'episodes_timesteps_total': 55661, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0], 'episode_lengths': [497, 489, 626, 492, 494, 616, 501, 791, 619, 687, 620, 792, 500, 493, 984, 495, 500, 492, 491, 490, 493, 491, 984, 717, 805, 818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5660211688512691, 'mean_inference_ms': 8.283900334205258, 'mean_action_processing_ms': 0.11303440463779196, 'mean_env_wait_ms': 0.203083109420305, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.22755001866540245, 'StateBufferConnector_ms': 0.005866483200428097, 'ViewRequirementAgentConnector_ms': 0.12129489765610806}, 'num_episodes': 8, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.1511627906976745}, 'env_runner_results': {'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.1511627906976745, 'episode_len_mean': 647.2209302325581, 'episode_media': {}, 'episodes_this_iter': 8, 'episodes_timesteps_total': 55661, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0], 'episode_lengths': [497, 489, 626, 492, 494, 616, 501, 791, 619, 687, 620, 792, 500, 493, 984, 495, 500, 492, 491, 490, 493, 491, 984, 717, 805, 818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5660211688512691, 'mean_inference_ms': 8.283900334205258, 'mean_action_processing_ms': 0.11303440463779196, 'mean_env_wait_ms': 0.203083109420305, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.22755001866540245, 'StateBufferConnector_ms': 0.005866483200428097, 'ViewRequirementAgentConnector_ms': 0.12129489765610806}, 'num_episodes': 8, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.1511627906976745}, 'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.1511627906976745, 'episode_len_mean': 647.2209302325581, 'episodes_this_iter': 8, 'episodes_timesteps_total': 55661, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0], 'episode_lengths': [497, 489, 626, 492, 494, 616, 501, 791, 619, 687, 620, 792, 500, 493, 984, 495, 500, 492, 491, 490, 493, 491, 984, 717, 805, 818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5660211688512691, 'mean_inference_ms': 8.283900334205258, 'mean_action_processing_ms': 0.11303440463779196, 'mean_env_wait_ms': 0.203083109420305, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.22755001866540245, 'StateBufferConnector_ms': 0.005866483200428097, 'ViewRequirementAgentConnector_ms': 0.12129489765610806}, 'num_episodes': 8, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.1511627906976745, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 56000, 'num_agent_steps_trained': 56000, 'num_env_steps_sampled': 56000, 'num_env_steps_trained': 56000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 28.08657367535073, 'num_env_steps_trained_throughput_per_sec': 28.08657367535073, 'timesteps_total': 56000, 'num_env_steps_sampled_lifetime': 56000, 'num_agent_steps_sampled_lifetime': 56000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 56000, 'timers': {'training_iteration_time_ms': 139674.091, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 139674.091, 'sample_time_ms': 19295.747, 'load_time_ms': 4.895, 'load_throughput': 817208.851, 'learn_time_ms': 120358.998, 'learn_throughput': 33.234, 'synch_weights_time_ms': 13.763}, 'counters': {'num_env_steps_sampled': 56000, 'num_env_steps_trained': 56000, 'num_agent_steps_sampled': 56000, 'num_agent_steps_trained': 56000}, 'done': False, 'episodes_total': 86, 'training_iteration': 14, 'trial_id': 'default', 'date': '2024-05-10_12-54-04', 'timestamp': 1715342044, 'time_this_iter_s': 142.44716668128967, 'time_total_s': 1902.3772003650665, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 1902.3772003650665, 'iterations_since_restore': 14, 'perf': {'cpu_util_percent': 41.733663366336636, 'ram_util_percent': 85.0509900990099}}
	Step: 14
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 2.1096570316822296, 'cur_kl_coeff': 0.11250000000000003, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.05573799953826012, 'policy_loss': -0.005107309455202232, 'vf_loss': 0.05992944513858166, 'vf_explained_var': -0.23890335502163057, 'kl': 0.008141010572390786, 'entropy': 1.3257417883924258, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 13485.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 60000, 'num_env_steps_trained': 60000, 'num_agent_steps_sampled': 60000, 'num_agent_steps_trained': 60000}, 'sampler_results': {'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.1868131868131868, 'episode_len_mean': 652.1648351648352, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 59347, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0], 'episode_lengths': [497, 489, 626, 492, 494, 616, 501, 791, 619, 687, 620, 792, 500, 493, 984, 495, 500, 492, 491, 490, 493, 491, 984, 717, 805, 818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5669883079352545, 'mean_inference_ms': 8.299659918678454, 'mean_action_processing_ms': 0.11323112730812697, 'mean_env_wait_ms': 0.2036271572702009, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.23082403036264273, 'StateBufferConnector_ms': 0.006646376389723558, 'ViewRequirementAgentConnector_ms': 0.11896772699041681}, 'num_episodes': 5, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.1868131868131868}, 'env_runner_results': {'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.1868131868131868, 'episode_len_mean': 652.1648351648352, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 59347, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0], 'episode_lengths': [497, 489, 626, 492, 494, 616, 501, 791, 619, 687, 620, 792, 500, 493, 984, 495, 500, 492, 491, 490, 493, 491, 984, 717, 805, 818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5669883079352545, 'mean_inference_ms': 8.299659918678454, 'mean_action_processing_ms': 0.11323112730812697, 'mean_env_wait_ms': 0.2036271572702009, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.23082403036264273, 'StateBufferConnector_ms': 0.006646376389723558, 'ViewRequirementAgentConnector_ms': 0.11896772699041681}, 'num_episodes': 5, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.1868131868131868}, 'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.1868131868131868, 'episode_len_mean': 652.1648351648352, 'episodes_this_iter': 5, 'episodes_timesteps_total': 59347, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0], 'episode_lengths': [497, 489, 626, 492, 494, 616, 501, 791, 619, 687, 620, 792, 500, 493, 984, 495, 500, 492, 491, 490, 493, 491, 984, 717, 805, 818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5669883079352545, 'mean_inference_ms': 8.299659918678454, 'mean_action_processing_ms': 0.11323112730812697, 'mean_env_wait_ms': 0.2036271572702009, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.23082403036264273, 'StateBufferConnector_ms': 0.006646376389723558, 'ViewRequirementAgentConnector_ms': 0.11896772699041681}, 'num_episodes': 5, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.1868131868131868, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 60000, 'num_agent_steps_trained': 60000, 'num_env_steps_sampled': 60000, 'num_env_steps_trained': 60000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 28.50706342736553, 'num_env_steps_trained_throughput_per_sec': 28.50706342736553, 'timesteps_total': 60000, 'num_env_steps_sampled_lifetime': 60000, 'num_agent_steps_sampled_lifetime': 60000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 60000, 'timers': {'training_iteration_time_ms': 140113.921, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 140113.921, 'sample_time_ms': 19515.422, 'load_time_ms': 5.264, 'load_throughput': 759827.357, 'learn_time_ms': 120578.583, 'learn_throughput': 33.173, 'synch_weights_time_ms': 13.963}, 'counters': {'num_env_steps_sampled': 60000, 'num_env_steps_trained': 60000, 'num_agent_steps_sampled': 60000, 'num_agent_steps_trained': 60000}, 'done': False, 'episodes_total': 91, 'training_iteration': 15, 'trial_id': 'default', 'date': '2024-05-10_12-56-24', 'timestamp': 1715342184, 'time_this_iter_s': 140.3496377468109, 'time_total_s': 2042.7268381118774, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 2042.7268381118774, 'iterations_since_restore': 15, 'perf': {'cpu_util_percent': 42.515075376884425, 'ram_util_percent': 85.96030150753768}}
	Step: 15
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 2.0862494450583253, 'cur_kl_coeff': 0.11250000000000003, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.0464069581640664, 'policy_loss': -0.008982960262926675, 'vf_loss': 0.05368854014030207, 'vf_explained_var': -0.45645626866689293, 'kl': 0.015123391978699023, 'entropy': 1.3293609415331193, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 14415.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 64000, 'num_env_steps_trained': 64000, 'num_agent_steps_sampled': 64000, 'num_agent_steps_trained': 64000}, 'sampler_results': {'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.1958762886597938, 'episode_len_mean': 654.2577319587629, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 63463, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0], 'episode_lengths': [497, 489, 626, 492, 494, 616, 501, 791, 619, 687, 620, 792, 500, 493, 984, 495, 500, 492, 491, 490, 493, 491, 984, 717, 805, 818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5678452411226107, 'mean_inference_ms': 8.316880402472687, 'mean_action_processing_ms': 0.11339003328478654, 'mean_env_wait_ms': 0.20422269783222607, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.22908264828711442, 'StateBufferConnector_ms': 0.006235260324379832, 'ViewRequirementAgentConnector_ms': 0.1240164963240476}, 'num_episodes': 6, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.1958762886597938}, 'env_runner_results': {'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.1958762886597938, 'episode_len_mean': 654.2577319587629, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 63463, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0], 'episode_lengths': [497, 489, 626, 492, 494, 616, 501, 791, 619, 687, 620, 792, 500, 493, 984, 495, 500, 492, 491, 490, 493, 491, 984, 717, 805, 818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5678452411226107, 'mean_inference_ms': 8.316880402472687, 'mean_action_processing_ms': 0.11339003328478654, 'mean_env_wait_ms': 0.20422269783222607, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.22908264828711442, 'StateBufferConnector_ms': 0.006235260324379832, 'ViewRequirementAgentConnector_ms': 0.1240164963240476}, 'num_episodes': 6, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.1958762886597938}, 'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.1958762886597938, 'episode_len_mean': 654.2577319587629, 'episodes_this_iter': 6, 'episodes_timesteps_total': 63463, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0], 'episode_lengths': [497, 489, 626, 492, 494, 616, 501, 791, 619, 687, 620, 792, 500, 493, 984, 495, 500, 492, 491, 490, 493, 491, 984, 717, 805, 818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5678452411226107, 'mean_inference_ms': 8.316880402472687, 'mean_action_processing_ms': 0.11339003328478654, 'mean_env_wait_ms': 0.20422269783222607, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.22908264828711442, 'StateBufferConnector_ms': 0.006235260324379832, 'ViewRequirementAgentConnector_ms': 0.1240164963240476}, 'num_episodes': 6, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.1958762886597938, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 64000, 'num_agent_steps_trained': 64000, 'num_env_steps_sampled': 64000, 'num_env_steps_trained': 64000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 29.789401973496105, 'num_env_steps_trained_throughput_per_sec': 29.789401973496105, 'timesteps_total': 64000, 'num_env_steps_sampled_lifetime': 64000, 'num_agent_steps_sampled_lifetime': 64000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 64000, 'timers': {'training_iteration_time_ms': 138970.724, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 138970.724, 'sample_time_ms': 19484.252, 'load_time_ms': 5.452, 'load_throughput': 733609.802, 'learn_time_ms': 119466.468, 'learn_throughput': 33.482, 'synch_weights_time_ms': 13.763}, 'counters': {'num_env_steps_sampled': 64000, 'num_env_steps_trained': 64000, 'num_agent_steps_sampled': 64000, 'num_agent_steps_trained': 64000}, 'done': False, 'episodes_total': 97, 'training_iteration': 16, 'trial_id': 'default', 'date': '2024-05-10_12-58-39', 'timestamp': 1715342319, 'time_this_iter_s': 134.3046839237213, 'time_total_s': 2177.0315220355988, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 2177.0315220355988, 'iterations_since_restore': 16, 'perf': {'cpu_util_percent': 45.76578947368421, 'ram_util_percent': 75.36947368421053}}
	Step: 16
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 2.6842089495671693, 'cur_kl_coeff': 0.11250000000000003, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.0516202802419342, 'policy_loss': -0.007705908034357332, 'vf_loss': 0.05715652115246211, 'vf_explained_var': -0.27602863298949376, 'kl': 0.019285935545973493, 'entropy': 1.342633560652374, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 15345.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 68000, 'num_env_steps_trained': 68000, 'num_agent_steps_sampled': 68000, 'num_agent_steps_trained': 68000}, 'sampler_results': {'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.23, 'episode_len_mean': 659.37, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 65937, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0], 'episode_lengths': [492, 494, 616, 501, 791, 619, 687, 620, 792, 500, 493, 984, 495, 500, 492, 491, 490, 493, 491, 984, 717, 805, 818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5693500435571398, 'mean_inference_ms': 8.368758954841532, 'mean_action_processing_ms': 0.11335890446189258, 'mean_env_wait_ms': 0.2053353197261355, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.22309112548828125, 'StateBufferConnector_ms': 0.005049467086791992, 'ViewRequirementAgentConnector_ms': 0.12736988067626953}, 'num_episodes': 6, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.23}, 'env_runner_results': {'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.23, 'episode_len_mean': 659.37, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 65937, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0], 'episode_lengths': [492, 494, 616, 501, 791, 619, 687, 620, 792, 500, 493, 984, 495, 500, 492, 491, 490, 493, 491, 984, 717, 805, 818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5693500435571398, 'mean_inference_ms': 8.368758954841532, 'mean_action_processing_ms': 0.11335890446189258, 'mean_env_wait_ms': 0.2053353197261355, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.22309112548828125, 'StateBufferConnector_ms': 0.005049467086791992, 'ViewRequirementAgentConnector_ms': 0.12736988067626953}, 'num_episodes': 6, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.23}, 'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.23, 'episode_len_mean': 659.37, 'episodes_this_iter': 6, 'episodes_timesteps_total': 65937, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0], 'episode_lengths': [492, 494, 616, 501, 791, 619, 687, 620, 792, 500, 493, 984, 495, 500, 492, 491, 490, 493, 491, 984, 717, 805, 818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5693500435571398, 'mean_inference_ms': 8.368758954841532, 'mean_action_processing_ms': 0.11335890446189258, 'mean_env_wait_ms': 0.2053353197261355, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.22309112548828125, 'StateBufferConnector_ms': 0.005049467086791992, 'ViewRequirementAgentConnector_ms': 0.12736988067626953}, 'num_episodes': 6, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.23, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 68000, 'num_agent_steps_trained': 68000, 'num_env_steps_sampled': 68000, 'num_env_steps_trained': 68000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 29.35743794860333, 'num_env_steps_trained_throughput_per_sec': 29.35743794860333, 'timesteps_total': 68000, 'num_env_steps_sampled_lifetime': 68000, 'num_agent_steps_sampled_lifetime': 68000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 68000, 'timers': {'training_iteration_time_ms': 138268.073, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 138268.073, 'sample_time_ms': 19325.215, 'load_time_ms': 5.752, 'load_throughput': 695408.465, 'learn_time_ms': 118922.552, 'learn_throughput': 33.635, 'synch_weights_time_ms': 13.666}, 'counters': {'num_env_steps_sampled': 68000, 'num_env_steps_trained': 68000, 'num_agent_steps_sampled': 68000, 'num_agent_steps_trained': 68000}, 'done': False, 'episodes_total': 103, 'training_iteration': 17, 'trial_id': 'default', 'date': '2024-05-10_13-00-55', 'timestamp': 1715342455, 'time_this_iter_s': 136.28062224388123, 'time_total_s': 2313.31214427948, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 2313.31214427948, 'iterations_since_restore': 17, 'perf': {'cpu_util_percent': 43.48756476683938, 'ram_util_percent': 75.56683937823836}}
	Step: 17
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.8270902385474532, 'cur_kl_coeff': 0.11250000000000003, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.03160642864563132, 'policy_loss': -0.003995888715269425, 'vf_loss': 0.033781038295297376, 'vf_explained_var': -0.5777721291588199, 'kl': 0.016189112647937473, 'entropy': 1.3065904484000257, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 16275.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 72000, 'num_env_steps_trained': 72000, 'num_agent_steps_sampled': 72000, 'num_agent_steps_trained': 72000}, 'sampler_results': {'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.25, 'episode_len_mean': 662.57, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 66257, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0], 'episode_lengths': [687, 620, 792, 500, 493, 984, 495, 500, 492, 491, 490, 493, 491, 984, 717, 805, 818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5697597049367032, 'mean_inference_ms': 8.430597199279685, 'mean_action_processing_ms': 0.11330388293568693, 'mean_env_wait_ms': 0.20661656818610064, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2273705005645752, 'StateBufferConnector_ms': 0.004656076431274414, 'ViewRequirementAgentConnector_ms': 0.13620209693908691}, 'num_episodes': 6, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.25}, 'env_runner_results': {'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.25, 'episode_len_mean': 662.57, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 66257, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0], 'episode_lengths': [687, 620, 792, 500, 493, 984, 495, 500, 492, 491, 490, 493, 491, 984, 717, 805, 818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5697597049367032, 'mean_inference_ms': 8.430597199279685, 'mean_action_processing_ms': 0.11330388293568693, 'mean_env_wait_ms': 0.20661656818610064, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2273705005645752, 'StateBufferConnector_ms': 0.004656076431274414, 'ViewRequirementAgentConnector_ms': 0.13620209693908691}, 'num_episodes': 6, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.25}, 'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.25, 'episode_len_mean': 662.57, 'episodes_this_iter': 6, 'episodes_timesteps_total': 66257, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [1.0, 1.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0], 'episode_lengths': [687, 620, 792, 500, 493, 984, 495, 500, 492, 491, 490, 493, 491, 984, 717, 805, 818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5697597049367032, 'mean_inference_ms': 8.430597199279685, 'mean_action_processing_ms': 0.11330388293568693, 'mean_env_wait_ms': 0.20661656818610064, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2273705005645752, 'StateBufferConnector_ms': 0.004656076431274414, 'ViewRequirementAgentConnector_ms': 0.13620209693908691}, 'num_episodes': 6, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.25, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 72000, 'num_agent_steps_trained': 72000, 'num_env_steps_sampled': 72000, 'num_env_steps_trained': 72000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 29.137093398373022, 'num_env_steps_trained_throughput_per_sec': 29.137093398373022, 'timesteps_total': 72000, 'num_env_steps_sampled_lifetime': 72000, 'num_agent_steps_sampled_lifetime': 72000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 72000, 'timers': {'training_iteration_time_ms': 138220.293, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 138220.293, 'sample_time_ms': 19196.141, 'load_time_ms': 5.823, 'load_throughput': 686954.542, 'learn_time_ms': 119004.076, 'learn_throughput': 33.612, 'synch_weights_time_ms': 13.466}, 'counters': {'num_env_steps_sampled': 72000, 'num_env_steps_trained': 72000, 'num_agent_steps_sampled': 72000, 'num_agent_steps_trained': 72000}, 'done': False, 'episodes_total': 109, 'training_iteration': 18, 'trial_id': 'default', 'date': '2024-05-10_13-03-12', 'timestamp': 1715342592, 'time_this_iter_s': 137.31564497947693, 'time_total_s': 2450.627789258957, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 2450.627789258957, 'iterations_since_restore': 18, 'perf': {'cpu_util_percent': 36.97422680412371, 'ram_util_percent': 75.19948453608248}}
	Step: 18
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 2.1339390087352004, 'cur_kl_coeff': 0.11250000000000003, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.04248195016175829, 'policy_loss': -0.0052494828098563736, 'vf_loss': 0.04634690853690113, 'vf_explained_var': -0.561478066380306, 'kl': 0.012306878594396737, 'entropy': 1.3087141283096806, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 17205.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 76000, 'num_env_steps_trained': 76000, 'num_agent_steps_sampled': 76000, 'num_agent_steps_trained': 76000}, 'sampler_results': {'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.23, 'episode_len_mean': 658.09, 'episode_media': {}, 'episodes_this_iter': 7, 'episodes_timesteps_total': 65809, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0], 'episode_lengths': [500, 492, 491, 490, 493, 491, 984, 717, 805, 818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5690565038908811, 'mean_inference_ms': 8.461245029189714, 'mean_action_processing_ms': 0.11300633358144334, 'mean_env_wait_ms': 0.2072645854100928, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2356417179107666, 'StateBufferConnector_ms': 0.004686117172241211, 'ViewRequirementAgentConnector_ms': 0.12895750999450684}, 'num_episodes': 7, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.23}, 'env_runner_results': {'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.23, 'episode_len_mean': 658.09, 'episode_media': {}, 'episodes_this_iter': 7, 'episodes_timesteps_total': 65809, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0], 'episode_lengths': [500, 492, 491, 490, 493, 491, 984, 717, 805, 818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5690565038908811, 'mean_inference_ms': 8.461245029189714, 'mean_action_processing_ms': 0.11300633358144334, 'mean_env_wait_ms': 0.2072645854100928, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2356417179107666, 'StateBufferConnector_ms': 0.004686117172241211, 'ViewRequirementAgentConnector_ms': 0.12895750999450684}, 'num_episodes': 7, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.23}, 'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.23, 'episode_len_mean': 658.09, 'episodes_this_iter': 7, 'episodes_timesteps_total': 65809, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0], 'episode_lengths': [500, 492, 491, 490, 493, 491, 984, 717, 805, 818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5690565038908811, 'mean_inference_ms': 8.461245029189714, 'mean_action_processing_ms': 0.11300633358144334, 'mean_env_wait_ms': 0.2072645854100928, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2356417179107666, 'StateBufferConnector_ms': 0.004686117172241211, 'ViewRequirementAgentConnector_ms': 0.12895750999450684}, 'num_episodes': 7, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.23, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 76000, 'num_agent_steps_trained': 76000, 'num_env_steps_sampled': 76000, 'num_env_steps_trained': 76000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 27.27433752077217, 'num_env_steps_trained_throughput_per_sec': 27.27433752077217, 'timesteps_total': 76000, 'num_env_steps_sampled_lifetime': 76000, 'num_agent_steps_sampled_lifetime': 76000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 76000, 'timers': {'training_iteration_time_ms': 139438.29, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 139438.29, 'sample_time_ms': 19151.699, 'load_time_ms': 5.596, 'load_throughput': 714739.192, 'learn_time_ms': 120266.843, 'learn_throughput': 33.259, 'synch_weights_time_ms': 13.364}, 'counters': {'num_env_steps_sampled': 76000, 'num_env_steps_trained': 76000, 'num_agent_steps_sampled': 76000, 'num_agent_steps_trained': 76000}, 'done': False, 'episodes_total': 116, 'training_iteration': 19, 'trial_id': 'default', 'date': '2024-05-10_13-05-39', 'timestamp': 1715342739, 'time_this_iter_s': 146.68888998031616, 'time_total_s': 2597.316679239273, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 2597.316679239273, 'iterations_since_restore': 19, 'perf': {'cpu_util_percent': 47.86682692307692, 'ram_util_percent': 75.23028846153846}}
	Step: 19
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 2.1770045459270477, 'cur_kl_coeff': 0.11250000000000003, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.06047578258540041, 'policy_loss': -0.004085519557358116, 'vf_loss': 0.06413606220093664, 'vf_explained_var': -0.4141233023135893, 'kl': 0.003779881646942626, 'entropy': 1.3341071758218992, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 18135.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 80000, 'num_env_steps_trained': 80000, 'num_agent_steps_sampled': 80000, 'num_agent_steps_trained': 80000}, 'sampler_results': {'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.28, 'episode_len_mean': 666.91, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 66691, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0], 'episode_lengths': [491, 984, 717, 805, 818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5693721474829081, 'mean_inference_ms': 8.476725675637393, 'mean_action_processing_ms': 0.11302043733861623, 'mean_env_wait_ms': 0.20792275116077555, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2392120361328125, 'StateBufferConnector_ms': 0.004877567291259766, 'ViewRequirementAgentConnector_ms': 0.12602925300598145}, 'num_episodes': 5, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.28}, 'env_runner_results': {'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.28, 'episode_len_mean': 666.91, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 66691, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0], 'episode_lengths': [491, 984, 717, 805, 818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5693721474829081, 'mean_inference_ms': 8.476725675637393, 'mean_action_processing_ms': 0.11302043733861623, 'mean_env_wait_ms': 0.20792275116077555, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2392120361328125, 'StateBufferConnector_ms': 0.004877567291259766, 'ViewRequirementAgentConnector_ms': 0.12602925300598145}, 'num_episodes': 5, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.28}, 'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.28, 'episode_len_mean': 666.91, 'episodes_this_iter': 5, 'episodes_timesteps_total': 66691, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [0.0, 3.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0], 'episode_lengths': [491, 984, 717, 805, 818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5693721474829081, 'mean_inference_ms': 8.476725675637393, 'mean_action_processing_ms': 0.11302043733861623, 'mean_env_wait_ms': 0.20792275116077555, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2392120361328125, 'StateBufferConnector_ms': 0.004877567291259766, 'ViewRequirementAgentConnector_ms': 0.12602925300598145}, 'num_episodes': 5, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.28, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 80000, 'num_agent_steps_trained': 80000, 'num_env_steps_sampled': 80000, 'num_env_steps_trained': 80000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 26.75475026532303, 'num_env_steps_trained_throughput_per_sec': 26.75475026532303, 'timesteps_total': 80000, 'num_env_steps_sampled_lifetime': 80000, 'num_agent_steps_sampled_lifetime': 80000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 80000, 'timers': {'training_iteration_time_ms': 140692.477, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 140692.477, 'sample_time_ms': 19256.589, 'load_time_ms': 5.735, 'load_throughput': 697437.842, 'learn_time_ms': 121415.843, 'learn_throughput': 32.945, 'synch_weights_time_ms': 13.604}, 'counters': {'num_env_steps_sampled': 80000, 'num_env_steps_trained': 80000, 'num_agent_steps_sampled': 80000, 'num_agent_steps_trained': 80000}, 'done': False, 'episodes_total': 121, 'training_iteration': 20, 'trial_id': 'default', 'date': '2024-05-10_13-08-09', 'timestamp': 1715342889, 'time_this_iter_s': 149.54263758659363, 'time_total_s': 2746.8593168258667, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 2746.8593168258667, 'iterations_since_restore': 20, 'perf': {'cpu_util_percent': 44.842452830188684, 'ram_util_percent': 75.69245283018867}}
	Step: 20
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 2.2872705531216435, 'cur_kl_coeff': 0.056250000000000015, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.0631671497898717, 'policy_loss': -0.008578362452086583, 'vf_loss': 0.0712720311964081, 'vf_explained_var': -0.07748556444721837, 'kl': 0.008417405938348183, 'entropy': 1.344752756241829, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 19065.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 84000, 'num_env_steps_trained': 84000, 'num_agent_steps_sampled': 84000, 'num_agent_steps_trained': 84000}, 'sampler_results': {'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.31, 'episode_len_mean': 672.7, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 67270, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0], 'episode_lengths': [818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5698449712043592, 'mean_inference_ms': 8.488160089055297, 'mean_action_processing_ms': 0.1130000648538181, 'mean_env_wait_ms': 0.20847707184939288, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2441849708557129, 'StateBufferConnector_ms': 0.004877567291259766, 'ViewRequirementAgentConnector_ms': 0.12863755226135254}, 'num_episodes': 4, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.31}, 'env_runner_results': {'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.31, 'episode_len_mean': 672.7, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 67270, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0], 'episode_lengths': [818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5698449712043592, 'mean_inference_ms': 8.488160089055297, 'mean_action_processing_ms': 0.1130000648538181, 'mean_env_wait_ms': 0.20847707184939288, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2441849708557129, 'StateBufferConnector_ms': 0.004877567291259766, 'ViewRequirementAgentConnector_ms': 0.12863755226135254}, 'num_episodes': 4, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.31}, 'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.31, 'episode_len_mean': 672.7, 'episodes_this_iter': 4, 'episodes_timesteps_total': 67270, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0], 'episode_lengths': [818, 604, 794, 614, 489, 799, 608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5698449712043592, 'mean_inference_ms': 8.488160089055297, 'mean_action_processing_ms': 0.1130000648538181, 'mean_env_wait_ms': 0.20847707184939288, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2441849708557129, 'StateBufferConnector_ms': 0.004877567291259766, 'ViewRequirementAgentConnector_ms': 0.12863755226135254}, 'num_episodes': 4, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.31, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 84000, 'num_agent_steps_trained': 84000, 'num_env_steps_sampled': 84000, 'num_env_steps_trained': 84000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 28.60382889125812, 'num_env_steps_trained_throughput_per_sec': 28.60382889125812, 'timesteps_total': 84000, 'num_env_steps_sampled_lifetime': 84000, 'num_agent_steps_sampled_lifetime': 84000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 84000, 'timers': {'training_iteration_time_ms': 141209.307, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 141209.307, 'sample_time_ms': 19281.134, 'load_time_ms': 5.331, 'load_throughput': 750359.633, 'learn_time_ms': 121908.128, 'learn_throughput': 32.812, 'synch_weights_time_ms': 13.908}, 'counters': {'num_env_steps_sampled': 84000, 'num_env_steps_trained': 84000, 'num_agent_steps_sampled': 84000, 'num_agent_steps_trained': 84000}, 'done': False, 'episodes_total': 125, 'training_iteration': 21, 'trial_id': 'default', 'date': '2024-05-10_13-10-29', 'timestamp': 1715343029, 'time_this_iter_s': 139.8754642009735, 'time_total_s': 2886.73478102684, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 2886.73478102684, 'iterations_since_restore': 21, 'perf': {'cpu_util_percent': 45.796954314720814, 'ram_util_percent': 76.04568527918782}}
Saving weights...
	Step: 21
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.8159738152818654, 'cur_kl_coeff': 0.056250000000000015, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.058504392594845106, 'policy_loss': -0.0016651385664058628, 'vf_loss': 0.0592502491421602, 'vf_explained_var': -0.40811445719452316, 'kl': 0.01634279665603482, 'entropy': 1.3222585515309406, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 19995.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 88000, 'num_env_steps_trained': 88000, 'num_agent_steps_sampled': 88000, 'num_agent_steps_trained': 88000}, 'sampler_results': {'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.33, 'episode_len_mean': 677.25, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 67725, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0], 'episode_lengths': [608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5711146006732981, 'mean_inference_ms': 8.50473928850956, 'mean_action_processing_ms': 0.11318882548998291, 'mean_env_wait_ms': 0.20940505065566964, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.24010229110717773, 'StateBufferConnector_ms': 0.004877567291259766, 'ViewRequirementAgentConnector_ms': 0.12162446975708008}, 'num_episodes': 6, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.33}, 'env_runner_results': {'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.33, 'episode_len_mean': 677.25, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 67725, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0], 'episode_lengths': [608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5711146006732981, 'mean_inference_ms': 8.50473928850956, 'mean_action_processing_ms': 0.11318882548998291, 'mean_env_wait_ms': 0.20940505065566964, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.24010229110717773, 'StateBufferConnector_ms': 0.004877567291259766, 'ViewRequirementAgentConnector_ms': 0.12162446975708008}, 'num_episodes': 6, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.33}, 'episode_reward_max': 8.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.33, 'episode_len_mean': 677.25, 'episodes_this_iter': 6, 'episodes_timesteps_total': 67725, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [1.0, 8.0, 2.0, 0.0, 0.0, 1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0], 'episode_lengths': [608, 1103, 723, 491, 488, 607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5711146006732981, 'mean_inference_ms': 8.50473928850956, 'mean_action_processing_ms': 0.11318882548998291, 'mean_env_wait_ms': 0.20940505065566964, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.24010229110717773, 'StateBufferConnector_ms': 0.004877567291259766, 'ViewRequirementAgentConnector_ms': 0.12162446975708008}, 'num_episodes': 6, 'episode_return_max': 8.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.33, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 88000, 'num_agent_steps_trained': 88000, 'num_env_steps_sampled': 88000, 'num_env_steps_trained': 88000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 28.01002352257401, 'num_env_steps_trained_throughput_per_sec': 28.01002352257401, 'timesteps_total': 88000, 'num_env_steps_sampled_lifetime': 88000, 'num_agent_steps_sampled_lifetime': 88000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 88000, 'timers': {'training_iteration_time_ms': 141199.857, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 141199.857, 'sample_time_ms': 19269.337, 'load_time_ms': 4.921, 'load_throughput': 812892.935, 'learn_time_ms': 121910.881, 'learn_throughput': 32.811, 'synch_weights_time_ms': 14.101}, 'counters': {'num_env_steps_sampled': 88000, 'num_env_steps_trained': 88000, 'num_agent_steps_sampled': 88000, 'num_agent_steps_trained': 88000}, 'done': False, 'episodes_total': 131, 'training_iteration': 22, 'trial_id': 'default', 'date': '2024-05-10_13-12-51', 'timestamp': 1715343171, 'time_this_iter_s': 142.83148097991943, 'time_total_s': 3029.5662620067596, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 3029.5662620067596, 'iterations_since_restore': 22, 'perf': {'cpu_util_percent': 46.084729064039415, 'ram_util_percent': 80.30541871921183}}
	Step: 22
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 2.17857358630306, 'cur_kl_coeff': 0.056250000000000015, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.06396426931424166, 'policy_loss': -0.007165567460720257, 'vf_loss': 0.06998817349473635, 'vf_explained_var': -0.3412554268554975, 'kl': 0.020296202601171445, 'entropy': 1.2645341615523062, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 20925.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 92000, 'num_env_steps_trained': 92000, 'num_agent_steps_sampled': 92000, 'num_agent_steps_trained': 92000}, 'sampler_results': {'episode_reward_max': 7.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.31, 'episode_len_mean': 682.63, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 68263, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0], 'episode_lengths': [607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5715499270362975, 'mean_inference_ms': 8.510513891513133, 'mean_action_processing_ms': 0.11329777461464895, 'mean_env_wait_ms': 0.20979107865036653, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2325911521911621, 'StateBufferConnector_ms': 0.004877567291259766, 'ViewRequirementAgentConnector_ms': 0.11812186241149902}, 'num_episodes': 5, 'episode_return_max': 7.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.31}, 'env_runner_results': {'episode_reward_max': 7.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.31, 'episode_len_mean': 682.63, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 68263, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0], 'episode_lengths': [607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5715499270362975, 'mean_inference_ms': 8.510513891513133, 'mean_action_processing_ms': 0.11329777461464895, 'mean_env_wait_ms': 0.20979107865036653, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2325911521911621, 'StateBufferConnector_ms': 0.004877567291259766, 'ViewRequirementAgentConnector_ms': 0.11812186241149902}, 'num_episodes': 5, 'episode_return_max': 7.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.31}, 'episode_reward_max': 7.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.31, 'episode_len_mean': 682.63, 'episodes_this_iter': 5, 'episodes_timesteps_total': 68263, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [1.0, 5.0, 2.0, 1.0, 2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0], 'episode_lengths': [607, 1251, 727, 611, 728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5715499270362975, 'mean_inference_ms': 8.510513891513133, 'mean_action_processing_ms': 0.11329777461464895, 'mean_env_wait_ms': 0.20979107865036653, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2325911521911621, 'StateBufferConnector_ms': 0.004877567291259766, 'ViewRequirementAgentConnector_ms': 0.11812186241149902}, 'num_episodes': 5, 'episode_return_max': 7.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.31, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 92000, 'num_agent_steps_trained': 92000, 'num_env_steps_sampled': 92000, 'num_env_steps_trained': 92000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 19.50422420983458, 'num_env_steps_trained_throughput_per_sec': 19.50422420983458, 'timesteps_total': 92000, 'num_env_steps_sampled_lifetime': 92000, 'num_agent_steps_sampled_lifetime': 92000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 92000, 'timers': {'training_iteration_time_ms': 147443.796, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 147443.796, 'sample_time_ms': 18788.906, 'load_time_ms': 4.75, 'load_throughput': 842039.499, 'learn_time_ms': 128635.424, 'learn_throughput': 31.096, 'synch_weights_time_ms': 14.098}, 'counters': {'num_env_steps_sampled': 92000, 'num_env_steps_trained': 92000, 'num_agent_steps_sampled': 92000, 'num_agent_steps_trained': 92000}, 'done': False, 'episodes_total': 136, 'training_iteration': 23, 'trial_id': 'default', 'date': '2024-05-10_13-16-17', 'timestamp': 1715343377, 'time_this_iter_s': 205.11671257019043, 'time_total_s': 3234.68297457695, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 3234.68297457695, 'iterations_since_restore': 23, 'perf': {'cpu_util_percent': 76.58020833333333, 'ram_util_percent': 89.46319444444445}}
	Step: 23
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 2.4419767539667827, 'cur_kl_coeff': 0.08437500000000002, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.06050984478125008, 'policy_loss': -0.010580127071388947, 'vf_loss': 0.07021274250050787, 'vf_explained_var': 0.005187376404321322, 'kl': 0.01039675411915173, 'entropy': 1.2732164579053078, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 21855.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 96000, 'num_env_steps_trained': 96000, 'num_agent_steps_sampled': 96000, 'num_agent_steps_trained': 96000}, 'sampler_results': {'episode_reward_max': 7.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.37, 'episode_len_mean': 696.08, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 69608, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0], 'episode_lengths': [728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5714596443494144, 'mean_inference_ms': 8.513345440938554, 'mean_action_processing_ms': 0.11339184168355768, 'mean_env_wait_ms': 0.2098841550864133, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.23479175567626953, 'StateBufferConnector_ms': 0.004877567291259766, 'ViewRequirementAgentConnector_ms': 0.12212085723876953}, 'num_episodes': 4, 'episode_return_max': 7.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.37}, 'env_runner_results': {'episode_reward_max': 7.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.37, 'episode_len_mean': 696.08, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 69608, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0], 'episode_lengths': [728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5714596443494144, 'mean_inference_ms': 8.513345440938554, 'mean_action_processing_ms': 0.11339184168355768, 'mean_env_wait_ms': 0.2098841550864133, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.23479175567626953, 'StateBufferConnector_ms': 0.004877567291259766, 'ViewRequirementAgentConnector_ms': 0.12212085723876953}, 'num_episodes': 4, 'episode_return_max': 7.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.37}, 'episode_reward_max': 7.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.37, 'episode_len_mean': 696.08, 'episodes_this_iter': 4, 'episodes_timesteps_total': 69608, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [2.0, 3.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0], 'episode_lengths': [728, 1067, 610, 607, 498, 486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5714596443494144, 'mean_inference_ms': 8.513345440938554, 'mean_action_processing_ms': 0.11339184168355768, 'mean_env_wait_ms': 0.2098841550864133, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.23479175567626953, 'StateBufferConnector_ms': 0.004877567291259766, 'ViewRequirementAgentConnector_ms': 0.12212085723876953}, 'num_episodes': 4, 'episode_return_max': 7.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.37, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 96000, 'num_agent_steps_trained': 96000, 'num_env_steps_sampled': 96000, 'num_env_steps_trained': 96000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 28.683393749877844, 'num_env_steps_trained_throughput_per_sec': 28.683393749877844, 'timesteps_total': 96000, 'num_env_steps_sampled_lifetime': 96000, 'num_agent_steps_sampled_lifetime': 96000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 96000, 'timers': {'training_iteration_time_ms': 147147.467, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 147147.467, 'sample_time_ms': 18580.514, 'load_time_ms': 4.678, 'load_throughput': 855099.133, 'learn_time_ms': 128546.796, 'learn_throughput': 31.117, 'synch_weights_time_ms': 14.962}, 'counters': {'num_env_steps_sampled': 96000, 'num_env_steps_trained': 96000, 'num_agent_steps_sampled': 96000, 'num_agent_steps_trained': 96000}, 'done': False, 'episodes_total': 140, 'training_iteration': 24, 'trial_id': 'default', 'date': '2024-05-10_13-18-36', 'timestamp': 1715343516, 'time_this_iter_s': 139.48104786872864, 'time_total_s': 3374.1640224456787, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 3374.1640224456787, 'iterations_since_restore': 24, 'perf': {'cpu_util_percent': 40.52182741116751, 'ram_util_percent': 66.94314720812183}}
	Step: 24
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 2.283874090240207, 'cur_kl_coeff': 0.08437500000000002, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.06460246873120727, 'policy_loss': -0.0019198728505001273, 'vf_loss': 0.06512251080324252, 'vf_explained_var': -0.2559988276932829, 'kl': 0.016590600332533765, 'entropy': 1.2997417009004983, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 22785.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 100000, 'num_env_steps_trained': 100000, 'num_agent_steps_sampled': 100000, 'num_agent_steps_trained': 100000}, 'sampler_results': {'episode_reward_max': 7.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.39, 'episode_len_mean': 700.54, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 70054, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0], 'episode_lengths': [486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5707898261454756, 'mean_inference_ms': 8.514600437395524, 'mean_action_processing_ms': 0.11333703168576738, 'mean_env_wait_ms': 0.20968158952931165, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.22673869132995605, 'StateBufferConnector_ms': 0.004877567291259766, 'ViewRequirementAgentConnector_ms': 0.12607073783874512}, 'num_episodes': 5, 'episode_return_max': 7.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.39}, 'env_runner_results': {'episode_reward_max': 7.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.39, 'episode_len_mean': 700.54, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 70054, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0], 'episode_lengths': [486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5707898261454756, 'mean_inference_ms': 8.514600437395524, 'mean_action_processing_ms': 0.11333703168576738, 'mean_env_wait_ms': 0.20968158952931165, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.22673869132995605, 'StateBufferConnector_ms': 0.004877567291259766, 'ViewRequirementAgentConnector_ms': 0.12607073783874512}, 'num_episodes': 5, 'episode_return_max': 7.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.39}, 'episode_reward_max': 7.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.39, 'episode_len_mean': 700.54, 'episodes_this_iter': 5, 'episodes_timesteps_total': 70054, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [0.0, 1.0, 0.0, 7.0, 3.0, 0.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0], 'episode_lengths': [486, 678, 506, 1488, 847, 499, 603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5707898261454756, 'mean_inference_ms': 8.514600437395524, 'mean_action_processing_ms': 0.11333703168576738, 'mean_env_wait_ms': 0.20968158952931165, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.22673869132995605, 'StateBufferConnector_ms': 0.004877567291259766, 'ViewRequirementAgentConnector_ms': 0.12607073783874512}, 'num_episodes': 5, 'episode_return_max': 7.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.39, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 100000, 'num_agent_steps_trained': 100000, 'num_env_steps_sampled': 100000, 'num_env_steps_trained': 100000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 28.175710503775015, 'num_env_steps_trained_throughput_per_sec': 28.175710503775015, 'timesteps_total': 100000, 'num_env_steps_sampled_lifetime': 100000, 'num_agent_steps_sampled_lifetime': 100000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 100000, 'timers': {'training_iteration_time_ms': 147312.482, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 147312.482, 'sample_time_ms': 18398.885, 'load_time_ms': 4.407, 'load_throughput': 907587.893, 'learn_time_ms': 128893.911, 'learn_throughput': 31.033, 'synch_weights_time_ms': 14.761}, 'counters': {'num_env_steps_sampled': 100000, 'num_env_steps_trained': 100000, 'num_agent_steps_sampled': 100000, 'num_agent_steps_trained': 100000}, 'done': False, 'episodes_total': 145, 'training_iteration': 25, 'trial_id': 'default', 'date': '2024-05-10_13-20-58', 'timestamp': 1715343658, 'time_this_iter_s': 141.99548935890198, 'time_total_s': 3516.1595118045807, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 3516.1595118045807, 'iterations_since_restore': 25, 'perf': {'cpu_util_percent': 39.92636815920398, 'ram_util_percent': 67.52089552238806}}
	Step: 25
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.7347717497658024, 'cur_kl_coeff': 0.08437500000000002, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.04109697039088895, 'policy_loss': -0.002517460703208882, 'vf_loss': 0.04212394377469556, 'vf_explained_var': -0.6905218354476396, 'kl': 0.017665057773006664, 'entropy': 1.3483414873000115, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 23715.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 104000, 'num_env_steps_trained': 104000, 'num_agent_steps_sampled': 104000, 'num_agent_steps_trained': 104000}, 'sampler_results': {'episode_reward_max': 7.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.35, 'episode_len_mean': 696.3, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 69630, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0], 'episode_lengths': [603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5697558578376116, 'mean_inference_ms': 8.514161118122576, 'mean_action_processing_ms': 0.11312998383058134, 'mean_env_wait_ms': 0.209337900295953, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2279045581817627, 'StateBufferConnector_ms': 0.004877567291259766, 'ViewRequirementAgentConnector_ms': 0.1268007755279541}, 'num_episodes': 6, 'episode_return_max': 7.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.35}, 'env_runner_results': {'episode_reward_max': 7.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.35, 'episode_len_mean': 696.3, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 69630, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0], 'episode_lengths': [603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5697558578376116, 'mean_inference_ms': 8.514161118122576, 'mean_action_processing_ms': 0.11312998383058134, 'mean_env_wait_ms': 0.209337900295953, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2279045581817627, 'StateBufferConnector_ms': 0.004877567291259766, 'ViewRequirementAgentConnector_ms': 0.1268007755279541}, 'num_episodes': 6, 'episode_return_max': 7.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.35}, 'episode_reward_max': 7.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.35, 'episode_len_mean': 696.3, 'episodes_this_iter': 6, 'episodes_timesteps_total': 69630, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0], 'episode_lengths': [603, 611, 801, 607, 613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5697558578376116, 'mean_inference_ms': 8.514161118122576, 'mean_action_processing_ms': 0.11312998383058134, 'mean_env_wait_ms': 0.209337900295953, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2279045581817627, 'StateBufferConnector_ms': 0.004877567291259766, 'ViewRequirementAgentConnector_ms': 0.1268007755279541}, 'num_episodes': 6, 'episode_return_max': 7.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.35, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 104000, 'num_agent_steps_trained': 104000, 'num_env_steps_sampled': 104000, 'num_env_steps_trained': 104000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 27.35088339395662, 'num_env_steps_trained_throughput_per_sec': 27.35088339395662, 'timesteps_total': 104000, 'num_env_steps_sampled_lifetime': 104000, 'num_agent_steps_sampled_lifetime': 104000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 104000, 'timers': {'training_iteration_time_ms': 148509.644, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 148509.644, 'sample_time_ms': 18299.352, 'load_time_ms': 4.31, 'load_throughput': 928051.156, 'learn_time_ms': 130190.703, 'learn_throughput': 30.724, 'synch_weights_time_ms': 14.861}, 'counters': {'num_env_steps_sampled': 104000, 'num_env_steps_trained': 104000, 'num_agent_steps_sampled': 104000, 'num_agent_steps_trained': 104000}, 'done': False, 'episodes_total': 151, 'training_iteration': 26, 'trial_id': 'default', 'date': '2024-05-10_13-23-24', 'timestamp': 1715343804, 'time_this_iter_s': 146.28980612754822, 'time_total_s': 3662.449317932129, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 3662.449317932129, 'iterations_since_restore': 26, 'perf': {'cpu_util_percent': 41.17294685990338, 'ram_util_percent': 67.43864734299517}}
	Step: 26
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 2.568290798117717, 'cur_kl_coeff': 0.08437500000000002, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.062131762930182036, 'policy_loss': -0.008387700718657303, 'vf_loss': 0.06895493707789849, 'vf_explained_var': -0.2661449690659841, 'kl': 0.01854253008804511, 'entropy': 1.3473677569820035, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 24645.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 108000, 'num_env_steps_trained': 108000, 'num_agent_steps_sampled': 108000, 'num_agent_steps_trained': 108000}, 'sampler_results': {'episode_reward_max': 7.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.41, 'episode_len_mean': 707.93, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 70793, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0], 'episode_lengths': [613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5694379361305493, 'mean_inference_ms': 8.513654308823348, 'mean_action_processing_ms': 0.11306875910397964, 'mean_env_wait_ms': 0.20935245908243744, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.22891664505004883, 'StateBufferConnector_ms': 0.004877567291259766, 'ViewRequirementAgentConnector_ms': 0.12880539894104004}, 'num_episodes': 4, 'episode_return_max': 7.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.41}, 'env_runner_results': {'episode_reward_max': 7.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.41, 'episode_len_mean': 707.93, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 70793, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0], 'episode_lengths': [613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5694379361305493, 'mean_inference_ms': 8.513654308823348, 'mean_action_processing_ms': 0.11306875910397964, 'mean_env_wait_ms': 0.20935245908243744, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.22891664505004883, 'StateBufferConnector_ms': 0.004877567291259766, 'ViewRequirementAgentConnector_ms': 0.12880539894104004}, 'num_episodes': 4, 'episode_return_max': 7.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.41}, 'episode_reward_max': 7.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.41, 'episode_len_mean': 707.93, 'episodes_this_iter': 4, 'episodes_timesteps_total': 70793, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0], 'episode_lengths': [613, 723, 607, 616, 506, 496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5694379361305493, 'mean_inference_ms': 8.513654308823348, 'mean_action_processing_ms': 0.11306875910397964, 'mean_env_wait_ms': 0.20935245908243744, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.22891664505004883, 'StateBufferConnector_ms': 0.004877567291259766, 'ViewRequirementAgentConnector_ms': 0.12880539894104004}, 'num_episodes': 4, 'episode_return_max': 7.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.41, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 108000, 'num_agent_steps_trained': 108000, 'num_env_steps_sampled': 108000, 'num_env_steps_trained': 108000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 27.899570641329703, 'num_env_steps_trained_throughput_per_sec': 27.899570641329703, 'timesteps_total': 108000, 'num_env_steps_sampled_lifetime': 108000, 'num_agent_steps_sampled_lifetime': 108000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 108000, 'timers': {'training_iteration_time_ms': 149221.615, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 149221.615, 'sample_time_ms': 18442.61, 'load_time_ms': 4.21, 'load_throughput': 950114.452, 'learn_time_ms': 130759.744, 'learn_throughput': 30.59, 'synch_weights_time_ms': 14.633}, 'counters': {'num_env_steps_sampled': 108000, 'num_env_steps_trained': 108000, 'num_agent_steps_sampled': 108000, 'num_agent_steps_trained': 108000}, 'done': False, 'episodes_total': 155, 'training_iteration': 27, 'trial_id': 'default', 'date': '2024-05-10_13-25-48', 'timestamp': 1715343948, 'time_this_iter_s': 143.4027132987976, 'time_total_s': 3805.8520312309265, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 3805.8520312309265, 'iterations_since_restore': 27, 'perf': {'cpu_util_percent': 43.17142857142857, 'ram_util_percent': 67.8320197044335}}
	Step: 27
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 2.8401596342844346, 'cur_kl_coeff': 0.08437500000000002, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.06047932342576083, 'policy_loss': -0.003213140907226711, 'vf_loss': 0.0629952778676725, 'vf_explained_var': -0.2290076276307465, 'kl': 0.00826295275505461, 'entropy': 1.3584638326398788, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 25575.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 112000, 'num_env_steps_trained': 112000, 'num_agent_steps_sampled': 112000, 'num_agent_steps_trained': 112000}, 'sampler_results': {'episode_reward_max': 7.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.45, 'episode_len_mean': 716.85, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 71685, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0], 'episode_lengths': [496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5691795722231674, 'mean_inference_ms': 8.513247182945411, 'mean_action_processing_ms': 0.11297333124806458, 'mean_env_wait_ms': 0.2093937061237342, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.226409912109375, 'StateBufferConnector_ms': 0.004877567291259766, 'ViewRequirementAgentConnector_ms': 0.12840604782104492}, 'num_episodes': 5, 'episode_return_max': 7.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.45}, 'env_runner_results': {'episode_reward_max': 7.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.45, 'episode_len_mean': 716.85, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 71685, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0], 'episode_lengths': [496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5691795722231674, 'mean_inference_ms': 8.513247182945411, 'mean_action_processing_ms': 0.11297333124806458, 'mean_env_wait_ms': 0.2093937061237342, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.226409912109375, 'StateBufferConnector_ms': 0.004877567291259766, 'ViewRequirementAgentConnector_ms': 0.12840604782104492}, 'num_episodes': 5, 'episode_return_max': 7.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.45}, 'episode_reward_max': 7.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.45, 'episode_len_mean': 716.85, 'episodes_this_iter': 5, 'episodes_timesteps_total': 71685, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0], 'episode_lengths': [496, 491, 607, 1142, 498, 495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5691795722231674, 'mean_inference_ms': 8.513247182945411, 'mean_action_processing_ms': 0.11297333124806458, 'mean_env_wait_ms': 0.2093937061237342, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.226409912109375, 'StateBufferConnector_ms': 0.004877567291259766, 'ViewRequirementAgentConnector_ms': 0.12840604782104492}, 'num_episodes': 5, 'episode_return_max': 7.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.45, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 112000, 'num_agent_steps_trained': 112000, 'num_env_steps_sampled': 112000, 'num_env_steps_trained': 112000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 27.20218296677787, 'num_env_steps_trained_throughput_per_sec': 27.20218296677787, 'timesteps_total': 112000, 'num_env_steps_sampled_lifetime': 112000, 'num_agent_steps_sampled_lifetime': 112000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 112000, 'timers': {'training_iteration_time_ms': 150198.112, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 150198.112, 'sample_time_ms': 18504.255, 'load_time_ms': 3.927, 'load_throughput': 1018683.992, 'learn_time_ms': 131674.877, 'learn_throughput': 30.378, 'synch_weights_time_ms': 14.635}, 'counters': {'num_env_steps_sampled': 112000, 'num_env_steps_trained': 112000, 'num_agent_steps_sampled': 112000, 'num_agent_steps_trained': 112000}, 'done': False, 'episodes_total': 160, 'training_iteration': 28, 'trial_id': 'default', 'date': '2024-05-10_13-28-15', 'timestamp': 1715344095, 'time_this_iter_s': 147.08351683616638, 'time_total_s': 3952.935548067093, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 3952.935548067093, 'iterations_since_restore': 28, 'perf': {'cpu_util_percent': 41.14688995215312, 'ram_util_percent': 70.96315789473684}}
	Step: 28
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 2.8656541974874594, 'cur_kl_coeff': 0.08437500000000002, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.07326258932871203, 'policy_loss': 0.003869411685774403, 'vf_loss': 0.06822256704783618, 'vf_explained_var': -0.4047046861981833, 'kl': 0.01387390911566235, 'entropy': 1.3364457848251508, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 26505.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 116000, 'num_env_steps_trained': 116000, 'num_agent_steps_sampled': 116000, 'num_agent_steps_trained': 116000}, 'sampler_results': {'episode_reward_max': 7.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.49, 'episode_len_mean': 723.49, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 72349, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0], 'episode_lengths': [495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5689519213378519, 'mean_inference_ms': 8.512580859335241, 'mean_action_processing_ms': 0.11288194998546715, 'mean_env_wait_ms': 0.20952244563630218, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.22234845161437988, 'StateBufferConnector_ms': 0.004877567291259766, 'ViewRequirementAgentConnector_ms': 0.12560391426086426}, 'num_episodes': 5, 'episode_return_max': 7.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.49}, 'env_runner_results': {'episode_reward_max': 7.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.49, 'episode_len_mean': 723.49, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 72349, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0], 'episode_lengths': [495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5689519213378519, 'mean_inference_ms': 8.512580859335241, 'mean_action_processing_ms': 0.11288194998546715, 'mean_env_wait_ms': 0.20952244563630218, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.22234845161437988, 'StateBufferConnector_ms': 0.004877567291259766, 'ViewRequirementAgentConnector_ms': 0.12560391426086426}, 'num_episodes': 5, 'episode_return_max': 7.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.49}, 'episode_reward_max': 7.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.49, 'episode_len_mean': 723.49, 'episodes_this_iter': 5, 'episodes_timesteps_total': 72349, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [0.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0], 'episode_lengths': [495, 615, 494, 732, 614, 808, 607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5689519213378519, 'mean_inference_ms': 8.512580859335241, 'mean_action_processing_ms': 0.11288194998546715, 'mean_env_wait_ms': 0.20952244563630218, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.22234845161437988, 'StateBufferConnector_ms': 0.004877567291259766, 'ViewRequirementAgentConnector_ms': 0.12560391426086426}, 'num_episodes': 5, 'episode_return_max': 7.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.49, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 116000, 'num_agent_steps_trained': 116000, 'num_env_steps_sampled': 116000, 'num_env_steps_trained': 116000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 25.51559665973278, 'num_env_steps_trained_throughput_per_sec': 25.51559665973278, 'timesteps_total': 116000, 'num_env_steps_sampled_lifetime': 116000, 'num_agent_steps_sampled_lifetime': 116000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 116000, 'timers': {'training_iteration_time_ms': 151208.997, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 151208.997, 'sample_time_ms': 18567.477, 'load_time_ms': 3.863, 'load_throughput': 1035445.26, 'learn_time_ms': 132621.487, 'learn_throughput': 30.161, 'synch_weights_time_ms': 15.531}, 'counters': {'num_env_steps_sampled': 116000, 'num_env_steps_trained': 116000, 'num_agent_steps_sampled': 116000, 'num_agent_steps_trained': 116000}, 'done': False, 'episodes_total': 165, 'training_iteration': 29, 'trial_id': 'default', 'date': '2024-05-10_13-30-52', 'timestamp': 1715344252, 'time_this_iter_s': 156.79977560043335, 'time_total_s': 4109.735323667526, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 4109.735323667526, 'iterations_since_restore': 29, 'perf': {'cpu_util_percent': 46.06018099547511, 'ram_util_percent': 72.9049773755656}}
	Step: 29
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.7993092740174903, 'cur_kl_coeff': 0.08437500000000002, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.033536158584468866, 'policy_loss': 0.004679808463345492, 'vf_loss': 0.028284751670685428, 'vf_explained_var': -0.6882050685985114, 'kl': 0.006774532159015259, 'entropy': 1.3273760999402693, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 27435.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 120000, 'num_env_steps_trained': 120000, 'num_agent_steps_sampled': 120000, 'num_agent_steps_trained': 120000}, 'sampler_results': {'episode_reward_max': 7.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.5, 'episode_len_mean': 725.83, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 72583, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0], 'episode_lengths': [607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5691630032372776, 'mean_inference_ms': 8.51347973223321, 'mean_action_processing_ms': 0.11284606808700129, 'mean_env_wait_ms': 0.2097937096597276, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2160351276397705, 'StateBufferConnector_ms': 0.004877567291259766, 'ViewRequirementAgentConnector_ms': 0.12633490562438965}, 'num_episodes': 6, 'episode_return_max': 7.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.5}, 'env_runner_results': {'episode_reward_max': 7.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.5, 'episode_len_mean': 725.83, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 72583, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0], 'episode_lengths': [607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5691630032372776, 'mean_inference_ms': 8.51347973223321, 'mean_action_processing_ms': 0.11284606808700129, 'mean_env_wait_ms': 0.2097937096597276, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2160351276397705, 'StateBufferConnector_ms': 0.004877567291259766, 'ViewRequirementAgentConnector_ms': 0.12633490562438965}, 'num_episodes': 6, 'episode_return_max': 7.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.5}, 'episode_reward_max': 7.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.5, 'episode_len_mean': 725.83, 'episodes_this_iter': 6, 'episodes_timesteps_total': 72583, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0], 'episode_lengths': [607, 610, 788, 612, 492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5691630032372776, 'mean_inference_ms': 8.51347973223321, 'mean_action_processing_ms': 0.11284606808700129, 'mean_env_wait_ms': 0.2097937096597276, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2160351276397705, 'StateBufferConnector_ms': 0.004877567291259766, 'ViewRequirementAgentConnector_ms': 0.12633490562438965}, 'num_episodes': 6, 'episode_return_max': 7.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.5, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 120000, 'num_agent_steps_trained': 120000, 'num_env_steps_sampled': 120000, 'num_env_steps_trained': 120000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 24.420459606084265, 'num_env_steps_trained_throughput_per_sec': 24.420459606084265, 'timesteps_total': 120000, 'num_env_steps_sampled_lifetime': 120000, 'num_agent_steps_sampled_lifetime': 120000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 120000, 'timers': {'training_iteration_time_ms': 152638.089, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 152638.089, 'sample_time_ms': 18585.625, 'load_time_ms': 3.663, 'load_throughput': 1091911.227, 'learn_time_ms': 134032.79, 'learn_throughput': 29.843, 'synch_weights_time_ms': 15.391}, 'counters': {'num_env_steps_sampled': 120000, 'num_env_steps_trained': 120000, 'num_agent_steps_sampled': 120000, 'num_agent_steps_trained': 120000}, 'done': False, 'episodes_total': 171, 'training_iteration': 30, 'trial_id': 'default', 'date': '2024-05-10_13-33-36', 'timestamp': 1715344416, 'time_this_iter_s': 163.83739495277405, 'time_total_s': 4273.5727186203, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 4273.5727186203, 'iterations_since_restore': 30, 'perf': {'cpu_util_percent': 45.303448275862074, 'ram_util_percent': 73.00603448275862}}
	Step: 30
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 3.38237970336791, 'cur_kl_coeff': 0.08437500000000002, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.06436200612975705, 'policy_loss': -0.010523605523931404, 'vf_loss': 0.07404221996792683, 'vf_explained_var': -0.01841293035014983, 'kl': 0.009995764167291157, 'entropy': 1.3404221893638693, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 28365.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 124000, 'num_env_steps_trained': 124000, 'num_agent_steps_sampled': 124000, 'num_agent_steps_trained': 124000}, 'sampler_results': {'episode_reward_max': 7.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.51, 'episode_len_mean': 728.77, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 72877, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0], 'episode_lengths': [492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5690555948186911, 'mean_inference_ms': 8.513450019869897, 'mean_action_processing_ms': 0.1128022426263841, 'mean_env_wait_ms': 0.20991604753997767, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.21471309661865234, 'StateBufferConnector_ms': 0.004865169525146484, 'ViewRequirementAgentConnector_ms': 0.1273176670074463}, 'num_episodes': 4, 'episode_return_max': 7.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.51}, 'env_runner_results': {'episode_reward_max': 7.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.51, 'episode_len_mean': 728.77, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 72877, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0], 'episode_lengths': [492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5690555948186911, 'mean_inference_ms': 8.513450019869897, 'mean_action_processing_ms': 0.1128022426263841, 'mean_env_wait_ms': 0.20991604753997767, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.21471309661865234, 'StateBufferConnector_ms': 0.004865169525146484, 'ViewRequirementAgentConnector_ms': 0.1273176670074463}, 'num_episodes': 4, 'episode_return_max': 7.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.51}, 'episode_reward_max': 7.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.51, 'episode_len_mean': 728.77, 'episodes_this_iter': 4, 'episodes_timesteps_total': 72877, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 3.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0], 'episode_lengths': [492, 499, 911, 608, 496, 609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5690555948186911, 'mean_inference_ms': 8.513450019869897, 'mean_action_processing_ms': 0.1128022426263841, 'mean_env_wait_ms': 0.20991604753997767, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.21471309661865234, 'StateBufferConnector_ms': 0.004865169525146484, 'ViewRequirementAgentConnector_ms': 0.1273176670074463}, 'num_episodes': 4, 'episode_return_max': 7.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.51, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 124000, 'num_agent_steps_trained': 124000, 'num_env_steps_sampled': 124000, 'num_env_steps_trained': 124000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 24.56936431616277, 'num_env_steps_trained_throughput_per_sec': 24.56936431616277, 'timesteps_total': 124000, 'num_env_steps_sampled_lifetime': 124000, 'num_agent_steps_sampled_lifetime': 124000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 124000, 'timers': {'training_iteration_time_ms': 154934.385, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 154934.385, 'sample_time_ms': 18586.429, 'load_time_ms': 3.931, 'load_throughput': 1017608.889, 'learn_time_ms': 136327.898, 'learn_throughput': 29.341, 'synch_weights_time_ms': 15.506}, 'counters': {'num_env_steps_sampled': 124000, 'num_env_steps_trained': 124000, 'num_agent_steps_sampled': 124000, 'num_agent_steps_trained': 124000}, 'done': False, 'episodes_total': 175, 'training_iteration': 31, 'trial_id': 'default', 'date': '2024-05-10_13-36-19', 'timestamp': 1715344579, 'time_this_iter_s': 162.83916187286377, 'time_total_s': 4436.411880493164, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 4436.411880493164, 'iterations_since_restore': 31, 'perf': {'cpu_util_percent': 48.44869565217391, 'ram_util_percent': 76.84130434782608}}
Saving weights...
	Step: 31
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 3.0329336268607006, 'cur_kl_coeff': 0.08437500000000002, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.0431375002448437, 'policy_loss': -0.003957067954764571, 'vf_loss': 0.0460320622444288, 'vf_explained_var': -0.07366636087817531, 'kl': 0.012592617511318498, 'entropy': 1.36026261186087, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 29295.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 128000, 'num_env_steps_trained': 128000, 'num_agent_steps_sampled': 128000, 'num_agent_steps_trained': 128000}, 'sampler_results': {'episode_reward_max': 7.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.62, 'episode_len_mean': 746.73, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 74673, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0], 'episode_lengths': [609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5687654852278297, 'mean_inference_ms': 8.513597335676165, 'mean_action_processing_ms': 0.11269013996558494, 'mean_env_wait_ms': 0.20997829948541852, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.21523642539978027, 'StateBufferConnector_ms': 0.003861665725708008, 'ViewRequirementAgentConnector_ms': 0.12770557403564453}, 'num_episodes': 5, 'episode_return_max': 7.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.62}, 'env_runner_results': {'episode_reward_max': 7.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.62, 'episode_len_mean': 746.73, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 74673, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0], 'episode_lengths': [609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5687654852278297, 'mean_inference_ms': 8.513597335676165, 'mean_action_processing_ms': 0.11269013996558494, 'mean_env_wait_ms': 0.20997829948541852, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.21523642539978027, 'StateBufferConnector_ms': 0.003861665725708008, 'ViewRequirementAgentConnector_ms': 0.12770557403564453}, 'num_episodes': 5, 'episode_return_max': 7.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.62}, 'episode_reward_max': 7.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.62, 'episode_len_mean': 746.73, 'episodes_this_iter': 5, 'episodes_timesteps_total': 74673, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0], 'episode_lengths': [609, 507, 608, 620, 616, 499, 607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5687654852278297, 'mean_inference_ms': 8.513597335676165, 'mean_action_processing_ms': 0.11269013996558494, 'mean_env_wait_ms': 0.20997829948541852, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.21523642539978027, 'StateBufferConnector_ms': 0.003861665725708008, 'ViewRequirementAgentConnector_ms': 0.12770557403564453}, 'num_episodes': 5, 'episode_return_max': 7.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.62, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 128000, 'num_agent_steps_trained': 128000, 'num_env_steps_sampled': 128000, 'num_env_steps_trained': 128000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 23.42246713344333, 'num_env_steps_trained_throughput_per_sec': 23.42246713344333, 'timesteps_total': 128000, 'num_env_steps_sampled_lifetime': 128000, 'num_agent_steps_sampled_lifetime': 128000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 128000, 'timers': {'training_iteration_time_ms': 157731.403, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 157731.403, 'sample_time_ms': 18850.476, 'load_time_ms': 4.341, 'load_throughput': 921465.582, 'learn_time_ms': 138859.477, 'learn_throughput': 28.806, 'synch_weights_time_ms': 16.488}, 'counters': {'num_env_steps_sampled': 128000, 'num_env_steps_trained': 128000, 'num_agent_steps_sampled': 128000, 'num_agent_steps_trained': 128000}, 'done': False, 'episodes_total': 180, 'training_iteration': 32, 'trial_id': 'default', 'date': '2024-05-10_13-39-09', 'timestamp': 1715344749, 'time_this_iter_s': 170.79731249809265, 'time_total_s': 4607.209192991257, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 4607.209192991257, 'iterations_since_restore': 32, 'perf': {'cpu_util_percent': 56.550826446280986, 'ram_util_percent': 87.7392561983471}}
	Step: 32
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 3.2947080471502836, 'cur_kl_coeff': 0.08437500000000002, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.035406030731536045, 'policy_loss': -0.011773754025418913, 'vf_loss': 0.04594214898909652, 'vf_explained_var': -0.4328756533643251, 'kl': 0.014668278403272075, 'entropy': 1.3629067869596583, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 30225.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 132000, 'num_env_steps_trained': 132000, 'num_agent_steps_sampled': 132000, 'num_agent_steps_trained': 132000}, 'sampler_results': {'episode_reward_max': 7.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.69, 'episode_len_mean': 759.74, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 75974, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0], 'episode_lengths': [607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.568913519187697, 'mean_inference_ms': 8.515712967535173, 'mean_action_processing_ms': 0.11261107260809795, 'mean_env_wait_ms': 0.21016746217632887, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2222280502319336, 'StateBufferConnector_ms': 0.004369974136352539, 'ViewRequirementAgentConnector_ms': 0.13778185844421387}, 'num_episodes': 6, 'episode_return_max': 7.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.69}, 'env_runner_results': {'episode_reward_max': 7.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.69, 'episode_len_mean': 759.74, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 75974, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0], 'episode_lengths': [607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.568913519187697, 'mean_inference_ms': 8.515712967535173, 'mean_action_processing_ms': 0.11261107260809795, 'mean_env_wait_ms': 0.21016746217632887, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2222280502319336, 'StateBufferConnector_ms': 0.004369974136352539, 'ViewRequirementAgentConnector_ms': 0.13778185844421387}, 'num_episodes': 6, 'episode_return_max': 7.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.69}, 'episode_reward_max': 7.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.69, 'episode_len_mean': 759.74, 'episodes_this_iter': 6, 'episodes_timesteps_total': 75974, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [1.0, 7.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0], 'episode_lengths': [607, 1491, 604, 492, 492, 524, 738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.568913519187697, 'mean_inference_ms': 8.515712967535173, 'mean_action_processing_ms': 0.11261107260809795, 'mean_env_wait_ms': 0.21016746217632887, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2222280502319336, 'StateBufferConnector_ms': 0.004369974136352539, 'ViewRequirementAgentConnector_ms': 0.13778185844421387}, 'num_episodes': 6, 'episode_return_max': 7.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.69, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 132000, 'num_agent_steps_trained': 132000, 'num_env_steps_sampled': 132000, 'num_env_steps_trained': 132000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 19.41235897673209, 'num_env_steps_trained_throughput_per_sec': 19.41235897673209, 'timesteps_total': 132000, 'num_env_steps_sampled_lifetime': 132000, 'num_agent_steps_sampled_lifetime': 132000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 132000, 'timers': {'training_iteration_time_ms': 157828.455, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 157828.455, 'sample_time_ms': 19687.49, 'load_time_ms': 4.8, 'load_throughput': 833397.877, 'learn_time_ms': 138118.793, 'learn_throughput': 28.961, 'synch_weights_time_ms': 16.65}, 'counters': {'num_env_steps_sampled': 132000, 'num_env_steps_trained': 132000, 'num_agent_steps_sampled': 132000, 'num_agent_steps_trained': 132000}, 'done': False, 'episodes_total': 186, 'training_iteration': 33, 'trial_id': 'default', 'date': '2024-05-10_13-42-36', 'timestamp': 1715344956, 'time_this_iter_s': 206.0852837562561, 'time_total_s': 4813.294476747513, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 4813.294476747513, 'iterations_since_restore': 33, 'perf': {'cpu_util_percent': 85.82941176470588, 'ram_util_percent': 82.51038062283737}}
	Step: 33
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 2.8731135460317776, 'cur_kl_coeff': 0.08437500000000002, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.03752018426575007, 'policy_loss': -0.005890670046210289, 'vf_loss': 0.04240954676874593, 'vf_explained_var': -0.5172083623947635, 'kl': 0.011867326779021713, 'entropy': 1.3537294918490994, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 31155.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 136000, 'num_env_steps_trained': 136000, 'num_agent_steps_sampled': 136000, 'num_agent_steps_trained': 136000}, 'sampler_results': {'episode_reward_max': 6.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.66, 'episode_len_mean': 756.82, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 75682, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0], 'episode_lengths': [738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5688795805911515, 'mean_inference_ms': 8.51655891233277, 'mean_action_processing_ms': 0.11248398978998042, 'mean_env_wait_ms': 0.21034793007581543, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.22690606117248535, 'StateBufferConnector_ms': 0.0033669471740722656, 'ViewRequirementAgentConnector_ms': 0.1416642665863037}, 'num_episodes': 6, 'episode_return_max': 6.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.66}, 'env_runner_results': {'episode_reward_max': 6.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.66, 'episode_len_mean': 756.82, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 75682, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0], 'episode_lengths': [738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5688795805911515, 'mean_inference_ms': 8.51655891233277, 'mean_action_processing_ms': 0.11248398978998042, 'mean_env_wait_ms': 0.21034793007581543, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.22690606117248535, 'StateBufferConnector_ms': 0.0033669471740722656, 'ViewRequirementAgentConnector_ms': 0.1416642665863037}, 'num_episodes': 6, 'episode_return_max': 6.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.66}, 'episode_reward_max': 6.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.66, 'episode_len_mean': 756.82, 'episodes_this_iter': 6, 'episodes_timesteps_total': 75682, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [2.0, 0.0, 1.0, 2.0, 3.0, 0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0], 'episode_lengths': [738, 518, 614, 795, 927, 500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5688795805911515, 'mean_inference_ms': 8.51655891233277, 'mean_action_processing_ms': 0.11248398978998042, 'mean_env_wait_ms': 0.21034793007581543, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.22690606117248535, 'StateBufferConnector_ms': 0.0033669471740722656, 'ViewRequirementAgentConnector_ms': 0.1416642665863037}, 'num_episodes': 6, 'episode_return_max': 6.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.66, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 136000, 'num_agent_steps_trained': 136000, 'num_env_steps_sampled': 136000, 'num_env_steps_trained': 136000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 21.48632917025409, 'num_env_steps_trained_throughput_per_sec': 21.48632917025409, 'timesteps_total': 136000, 'num_env_steps_sampled_lifetime': 136000, 'num_agent_steps_sampled_lifetime': 136000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 136000, 'timers': {'training_iteration_time_ms': 162499.592, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 162499.592, 'sample_time_ms': 19919.302, 'load_time_ms': 4.965, 'load_throughput': 805609.277, 'learn_time_ms': 142558.749, 'learn_throughput': 28.059, 'synch_weights_time_ms': 15.854}, 'counters': {'num_env_steps_sampled': 136000, 'num_env_steps_trained': 136000, 'num_agent_steps_sampled': 136000, 'num_agent_steps_trained': 136000}, 'done': False, 'episodes_total': 192, 'training_iteration': 34, 'trial_id': 'default', 'date': '2024-05-10_13-45-42', 'timestamp': 1715345142, 'time_this_iter_s': 186.20175528526306, 'time_total_s': 4999.496232032776, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 4999.496232032776, 'iterations_since_restore': 34, 'perf': {'cpu_util_percent': 64.743893129771, 'ram_util_percent': 78.96870229007632}}
	Step: 34
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 2.936125071442896, 'cur_kl_coeff': 0.08437500000000002, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.029470358242190655, 'policy_loss': -0.00931129071020311, 'vf_loss': 0.03736050338703408, 'vf_explained_var': -0.47266829148415596, 'kl': 0.016843171655143378, 'entropy': 1.3506886046419861, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 32085.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 140000, 'num_env_steps_trained': 140000, 'num_agent_steps_sampled': 140000, 'num_agent_steps_trained': 140000}, 'sampler_results': {'episode_reward_max': 6.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.64, 'episode_len_mean': 754.87, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 75487, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0], 'episode_lengths': [500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5695727053002582, 'mean_inference_ms': 8.52026931473255, 'mean_action_processing_ms': 0.112555510868943, 'mean_env_wait_ms': 0.21067194552410073, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.22956609725952148, 'StateBufferConnector_ms': 0.0033669471740722656, 'ViewRequirementAgentConnector_ms': 0.14115667343139648}, 'num_episodes': 5, 'episode_return_max': 6.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.64}, 'env_runner_results': {'episode_reward_max': 6.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.64, 'episode_len_mean': 754.87, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 75487, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0], 'episode_lengths': [500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5695727053002582, 'mean_inference_ms': 8.52026931473255, 'mean_action_processing_ms': 0.112555510868943, 'mean_env_wait_ms': 0.21067194552410073, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.22956609725952148, 'StateBufferConnector_ms': 0.0033669471740722656, 'ViewRequirementAgentConnector_ms': 0.14115667343139648}, 'num_episodes': 5, 'episode_return_max': 6.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.64}, 'episode_reward_max': 6.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.64, 'episode_len_mean': 754.87, 'episodes_this_iter': 5, 'episodes_timesteps_total': 75487, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [0.0, 1.0, 1.0, 1.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0], 'episode_lengths': [500, 623, 608, 607, 1146, 602, 503, 510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5695727053002582, 'mean_inference_ms': 8.52026931473255, 'mean_action_processing_ms': 0.112555510868943, 'mean_env_wait_ms': 0.21067194552410073, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.22956609725952148, 'StateBufferConnector_ms': 0.0033669471740722656, 'ViewRequirementAgentConnector_ms': 0.14115667343139648}, 'num_episodes': 5, 'episode_return_max': 6.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.64, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 140000, 'num_agent_steps_trained': 140000, 'num_env_steps_sampled': 140000, 'num_env_steps_trained': 140000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 20.96836436600474, 'num_env_steps_trained_throughput_per_sec': 20.96836436600474, 'timesteps_total': 140000, 'num_env_steps_sampled_lifetime': 140000, 'num_agent_steps_sampled_lifetime': 140000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 140000, 'timers': {'training_iteration_time_ms': 167379.324, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 167379.324, 'sample_time_ms': 20575.042, 'load_time_ms': 4.916, 'load_throughput': 813622.238, 'learn_time_ms': 146781.88, 'learn_throughput': 27.251, 'synch_weights_time_ms': 16.763}, 'counters': {'num_env_steps_sampled': 140000, 'num_env_steps_trained': 140000, 'num_agent_steps_sampled': 140000, 'num_agent_steps_trained': 140000}, 'done': False, 'episodes_total': 197, 'training_iteration': 35, 'trial_id': 'default', 'date': '2024-05-10_13-48-53', 'timestamp': 1715345333, 'time_this_iter_s': 190.7996165752411, 'time_total_s': 5190.295848608017, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 5190.295848608017, 'iterations_since_restore': 35, 'perf': {'cpu_util_percent': 73.53382899628252, 'ram_util_percent': 73.88959107806693}}
	Step: 35
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 3.0070693849075223, 'cur_kl_coeff': 0.08437500000000002, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.029684112357195987, 'policy_loss': -0.005380052256007349, 'vf_loss': 0.034028556534109175, 'vf_explained_var': -0.5788701991240184, 'kl': 0.012273892099518516, 'entropy': 1.3166818471365078, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 33015.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 144000, 'num_env_steps_trained': 144000, 'num_agent_steps_sampled': 144000, 'num_agent_steps_trained': 144000}, 'sampler_results': {'episode_reward_max': 6.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.63, 'episode_len_mean': 754.76, 'episode_media': {}, 'episodes_this_iter': 7, 'episodes_timesteps_total': 75476, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0], 'episode_lengths': [510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5713159862905011, 'mean_inference_ms': 8.527808744581616, 'mean_action_processing_ms': 0.11287879127710898, 'mean_env_wait_ms': 0.21144349256914954, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.23593640327453613, 'StateBufferConnector_ms': 0.002942323684692383, 'ViewRequirementAgentConnector_ms': 0.14646577835083008}, 'num_episodes': 7, 'episode_return_max': 6.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.63}, 'env_runner_results': {'episode_reward_max': 6.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.63, 'episode_len_mean': 754.76, 'episode_media': {}, 'episodes_this_iter': 7, 'episodes_timesteps_total': 75476, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0], 'episode_lengths': [510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5713159862905011, 'mean_inference_ms': 8.527808744581616, 'mean_action_processing_ms': 0.11287879127710898, 'mean_env_wait_ms': 0.21144349256914954, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.23593640327453613, 'StateBufferConnector_ms': 0.002942323684692383, 'ViewRequirementAgentConnector_ms': 0.14646577835083008}, 'num_episodes': 7, 'episode_return_max': 6.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.63}, 'episode_reward_max': 6.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.63, 'episode_len_mean': 754.76, 'episodes_this_iter': 7, 'episodes_timesteps_total': 75476, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [0.0, 1.0, 3.0, 1.0, 1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0], 'episode_lengths': [510, 682, 919, 612, 607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5713159862905011, 'mean_inference_ms': 8.527808744581616, 'mean_action_processing_ms': 0.11287879127710898, 'mean_env_wait_ms': 0.21144349256914954, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.23593640327453613, 'StateBufferConnector_ms': 0.002942323684692383, 'ViewRequirementAgentConnector_ms': 0.14646577835083008}, 'num_episodes': 7, 'episode_return_max': 6.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.63, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 144000, 'num_agent_steps_trained': 144000, 'num_env_steps_sampled': 144000, 'num_env_steps_trained': 144000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 25.332910581014186, 'num_env_steps_trained_throughput_per_sec': 25.332910581014186, 'timesteps_total': 144000, 'num_env_steps_sampled_lifetime': 144000, 'num_agent_steps_sampled_lifetime': 144000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 144000, 'timers': {'training_iteration_time_ms': 168544.305, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 168544.305, 'sample_time_ms': 20793.941, 'load_time_ms': 5.463, 'load_throughput': 732236.222, 'learn_time_ms': 147727.364, 'learn_throughput': 27.077, 'synch_weights_time_ms': 16.814}, 'counters': {'num_env_steps_sampled': 144000, 'num_env_steps_trained': 144000, 'num_agent_steps_sampled': 144000, 'num_agent_steps_trained': 144000}, 'done': False, 'episodes_total': 204, 'training_iteration': 36, 'trial_id': 'default', 'date': '2024-05-10_13-51-31', 'timestamp': 1715345491, 'time_this_iter_s': 157.92958307266235, 'time_total_s': 5348.225431680679, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 5348.225431680679, 'iterations_since_restore': 36, 'perf': {'cpu_util_percent': 48.143497757847534, 'ram_util_percent': 54.62107623318386}}
	Step: 36
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 3.025664387402996, 'cur_kl_coeff': 0.08437500000000002, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.027403131824847993, 'policy_loss': -0.0038242737619927332, 'vf_loss': 0.030008281949376787, 'vf_explained_var': -0.2415054339875457, 'kl': 0.014448845408937313, 'entropy': 1.323334906562682, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 33945.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 148000, 'num_env_steps_trained': 148000, 'num_agent_steps_sampled': 148000, 'num_agent_steps_trained': 148000}, 'sampler_results': {'episode_reward_max': 6.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.65, 'episode_len_mean': 758.65, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 75865, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0], 'episode_lengths': [607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5726374619420076, 'mean_inference_ms': 8.533076596269801, 'mean_action_processing_ms': 0.11307991755436543, 'mean_env_wait_ms': 0.21195317948673836, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.24176287651062012, 'StateBufferConnector_ms': 0.002942323684692383, 'ViewRequirementAgentConnector_ms': 0.13823795318603516}, 'num_episodes': 4, 'episode_return_max': 6.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.65}, 'env_runner_results': {'episode_reward_max': 6.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.65, 'episode_len_mean': 758.65, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 75865, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0], 'episode_lengths': [607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5726374619420076, 'mean_inference_ms': 8.533076596269801, 'mean_action_processing_ms': 0.11307991755436543, 'mean_env_wait_ms': 0.21195317948673836, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.24176287651062012, 'StateBufferConnector_ms': 0.002942323684692383, 'ViewRequirementAgentConnector_ms': 0.13823795318603516}, 'num_episodes': 4, 'episode_return_max': 6.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.65}, 'episode_reward_max': 6.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.65, 'episode_len_mean': 758.65, 'episodes_this_iter': 4, 'episodes_timesteps_total': 75865, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [1.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0], 'episode_lengths': [607, 731, 503, 723, 495, 491, 489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5726374619420076, 'mean_inference_ms': 8.533076596269801, 'mean_action_processing_ms': 0.11307991755436543, 'mean_env_wait_ms': 0.21195317948673836, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.24176287651062012, 'StateBufferConnector_ms': 0.002942323684692383, 'ViewRequirementAgentConnector_ms': 0.13823795318603516}, 'num_episodes': 4, 'episode_return_max': 6.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.65, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 148000, 'num_agent_steps_trained': 148000, 'num_env_steps_sampled': 148000, 'num_env_steps_trained': 148000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 24.776916255881012, 'num_env_steps_trained_throughput_per_sec': 24.776916255881012, 'timesteps_total': 148000, 'num_env_steps_sampled_lifetime': 148000, 'num_agent_steps_sampled_lifetime': 148000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 148000, 'timers': {'training_iteration_time_ms': 170351.226, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 170351.226, 'sample_time_ms': 20991.534, 'load_time_ms': 5.363, 'load_throughput': 745816.467, 'learn_time_ms': 149336.765, 'learn_throughput': 26.785, 'synch_weights_time_ms': 16.84}, 'counters': {'num_env_steps_sampled': 148000, 'num_env_steps_trained': 148000, 'num_agent_steps_sampled': 148000, 'num_agent_steps_trained': 148000}, 'done': False, 'episodes_total': 208, 'training_iteration': 37, 'trial_id': 'default', 'date': '2024-05-10_13-54-12', 'timestamp': 1715345652, 'time_this_iter_s': 161.4709391593933, 'time_total_s': 5509.696370840073, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 5509.696370840073, 'iterations_since_restore': 37, 'perf': {'cpu_util_percent': 47.354824561403504, 'ram_util_percent': 62.978508771929825}}
	Step: 37
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 3.1191043186251837, 'cur_kl_coeff': 0.08437500000000002, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.019456873098087888, 'policy_loss': -0.011177422723142049, 'vf_loss': 0.028979424674624717, 'vf_explained_var': -0.17292318696616799, 'kl': 0.01961328571562325, 'entropy': 1.2572890855932748, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 34875.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 152000, 'num_env_steps_trained': 152000, 'num_agent_steps_sampled': 152000, 'num_agent_steps_trained': 152000}, 'sampler_results': {'episode_reward_max': 6.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.71, 'episode_len_mean': 771.1, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 77110, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0], 'episode_lengths': [489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.574645928271969, 'mean_inference_ms': 8.540805020153659, 'mean_action_processing_ms': 0.11337958903958055, 'mean_env_wait_ms': 0.21275237352505882, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.23363327980041504, 'StateBufferConnector_ms': 0.003948211669921875, 'ViewRequirementAgentConnector_ms': 0.13519906997680664}, 'num_episodes': 6, 'episode_return_max': 6.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.71}, 'env_runner_results': {'episode_reward_max': 6.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.71, 'episode_len_mean': 771.1, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 77110, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0], 'episode_lengths': [489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.574645928271969, 'mean_inference_ms': 8.540805020153659, 'mean_action_processing_ms': 0.11337958903958055, 'mean_env_wait_ms': 0.21275237352505882, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.23363327980041504, 'StateBufferConnector_ms': 0.003948211669921875, 'ViewRequirementAgentConnector_ms': 0.13519906997680664}, 'num_episodes': 6, 'episode_return_max': 6.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.71}, 'episode_reward_max': 6.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.71, 'episode_len_mean': 771.1, 'episodes_this_iter': 6, 'episodes_timesteps_total': 77110, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0], 'episode_lengths': [489, 691, 879, 685, 488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.574645928271969, 'mean_inference_ms': 8.540805020153659, 'mean_action_processing_ms': 0.11337958903958055, 'mean_env_wait_ms': 0.21275237352505882, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.23363327980041504, 'StateBufferConnector_ms': 0.003948211669921875, 'ViewRequirementAgentConnector_ms': 0.13519906997680664}, 'num_episodes': 6, 'episode_return_max': 6.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.71, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 152000, 'num_agent_steps_trained': 152000, 'num_env_steps_sampled': 152000, 'num_env_steps_trained': 152000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 27.248235123739672, 'num_env_steps_trained_throughput_per_sec': 27.248235123739672, 'timesteps_total': 152000, 'num_env_steps_sampled_lifetime': 152000, 'num_agent_steps_sampled_lifetime': 152000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 152000, 'timers': {'training_iteration_time_ms': 170326.373, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 170326.373, 'sample_time_ms': 20877.326, 'load_time_ms': 5.367, 'load_throughput': 745319.479, 'learn_time_ms': 149425.958, 'learn_throughput': 26.769, 'synch_weights_time_ms': 16.9}, 'counters': {'num_env_steps_sampled': 152000, 'num_env_steps_trained': 152000, 'num_agent_steps_sampled': 152000, 'num_agent_steps_trained': 152000}, 'done': False, 'episodes_total': 214, 'training_iteration': 38, 'trial_id': 'default', 'date': '2024-05-10_13-56-39', 'timestamp': 1715345799, 'time_this_iter_s': 146.83118271827698, 'time_total_s': 5656.52755355835, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 5656.52755355835, 'iterations_since_restore': 38, 'perf': {'cpu_util_percent': 45.65913461538461, 'ram_util_percent': 63.5125}}
	Step: 38
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 2.6794980715038954, 'cur_kl_coeff': 0.08437500000000002, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.029614607489577706, 'policy_loss': 0.00726819001438637, 'vf_loss': 0.02114335301780312, 'vf_explained_var': -0.24580779428123145, 'kl': 0.014258537283758381, 'entropy': 1.248699923612738, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 35805.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 156000, 'num_env_steps_trained': 156000, 'num_agent_steps_sampled': 156000, 'num_agent_steps_trained': 156000}, 'sampler_results': {'episode_reward_max': 6.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.75, 'episode_len_mean': 777.71, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 77771, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0], 'episode_lengths': [488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.576018839640802, 'mean_inference_ms': 8.545891178547453, 'mean_action_processing_ms': 0.11357398995538771, 'mean_env_wait_ms': 0.21326031391826647, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.23464035987854004, 'StateBufferConnector_ms': 0.002869129180908203, 'ViewRequirementAgentConnector_ms': 0.1386408805847168}, 'num_episodes': 4, 'episode_return_max': 6.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.75}, 'env_runner_results': {'episode_reward_max': 6.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.75, 'episode_len_mean': 777.71, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 77771, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0], 'episode_lengths': [488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.576018839640802, 'mean_inference_ms': 8.545891178547453, 'mean_action_processing_ms': 0.11357398995538771, 'mean_env_wait_ms': 0.21326031391826647, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.23464035987854004, 'StateBufferConnector_ms': 0.002869129180908203, 'ViewRequirementAgentConnector_ms': 0.1386408805847168}, 'num_episodes': 4, 'episode_return_max': 6.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.75}, 'episode_reward_max': 6.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.75, 'episode_len_mean': 777.71, 'episodes_this_iter': 4, 'episodes_timesteps_total': 77771, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0], 'episode_lengths': [488, 495, 801, 884, 789, 729, 1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.576018839640802, 'mean_inference_ms': 8.545891178547453, 'mean_action_processing_ms': 0.11357398995538771, 'mean_env_wait_ms': 0.21326031391826647, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.23464035987854004, 'StateBufferConnector_ms': 0.002869129180908203, 'ViewRequirementAgentConnector_ms': 0.1386408805847168}, 'num_episodes': 4, 'episode_return_max': 6.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.75, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 156000, 'num_agent_steps_trained': 156000, 'num_env_steps_sampled': 156000, 'num_env_steps_trained': 156000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 27.12448793952503, 'num_env_steps_trained_throughput_per_sec': 27.12448793952503, 'timesteps_total': 156000, 'num_env_steps_sampled_lifetime': 156000, 'num_agent_steps_sampled_lifetime': 156000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 156000, 'timers': {'training_iteration_time_ms': 169396.509, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 169396.509, 'sample_time_ms': 20968.216, 'load_time_ms': 5.611, 'load_throughput': 712913.871, 'learn_time_ms': 148405.873, 'learn_throughput': 26.953, 'synch_weights_time_ms': 16.207}, 'counters': {'num_env_steps_sampled': 156000, 'num_env_steps_trained': 156000, 'num_agent_steps_sampled': 156000, 'num_agent_steps_trained': 156000}, 'done': False, 'episodes_total': 218, 'training_iteration': 39, 'trial_id': 'default', 'date': '2024-05-10_13-59-07', 'timestamp': 1715345947, 'time_this_iter_s': 147.51962161064148, 'time_total_s': 5804.047175168991, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 5804.047175168991, 'iterations_since_restore': 39, 'perf': {'cpu_util_percent': 45.49043062200957, 'ram_util_percent': 63.9555023923445}}
	Step: 39
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 3.112892719173944, 'cur_kl_coeff': 0.08437500000000002, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.02482276553593536, 'policy_loss': -0.004809810236216553, 'vf_loss': 0.02899007755494426, 'vf_explained_var': -0.1872744978756033, 'kl': 0.007614766413096266, 'entropy': 1.2516623820027997, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 36735.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 160000, 'num_env_steps_trained': 160000, 'num_agent_steps_sampled': 160000, 'num_agent_steps_trained': 160000}, 'sampler_results': {'episode_reward_max': 6.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.77, 'episode_len_mean': 783.84, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 78384, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0], 'episode_lengths': [1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5778971148499124, 'mean_inference_ms': 8.55278692977989, 'mean_action_processing_ms': 0.1138142142085794, 'mean_env_wait_ms': 0.21398079919760346, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.22953462600708008, 'StateBufferConnector_ms': 0.0026776790618896484, 'ViewRequirementAgentConnector_ms': 0.13679957389831543}, 'num_episodes': 6, 'episode_return_max': 6.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.77}, 'env_runner_results': {'episode_reward_max': 6.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.77, 'episode_len_mean': 783.84, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 78384, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0], 'episode_lengths': [1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5778971148499124, 'mean_inference_ms': 8.55278692977989, 'mean_action_processing_ms': 0.1138142142085794, 'mean_env_wait_ms': 0.21398079919760346, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.22953462600708008, 'StateBufferConnector_ms': 0.0026776790618896484, 'ViewRequirementAgentConnector_ms': 0.13679957389831543}, 'num_episodes': 6, 'episode_return_max': 6.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.77}, 'episode_reward_max': 6.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.77, 'episode_len_mean': 783.84, 'episodes_this_iter': 6, 'episodes_timesteps_total': 78384, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [4.0, 4.0, 0.0, 3.0, 2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0], 'episode_lengths': [1174, 1184, 491, 992, 799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5778971148499124, 'mean_inference_ms': 8.55278692977989, 'mean_action_processing_ms': 0.1138142142085794, 'mean_env_wait_ms': 0.21398079919760346, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.22953462600708008, 'StateBufferConnector_ms': 0.0026776790618896484, 'ViewRequirementAgentConnector_ms': 0.13679957389831543}, 'num_episodes': 6, 'episode_return_max': 6.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.77, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 160000, 'num_agent_steps_trained': 160000, 'num_env_steps_sampled': 160000, 'num_env_steps_trained': 160000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 27.146736335392013, 'num_env_steps_trained_throughput_per_sec': 27.146736335392013, 'timesteps_total': 160000, 'num_env_steps_sampled_lifetime': 160000, 'num_agent_steps_sampled_lifetime': 160000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 160000, 'timers': {'training_iteration_time_ms': 167751.537, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 167751.537, 'sample_time_ms': 20890.275, 'load_time_ms': 5.672, 'load_throughput': 705259.892, 'learn_time_ms': 146838.593, 'learn_throughput': 27.241, 'synch_weights_time_ms': 16.291}, 'counters': {'num_env_steps_sampled': 160000, 'num_env_steps_trained': 160000, 'num_agent_steps_sampled': 160000, 'num_agent_steps_trained': 160000}, 'done': False, 'episodes_total': 224, 'training_iteration': 40, 'trial_id': 'default', 'date': '2024-05-10_14-01-34', 'timestamp': 1715346094, 'time_this_iter_s': 147.37568855285645, 'time_total_s': 5951.4228637218475, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 5951.4228637218475, 'iterations_since_restore': 40, 'perf': {'cpu_util_percent': 46.957692307692305, 'ram_util_percent': 63.67211538461538}}
	Step: 40
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 2.587595382973712, 'cur_kl_coeff': 0.08437500000000002, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.022736378126246955, 'policy_loss': 0.004458637523554986, 'vf_loss': 0.017557879293247338, 'vf_explained_var': 0.015616288749120568, 'kl': 0.00853168514200164, 'entropy': 1.278170044191422, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 37665.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 164000, 'num_env_steps_trained': 164000, 'num_agent_steps_sampled': 164000, 'num_agent_steps_trained': 164000}, 'sampler_results': {'episode_reward_max': 6.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.72, 'episode_len_mean': 776.01, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 77601, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0], 'episode_lengths': [799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5792730426125309, 'mean_inference_ms': 8.557672629927158, 'mean_action_processing_ms': 0.11406330357966482, 'mean_env_wait_ms': 0.2144926070394833, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.23266148567199707, 'StateBufferConnector_ms': 0.0026776790618896484, 'ViewRequirementAgentConnector_ms': 0.14091205596923828}, 'num_episodes': 4, 'episode_return_max': 6.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.72}, 'env_runner_results': {'episode_reward_max': 6.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.72, 'episode_len_mean': 776.01, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 77601, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0], 'episode_lengths': [799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5792730426125309, 'mean_inference_ms': 8.557672629927158, 'mean_action_processing_ms': 0.11406330357966482, 'mean_env_wait_ms': 0.2144926070394833, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.23266148567199707, 'StateBufferConnector_ms': 0.0026776790618896484, 'ViewRequirementAgentConnector_ms': 0.14091205596923828}, 'num_episodes': 4, 'episode_return_max': 6.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.72}, 'episode_reward_max': 6.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.72, 'episode_len_mean': 776.01, 'episodes_this_iter': 4, 'episodes_timesteps_total': 77601, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [2.0, 1.0, 0.0, 2.0, 0.0, 3.0, 1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0], 'episode_lengths': [799, 615, 492, 791, 489, 991, 692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5792730426125309, 'mean_inference_ms': 8.557672629927158, 'mean_action_processing_ms': 0.11406330357966482, 'mean_env_wait_ms': 0.2144926070394833, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.23266148567199707, 'StateBufferConnector_ms': 0.0026776790618896484, 'ViewRequirementAgentConnector_ms': 0.14091205596923828}, 'num_episodes': 4, 'episode_return_max': 6.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.72, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 164000, 'num_agent_steps_trained': 164000, 'num_env_steps_sampled': 164000, 'num_env_steps_trained': 164000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 27.42004076980859, 'num_env_steps_trained_throughput_per_sec': 27.42004076980859, 'timesteps_total': 164000, 'num_env_steps_sampled_lifetime': 164000, 'num_agent_steps_sampled_lifetime': 164000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 164000, 'timers': {'training_iteration_time_ms': 166058.97, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 166058.97, 'sample_time_ms': 20913.487, 'load_time_ms': 5.31, 'load_throughput': 753358.39, 'learn_time_ms': 145123.17, 'learn_throughput': 27.563, 'synch_weights_time_ms': 16.397}, 'counters': {'num_env_steps_sampled': 164000, 'num_env_steps_trained': 164000, 'num_agent_steps_sampled': 164000, 'num_agent_steps_trained': 164000}, 'done': False, 'episodes_total': 228, 'training_iteration': 41, 'trial_id': 'default', 'date': '2024-05-10_14-04-00', 'timestamp': 1715346240, 'time_this_iter_s': 145.90976214408875, 'time_total_s': 6097.332625865936, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 6097.332625865936, 'iterations_since_restore': 41, 'perf': {'cpu_util_percent': 46.576328502415464, 'ram_util_percent': 64.01980676328503}}
Saving weights...
	Step: 41
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 2.0538011461496355, 'cur_kl_coeff': 0.08437500000000002, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.009883513188074714, 'policy_loss': -0.005649760260336822, 'vf_loss': 0.01505813898358454, 'vf_explained_var': -0.38562349536085644, 'kl': 0.005631193702728989, 'entropy': 1.2868651286248238, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 38595.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 168000, 'num_env_steps_trained': 168000, 'num_agent_steps_sampled': 168000, 'num_agent_steps_trained': 168000}, 'sampler_results': {'episode_reward_max': 6.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.74, 'episode_len_mean': 782.1, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 78210, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0], 'episode_lengths': [692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5813369162566068, 'mean_inference_ms': 8.567977470233988, 'mean_action_processing_ms': 0.11439720553446187, 'mean_env_wait_ms': 0.21528258447040177, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.23593854904174805, 'StateBufferConnector_ms': 0.003676891326904297, 'ViewRequirementAgentConnector_ms': 0.1517658233642578}, 'num_episodes': 6, 'episode_return_max': 6.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.74}, 'env_runner_results': {'episode_reward_max': 6.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.74, 'episode_len_mean': 782.1, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 78210, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0], 'episode_lengths': [692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5813369162566068, 'mean_inference_ms': 8.567977470233988, 'mean_action_processing_ms': 0.11439720553446187, 'mean_env_wait_ms': 0.21528258447040177, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.23593854904174805, 'StateBufferConnector_ms': 0.003676891326904297, 'ViewRequirementAgentConnector_ms': 0.1517658233642578}, 'num_episodes': 6, 'episode_return_max': 6.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.74}, 'episode_reward_max': 6.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.74, 'episode_len_mean': 782.1, 'episodes_this_iter': 6, 'episodes_timesteps_total': 78210, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [1.0, 3.0, 2.0, 3.0, 4.0, 6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0], 'episode_lengths': [692, 988, 797, 980, 1180, 1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5813369162566068, 'mean_inference_ms': 8.567977470233988, 'mean_action_processing_ms': 0.11439720553446187, 'mean_env_wait_ms': 0.21528258447040177, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.23593854904174805, 'StateBufferConnector_ms': 0.003676891326904297, 'ViewRequirementAgentConnector_ms': 0.1517658233642578}, 'num_episodes': 6, 'episode_return_max': 6.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.74, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 168000, 'num_agent_steps_trained': 168000, 'num_env_steps_sampled': 168000, 'num_env_steps_trained': 168000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 23.211755072813467, 'num_env_steps_trained_throughput_per_sec': 23.211755072813467, 'timesteps_total': 168000, 'num_env_steps_sampled_lifetime': 168000, 'num_agent_steps_sampled_lifetime': 168000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 168000, 'timers': {'training_iteration_time_ms': 166213.998, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 166213.899, 'sample_time_ms': 20806.324, 'load_time_ms': 5.012, 'load_throughput': 798022.023, 'learn_time_ms': 145385.578, 'learn_throughput': 27.513, 'synch_weights_time_ms': 16.379}, 'counters': {'num_env_steps_sampled': 168000, 'num_env_steps_trained': 168000, 'num_agent_steps_sampled': 168000, 'num_agent_steps_trained': 168000}, 'done': False, 'episodes_total': 234, 'training_iteration': 42, 'trial_id': 'default', 'date': '2024-05-10_14-06-52', 'timestamp': 1715346412, 'time_this_iter_s': 172.35969519615173, 'time_total_s': 6269.692321062088, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 6269.692321062088, 'iterations_since_restore': 42, 'perf': {'cpu_util_percent': 57.92716049382716, 'ram_util_percent': 83.0485596707819}}
	Step: 42
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 2.6174607973265394, 'cur_kl_coeff': 0.08437500000000002, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.006316491436733994, 'policy_loss': -0.00865021392863284, 'vf_loss': 0.013582506297051065, 'vf_explained_var': -0.30211919494854506, 'kl': 0.016405331506707917, 'entropy': 1.2947125791221537, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 39525.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 172000, 'num_env_steps_trained': 172000, 'num_agent_steps_sampled': 172000, 'num_agent_steps_trained': 172000}, 'sampler_results': {'episode_reward_max': 6.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.67, 'episode_len_mean': 770.32, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 77032, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0], 'episode_lengths': [1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.583566978949894, 'mean_inference_ms': 8.581568267045732, 'mean_action_processing_ms': 0.11479217336347673, 'mean_env_wait_ms': 0.21609950861705474, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.24389314651489258, 'StateBufferConnector_ms': 0.003676891326904297, 'ViewRequirementAgentConnector_ms': 0.15442657470703125}, 'num_episodes': 5, 'episode_return_max': 6.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.67}, 'env_runner_results': {'episode_reward_max': 6.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.67, 'episode_len_mean': 770.32, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 77032, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0], 'episode_lengths': [1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.583566978949894, 'mean_inference_ms': 8.581568267045732, 'mean_action_processing_ms': 0.11479217336347673, 'mean_env_wait_ms': 0.21609950861705474, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.24389314651489258, 'StateBufferConnector_ms': 0.003676891326904297, 'ViewRequirementAgentConnector_ms': 0.15442657470703125}, 'num_episodes': 5, 'episode_return_max': 6.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.67}, 'episode_reward_max': 6.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.67, 'episode_len_mean': 770.32, 'episodes_this_iter': 5, 'episodes_timesteps_total': 77032, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [6.0, 3.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0], 'episode_lengths': [1584, 991, 984, 496, 988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.583566978949894, 'mean_inference_ms': 8.581568267045732, 'mean_action_processing_ms': 0.11479217336347673, 'mean_env_wait_ms': 0.21609950861705474, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.24389314651489258, 'StateBufferConnector_ms': 0.003676891326904297, 'ViewRequirementAgentConnector_ms': 0.15442657470703125}, 'num_episodes': 5, 'episode_return_max': 6.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.67, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 172000, 'num_agent_steps_trained': 172000, 'num_env_steps_sampled': 172000, 'num_env_steps_trained': 172000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 19.942678630374814, 'num_env_steps_trained_throughput_per_sec': 19.942678630374814, 'timesteps_total': 172000, 'num_env_steps_sampled_lifetime': 172000, 'num_agent_steps_sampled_lifetime': 172000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 172000, 'timers': {'training_iteration_time_ms': 165666.054, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 165665.956, 'sample_time_ms': 20957.236, 'load_time_ms': 4.806, 'load_throughput': 832256.842, 'learn_time_ms': 144686.844, 'learn_throughput': 27.646, 'synch_weights_time_ms': 16.365}, 'counters': {'num_env_steps_sampled': 172000, 'num_env_steps_trained': 172000, 'num_agent_steps_sampled': 172000, 'num_agent_steps_trained': 172000}, 'done': False, 'episodes_total': 239, 'training_iteration': 43, 'trial_id': 'default', 'date': '2024-05-10_14-10-13', 'timestamp': 1715346613, 'time_this_iter_s': 200.61075258255005, 'time_total_s': 6470.303073644638, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 6470.303073644638, 'iterations_since_restore': 43, 'perf': {'cpu_util_percent': 72.87234042553192, 'ram_util_percent': 74.35496453900709}}
	Step: 43
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 3.1097772418491303, 'cur_kl_coeff': 0.08437500000000002, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.02163141111803231, 'policy_loss': -0.008137949538086692, 'vf_loss': 0.028701664623053322, 'vf_explained_var': 0.13058862955339492, 'kl': 0.012654157099857139, 'entropy': 1.2516547647855616, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 40455.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 176000, 'num_env_steps_trained': 176000, 'num_agent_steps_sampled': 176000, 'num_agent_steps_trained': 176000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.65, 'episode_len_mean': 765.98, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 76598, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0], 'episode_lengths': [988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5853678738670335, 'mean_inference_ms': 8.5925300031713, 'mean_action_processing_ms': 0.11510629815126094, 'mean_env_wait_ms': 0.21677180416642308, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2458958625793457, 'StateBufferConnector_ms': 0.004679441452026367, 'ViewRequirementAgentConnector_ms': 0.152435302734375}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.65}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.65, 'episode_len_mean': 765.98, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 76598, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0], 'episode_lengths': [988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5853678738670335, 'mean_inference_ms': 8.5925300031713, 'mean_action_processing_ms': 0.11510629815126094, 'mean_env_wait_ms': 0.21677180416642308, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2458958625793457, 'StateBufferConnector_ms': 0.004679441452026367, 'ViewRequirementAgentConnector_ms': 0.152435302734375}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.65}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.65, 'episode_len_mean': 765.98, 'episodes_this_iter': 4, 'episodes_timesteps_total': 76598, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0], 'episode_lengths': [988, 497, 987, 497, 797, 492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5853678738670335, 'mean_inference_ms': 8.5925300031713, 'mean_action_processing_ms': 0.11510629815126094, 'mean_env_wait_ms': 0.21677180416642308, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2458958625793457, 'StateBufferConnector_ms': 0.004679441452026367, 'ViewRequirementAgentConnector_ms': 0.152435302734375}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.65, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 176000, 'num_agent_steps_trained': 176000, 'num_env_steps_sampled': 176000, 'num_env_steps_trained': 176000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 27.58970570340992, 'num_env_steps_trained_throughput_per_sec': 27.58970570340992, 'timesteps_total': 176000, 'num_env_steps_sampled_lifetime': 176000, 'num_agent_steps_sampled_lifetime': 176000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 176000, 'timers': {'training_iteration_time_ms': 161547.727, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 161547.628, 'sample_time_ms': 20821.525, 'load_time_ms': 4.63, 'load_throughput': 863941.007, 'learn_time_ms': 140703.487, 'learn_throughput': 28.429, 'synch_weights_time_ms': 17.282}, 'counters': {'num_env_steps_sampled': 176000, 'num_env_steps_trained': 176000, 'num_agent_steps_sampled': 176000, 'num_agent_steps_trained': 176000}, 'done': False, 'episodes_total': 243, 'training_iteration': 44, 'trial_id': 'default', 'date': '2024-05-10_14-12-38', 'timestamp': 1715346758, 'time_this_iter_s': 145.0106122493744, 'time_total_s': 6615.313685894012, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 6615.313685894012, 'iterations_since_restore': 44, 'perf': {'cpu_util_percent': 43.1009756097561, 'ram_util_percent': 58.0809756097561}}
	Step: 44
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 2.2725205258015664, 'cur_kl_coeff': 0.08437500000000002, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.013374497468448094, 'policy_loss': -0.0014889386011868394, 'vf_loss': 0.013506333924509504, 'vf_explained_var': -0.035335309338826004, 'kl': 0.01608417312869579, 'entropy': 1.2134625102884027, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 41385.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 180000, 'num_env_steps_trained': 180000, 'num_agent_steps_sampled': 180000, 'num_agent_steps_trained': 180000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.7, 'episode_len_mean': 775.27, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 77527, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0], 'episode_lengths': [492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5876303542468487, 'mean_inference_ms': 8.60605763210244, 'mean_action_processing_ms': 0.11557591608024793, 'mean_env_wait_ms': 0.2176318170603536, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.23638153076171875, 'StateBufferConnector_ms': 0.004679441452026367, 'ViewRequirementAgentConnector_ms': 0.14940404891967773}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.7}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.7, 'episode_len_mean': 775.27, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 77527, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0], 'episode_lengths': [492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5876303542468487, 'mean_inference_ms': 8.60605763210244, 'mean_action_processing_ms': 0.11557591608024793, 'mean_env_wait_ms': 0.2176318170603536, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.23638153076171875, 'StateBufferConnector_ms': 0.004679441452026367, 'ViewRequirementAgentConnector_ms': 0.14940404891967773}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.7}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.7, 'episode_len_mean': 775.27, 'episodes_this_iter': 5, 'episodes_timesteps_total': 77527, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [0.0, 2.0, 0.0, 2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0], 'episode_lengths': [492, 807, 500, 799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5876303542468487, 'mean_inference_ms': 8.60605763210244, 'mean_action_processing_ms': 0.11557591608024793, 'mean_env_wait_ms': 0.2176318170603536, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.23638153076171875, 'StateBufferConnector_ms': 0.004679441452026367, 'ViewRequirementAgentConnector_ms': 0.14940404891967773}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.7, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 180000, 'num_agent_steps_trained': 180000, 'num_env_steps_sampled': 180000, 'num_env_steps_trained': 180000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 27.06647919723763, 'num_env_steps_trained_throughput_per_sec': 27.06647919723763, 'timesteps_total': 180000, 'num_env_steps_sampled_lifetime': 180000, 'num_agent_steps_sampled_lifetime': 180000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 180000, 'timers': {'training_iteration_time_ms': 157249.797, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 157249.699, 'sample_time_ms': 20170.001, 'load_time_ms': 4.582, 'load_throughput': 873040.329, 'learn_time_ms': 137058.139, 'learn_throughput': 29.185, 'synch_weights_time_ms': 16.272}, 'counters': {'num_env_steps_sampled': 180000, 'num_env_steps_trained': 180000, 'num_agent_steps_sampled': 180000, 'num_agent_steps_trained': 180000}, 'done': False, 'episodes_total': 248, 'training_iteration': 45, 'trial_id': 'default', 'date': '2024-05-10_14-15-06', 'timestamp': 1715346906, 'time_this_iter_s': 147.79427433013916, 'time_total_s': 6763.107960224152, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 6763.107960224152, 'iterations_since_restore': 45, 'perf': {'cpu_util_percent': 46.41004784688995, 'ram_util_percent': 59.75358851674641}}
	Step: 45
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.8720130247774944, 'cur_kl_coeff': 0.08437500000000002, 'cur_lr': 5.0000000000000016e-05, 'total_loss': -0.0027359876560763287, 'policy_loss': -0.0168818173344217, 'vf_loss': 0.012187505528200618, 'vf_explained_var': 0.1957301119963328, 'kl': 0.02320975778688758, 'entropy': 1.2454393157394983, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 42315.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 184000, 'num_env_steps_trained': 184000, 'num_agent_steps_sampled': 184000, 'num_agent_steps_trained': 184000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.76, 'episode_len_mean': 785.71, 'episode_media': {}, 'episodes_this_iter': 3, 'episodes_timesteps_total': 78571, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0], 'episode_lengths': [799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.588948677369249, 'mean_inference_ms': 8.61267016303286, 'mean_action_processing_ms': 0.11578985354088722, 'mean_env_wait_ms': 0.21812498704438746, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2410717010498047, 'StateBufferConnector_ms': 0.004679441452026367, 'ViewRequirementAgentConnector_ms': 0.15248417854309082}, 'num_episodes': 3, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.76}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.76, 'episode_len_mean': 785.71, 'episode_media': {}, 'episodes_this_iter': 3, 'episodes_timesteps_total': 78571, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0], 'episode_lengths': [799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.588948677369249, 'mean_inference_ms': 8.61267016303286, 'mean_action_processing_ms': 0.11578985354088722, 'mean_env_wait_ms': 0.21812498704438746, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2410717010498047, 'StateBufferConnector_ms': 0.004679441452026367, 'ViewRequirementAgentConnector_ms': 0.15248417854309082}, 'num_episodes': 3, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.76}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.76, 'episode_len_mean': 785.71, 'episodes_this_iter': 3, 'episodes_timesteps_total': 78571, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [2.0, 4.0, 3.0, 2.0, 3.0, 3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0], 'episode_lengths': [799, 1196, 988, 802, 996, 985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.588948677369249, 'mean_inference_ms': 8.61267016303286, 'mean_action_processing_ms': 0.11578985354088722, 'mean_env_wait_ms': 0.21812498704438746, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2410717010498047, 'StateBufferConnector_ms': 0.004679441452026367, 'ViewRequirementAgentConnector_ms': 0.15248417854309082}, 'num_episodes': 3, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.76, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 184000, 'num_agent_steps_trained': 184000, 'num_env_steps_sampled': 184000, 'num_env_steps_trained': 184000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 26.214530704011683, 'num_env_steps_trained_throughput_per_sec': 26.214530704011683, 'timesteps_total': 184000, 'num_env_steps_sampled_lifetime': 184000, 'num_agent_steps_sampled_lifetime': 184000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 184000, 'timers': {'training_iteration_time_ms': 156718.773, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 156718.675, 'sample_time_ms': 19572.337, 'load_time_ms': 4.088, 'load_throughput': 978463.01, 'learn_time_ms': 137125.425, 'learn_throughput': 29.17, 'synch_weights_time_ms': 16.22}, 'counters': {'num_env_steps_sampled': 184000, 'num_env_steps_trained': 184000, 'num_agent_steps_sampled': 184000, 'num_agent_steps_trained': 184000}, 'done': False, 'episodes_total': 251, 'training_iteration': 46, 'trial_id': 'default', 'date': '2024-05-10_14-17-39', 'timestamp': 1715347059, 'time_this_iter_s': 152.61914157867432, 'time_total_s': 6915.727101802826, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 6915.727101802826, 'iterations_since_restore': 46, 'perf': {'cpu_util_percent': 49.46604651162791, 'ram_util_percent': 72.37162790697674}}
	Step: 46
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.6568020532047876, 'cur_kl_coeff': 0.12656249999999997, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.013185680657625199, 'policy_loss': 0.0013552990591814442, 'vf_loss': 0.009920441357278695, 'vf_explained_var': 0.20949845865208616, 'kl': 0.015090885108388637, 'entropy': 1.2119309917573007, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 43245.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 188000, 'num_env_steps_trained': 188000, 'num_agent_steps_sampled': 188000, 'num_agent_steps_trained': 188000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.74, 'episode_len_mean': 781.78, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 78178, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0], 'episode_lengths': [985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5912609361834427, 'mean_inference_ms': 8.623978941406593, 'mean_action_processing_ms': 0.11627333081613761, 'mean_env_wait_ms': 0.2190056179534866, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2466425895690918, 'StateBufferConnector_ms': 0.0056610107421875, 'ViewRequirementAgentConnector_ms': 0.1559007167816162}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.74}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.74, 'episode_len_mean': 781.78, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 78178, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0], 'episode_lengths': [985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5912609361834427, 'mean_inference_ms': 8.623978941406593, 'mean_action_processing_ms': 0.11627333081613761, 'mean_env_wait_ms': 0.2190056179534866, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2466425895690918, 'StateBufferConnector_ms': 0.0056610107421875, 'ViewRequirementAgentConnector_ms': 0.1559007167816162}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.74}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.74, 'episode_len_mean': 781.78, 'episodes_this_iter': 5, 'episodes_timesteps_total': 78178, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [3.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0], 'episode_lengths': [985, 499, 493, 984, 876, 610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5912609361834427, 'mean_inference_ms': 8.623978941406593, 'mean_action_processing_ms': 0.11627333081613761, 'mean_env_wait_ms': 0.2190056179534866, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2466425895690918, 'StateBufferConnector_ms': 0.0056610107421875, 'ViewRequirementAgentConnector_ms': 0.1559007167816162}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.74, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 188000, 'num_agent_steps_trained': 188000, 'num_env_steps_sampled': 188000, 'num_env_steps_trained': 188000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 25.601584980937854, 'num_env_steps_trained_throughput_per_sec': 25.601584980937854, 'timesteps_total': 188000, 'num_env_steps_sampled_lifetime': 188000, 'num_agent_steps_sampled_lifetime': 188000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 188000, 'timers': {'training_iteration_time_ms': 156198.747, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 156198.648, 'sample_time_ms': 19569.826, 'load_time_ms': 4.281, 'load_throughput': 934257.871, 'learn_time_ms': 136607.774, 'learn_throughput': 29.281, 'synch_weights_time_ms': 16.146}, 'counters': {'num_env_steps_sampled': 188000, 'num_env_steps_trained': 188000, 'num_agent_steps_sampled': 188000, 'num_agent_steps_trained': 188000}, 'done': False, 'episodes_total': 256, 'training_iteration': 47, 'trial_id': 'default', 'date': '2024-05-10_14-20-15', 'timestamp': 1715347215, 'time_this_iter_s': 156.28192806243896, 'time_total_s': 7072.009029865265, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 7072.009029865265, 'iterations_since_restore': 47, 'perf': {'cpu_util_percent': 44.48552036199095, 'ram_util_percent': 59.17511312217195}}
	Step: 47
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 2.0213643108965247, 'cur_kl_coeff': 0.12656249999999997, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.00679214610367693, 'policy_loss': -0.003879222986839151, 'vf_loss': 0.009998530374153929, 'vf_explained_var': -0.10884302649446713, 'kl': 0.005316241847626301, 'entropy': 1.1995637811640258, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 44175.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 192000, 'num_env_steps_trained': 192000, 'num_agent_steps_sampled': 192000, 'num_agent_steps_trained': 192000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.77, 'episode_len_mean': 786.69, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 78669, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0], 'episode_lengths': [610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5937245467279402, 'mean_inference_ms': 8.6352914483593, 'mean_action_processing_ms': 0.11673478873109598, 'mean_env_wait_ms': 0.2199159071628002, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2512979507446289, 'StateBufferConnector_ms': 0.0056610107421875, 'ViewRequirementAgentConnector_ms': 0.16153860092163086}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.77}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.77, 'episode_len_mean': 786.69, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 78669, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0], 'episode_lengths': [610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5937245467279402, 'mean_inference_ms': 8.6352914483593, 'mean_action_processing_ms': 0.11673478873109598, 'mean_env_wait_ms': 0.2199159071628002, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2512979507446289, 'StateBufferConnector_ms': 0.0056610107421875, 'ViewRequirementAgentConnector_ms': 0.16153860092163086}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.77}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.77, 'episode_len_mean': 786.69, 'episodes_this_iter': 5, 'episodes_timesteps_total': 78669, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [1.0, 0.0, 4.0, 2.0, 2.0, 0.0, 1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0], 'episode_lengths': [610, 492, 1180, 740, 800, 492, 604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5937245467279402, 'mean_inference_ms': 8.6352914483593, 'mean_action_processing_ms': 0.11673478873109598, 'mean_env_wait_ms': 0.2199159071628002, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2512979507446289, 'StateBufferConnector_ms': 0.0056610107421875, 'ViewRequirementAgentConnector_ms': 0.16153860092163086}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.77, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 192000, 'num_agent_steps_trained': 192000, 'num_env_steps_sampled': 192000, 'num_env_steps_trained': 192000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 27.21987950991615, 'num_env_steps_trained_throughput_per_sec': 27.21987950991615, 'timesteps_total': 192000, 'num_env_steps_sampled_lifetime': 192000, 'num_agent_steps_sampled_lifetime': 192000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 192000, 'timers': {'training_iteration_time_ms': 156214.039, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 156213.941, 'sample_time_ms': 19813.471, 'load_time_ms': 4.291, 'load_throughput': 932103.804, 'learn_time_ms': 136379.213, 'learn_throughput': 29.33, 'synch_weights_time_ms': 16.345}, 'counters': {'num_env_steps_sampled': 192000, 'num_env_steps_trained': 192000, 'num_agent_steps_sampled': 192000, 'num_agent_steps_trained': 192000}, 'done': False, 'episodes_total': 261, 'training_iteration': 48, 'trial_id': 'default', 'date': '2024-05-10_14-22-42', 'timestamp': 1715347362, 'time_this_iter_s': 146.99599766731262, 'time_total_s': 7219.0050275325775, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 7219.0050275325775, 'iterations_since_restore': 48, 'perf': {'cpu_util_percent': 46.20384615384615, 'ram_util_percent': 59.200961538461534}}
	Step: 48
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.872103880377867, 'cur_kl_coeff': 0.12656249999999997, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.009441184372671189, 'policy_loss': -0.0012890410239017138, 'vf_loss': 0.00980927862367162, 'vf_explained_var': -0.2694924029611772, 'kl': 0.007276622564158361, 'entropy': 1.1951453323005348, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 45105.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 196000, 'num_env_steps_trained': 196000, 'num_agent_steps_sampled': 196000, 'num_agent_steps_trained': 196000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.77, 'episode_len_mean': 788.48, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 78848, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0], 'episode_lengths': [604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5964995130907085, 'mean_inference_ms': 8.647651657011512, 'mean_action_processing_ms': 0.1173053288083025, 'mean_env_wait_ms': 0.22096530845388934, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2534008026123047, 'StateBufferConnector_ms': 0.006659984588623047, 'ViewRequirementAgentConnector_ms': 0.1603846549987793}, 'num_episodes': 6, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.77}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.77, 'episode_len_mean': 788.48, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 78848, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0], 'episode_lengths': [604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5964995130907085, 'mean_inference_ms': 8.647651657011512, 'mean_action_processing_ms': 0.1173053288083025, 'mean_env_wait_ms': 0.22096530845388934, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2534008026123047, 'StateBufferConnector_ms': 0.006659984588623047, 'ViewRequirementAgentConnector_ms': 0.1603846549987793}, 'num_episodes': 6, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.77}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.77, 'episode_len_mean': 788.48, 'episodes_this_iter': 6, 'episodes_timesteps_total': 78848, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [1.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0], 'episode_lengths': [604, 995, 609, 492, 493, 1108, 496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5964995130907085, 'mean_inference_ms': 8.647651657011512, 'mean_action_processing_ms': 0.1173053288083025, 'mean_env_wait_ms': 0.22096530845388934, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2534008026123047, 'StateBufferConnector_ms': 0.006659984588623047, 'ViewRequirementAgentConnector_ms': 0.1603846549987793}, 'num_episodes': 6, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.77, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 196000, 'num_agent_steps_trained': 196000, 'num_env_steps_sampled': 196000, 'num_env_steps_trained': 196000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 28.420298196287842, 'num_env_steps_trained_throughput_per_sec': 28.420298196287842, 'timesteps_total': 196000, 'num_env_steps_sampled_lifetime': 196000, 'num_agent_steps_sampled_lifetime': 196000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 196000, 'timers': {'training_iteration_time_ms': 155541.665, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 155541.566, 'sample_time_ms': 19616.65, 'load_time_ms': 4.042, 'load_throughput': 989555.216, 'learn_time_ms': 135904.233, 'learn_throughput': 29.432, 'synch_weights_time_ms': 16.02}, 'counters': {'num_env_steps_sampled': 196000, 'num_env_steps_trained': 196000, 'num_agent_steps_sampled': 196000, 'num_agent_steps_trained': 196000}, 'done': False, 'episodes_total': 267, 'training_iteration': 49, 'trial_id': 'default', 'date': '2024-05-10_14-25-03', 'timestamp': 1715347503, 'time_this_iter_s': 140.78048181533813, 'time_total_s': 7359.785509347916, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 7359.785509347916, 'iterations_since_restore': 49, 'perf': {'cpu_util_percent': 46.768341708542714, 'ram_util_percent': 57.764321608040206}}
	Step: 49
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.445041073730556, 'cur_kl_coeff': 0.12656249999999997, 'cur_lr': 5.0000000000000016e-05, 'total_loss': -0.005982217505093544, 'policy_loss': -0.013654785258795625, 'vf_loss': 0.006083447624170672, 'vf_explained_var': -0.2112362451450799, 'kl': 0.012556014776122315, 'entropy': 1.2235542707545783, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 46035.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 200000, 'num_env_steps_trained': 200000, 'num_agent_steps_sampled': 200000, 'num_agent_steps_trained': 200000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.78, 'episode_len_mean': 790.58, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 79058, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0], 'episode_lengths': [496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5990476099055886, 'mean_inference_ms': 8.658454506030667, 'mean_action_processing_ms': 0.11780334763692023, 'mean_env_wait_ms': 0.22191700934964143, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.254361629486084, 'StateBufferConnector_ms': 0.0056722164154052734, 'ViewRequirementAgentConnector_ms': 0.15845894813537598}, 'num_episodes': 6, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.78}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.78, 'episode_len_mean': 790.58, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 79058, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0], 'episode_lengths': [496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5990476099055886, 'mean_inference_ms': 8.658454506030667, 'mean_action_processing_ms': 0.11780334763692023, 'mean_env_wait_ms': 0.22191700934964143, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.254361629486084, 'StateBufferConnector_ms': 0.0056722164154052734, 'ViewRequirementAgentConnector_ms': 0.15845894813537598}, 'num_episodes': 6, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.78}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.78, 'episode_len_mean': 790.58, 'episodes_this_iter': 6, 'episodes_timesteps_total': 79058, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [0.0, 2.0, 4.0, 1.0, 5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0], 'episode_lengths': [496, 814, 1104, 608, 1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5990476099055886, 'mean_inference_ms': 8.658454506030667, 'mean_action_processing_ms': 0.11780334763692023, 'mean_env_wait_ms': 0.22191700934964143, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.254361629486084, 'StateBufferConnector_ms': 0.0056722164154052734, 'ViewRequirementAgentConnector_ms': 0.15845894813537598}, 'num_episodes': 6, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.78, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 200000, 'num_agent_steps_trained': 200000, 'num_env_steps_sampled': 200000, 'num_env_steps_trained': 200000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 28.533279519504738, 'num_env_steps_trained_throughput_per_sec': 28.533279519504738, 'timesteps_total': 200000, 'num_env_steps_sampled_lifetime': 200000, 'num_agent_steps_sampled_lifetime': 200000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 200000, 'timers': {'training_iteration_time_ms': 154825.646, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 154825.548, 'sample_time_ms': 19468.917, 'load_time_ms': 3.977, 'load_throughput': 1005761.97, 'learn_time_ms': 135336.199, 'learn_throughput': 29.556, 'synch_weights_time_ms': 15.938}, 'counters': {'num_env_steps_sampled': 200000, 'num_env_steps_trained': 200000, 'num_agent_steps_sampled': 200000, 'num_agent_steps_trained': 200000}, 'done': False, 'episodes_total': 273, 'training_iteration': 50, 'trial_id': 'default', 'date': '2024-05-10_14-27-23', 'timestamp': 1715347643, 'time_this_iter_s': 140.23196601867676, 'time_total_s': 7500.017475366592, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 7500.017475366592, 'iterations_since_restore': 50, 'perf': {'cpu_util_percent': 46.36482412060302, 'ram_util_percent': 54.95175879396986}}
	Step: 50
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 2.0745324013854867, 'cur_kl_coeff': 0.12656249999999997, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.009541760619869957, 'policy_loss': -0.0030639120818225928, 'vf_loss': 0.011538794306882967, 'vf_explained_var': 0.1393666455181696, 'kl': 0.008429655125202567, 'entropy': 1.2071003481905946, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 46965.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 204000, 'num_env_steps_trained': 204000, 'num_agent_steps_sampled': 204000, 'num_agent_steps_trained': 204000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.8, 'episode_len_mean': 795.75, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 79575, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0], 'episode_lengths': [1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.600721597403657, 'mean_inference_ms': 8.66515973997572, 'mean_action_processing_ms': 0.1181483954053864, 'mean_env_wait_ms': 0.22256123151076745, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2514195442199707, 'StateBufferConnector_ms': 0.006669759750366211, 'ViewRequirementAgentConnector_ms': 0.16013765335083008}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.8}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.8, 'episode_len_mean': 795.75, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 79575, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0], 'episode_lengths': [1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.600721597403657, 'mean_inference_ms': 8.66515973997572, 'mean_action_processing_ms': 0.1181483954053864, 'mean_env_wait_ms': 0.22256123151076745, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2514195442199707, 'StateBufferConnector_ms': 0.006669759750366211, 'ViewRequirementAgentConnector_ms': 0.16013765335083008}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.8}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.8, 'episode_len_mean': 795.75, 'episodes_this_iter': 4, 'episodes_timesteps_total': 79575, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [5.0, 4.0, 1.0, 4.0, 3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0], 'episode_lengths': [1305, 1184, 601, 1187, 992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.600721597403657, 'mean_inference_ms': 8.66515973997572, 'mean_action_processing_ms': 0.1181483954053864, 'mean_env_wait_ms': 0.22256123151076745, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2514195442199707, 'StateBufferConnector_ms': 0.006669759750366211, 'ViewRequirementAgentConnector_ms': 0.16013765335083008}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.8, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 204000, 'num_agent_steps_trained': 204000, 'num_env_steps_sampled': 204000, 'num_env_steps_trained': 204000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 25.383814039395425, 'num_env_steps_trained_throughput_per_sec': 25.383814039395425, 'timesteps_total': 204000, 'num_env_steps_sampled_lifetime': 204000, 'num_agent_steps_sampled_lifetime': 204000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 204000, 'timers': {'training_iteration_time_ms': 155995.849, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 155995.751, 'sample_time_ms': 19532.276, 'load_time_ms': 4.518, 'load_throughput': 885411.299, 'learn_time_ms': 136442.633, 'learn_throughput': 29.316, 'synch_weights_time_ms': 15.716}, 'counters': {'num_env_steps_sampled': 204000, 'num_env_steps_trained': 204000, 'num_agent_steps_sampled': 204000, 'num_agent_steps_trained': 204000}, 'done': False, 'episodes_total': 277, 'training_iteration': 51, 'trial_id': 'default', 'date': '2024-05-10_14-30-01', 'timestamp': 1715347801, 'time_this_iter_s': 157.62544131278992, 'time_total_s': 7657.642916679382, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 7657.642916679382, 'iterations_since_restore': 51, 'perf': {'cpu_util_percent': 48.3152466367713, 'ram_util_percent': 57.87219730941704}}
Saving weights...
	Step: 51
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.5096854371249036, 'cur_kl_coeff': 0.12656249999999997, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.0040574106718263316, 'policy_loss': -0.005747412745991061, 'vf_loss': 0.0072167043268094744, 'vf_explained_var': -0.12732221971275987, 'kl': 0.0204493487413036, 'entropy': 1.2122339876749182, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 47895.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 208000, 'num_env_steps_trained': 208000, 'num_agent_steps_sampled': 208000, 'num_agent_steps_trained': 208000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.73, 'episode_len_mean': 784.76, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 78476, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0], 'episode_lengths': [992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.6021142570421766, 'mean_inference_ms': 8.670423556281916, 'mean_action_processing_ms': 0.11841264891014078, 'mean_env_wait_ms': 0.22310552739934827, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.25017786026000977, 'StateBufferConnector_ms': 0.006669759750366211, 'ViewRequirementAgentConnector_ms': 0.158217191696167}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.73}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.73, 'episode_len_mean': 784.76, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 78476, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0], 'episode_lengths': [992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.6021142570421766, 'mean_inference_ms': 8.670423556281916, 'mean_action_processing_ms': 0.11841264891014078, 'mean_env_wait_ms': 0.22310552739934827, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.25017786026000977, 'StateBufferConnector_ms': 0.006669759750366211, 'ViewRequirementAgentConnector_ms': 0.158217191696167}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.73}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.73, 'episode_len_mean': 784.76, 'episodes_this_iter': 4, 'episodes_timesteps_total': 78476, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [3.0, 0.0, 2.0, 2.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0], 'episode_lengths': [992, 489, 792, 800, 500, 616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.6021142570421766, 'mean_inference_ms': 8.670423556281916, 'mean_action_processing_ms': 0.11841264891014078, 'mean_env_wait_ms': 0.22310552739934827, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.25017786026000977, 'StateBufferConnector_ms': 0.006669759750366211, 'ViewRequirementAgentConnector_ms': 0.158217191696167}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.73, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 208000, 'num_agent_steps_trained': 208000, 'num_env_steps_sampled': 208000, 'num_env_steps_trained': 208000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 28.454085442551545, 'num_env_steps_trained_throughput_per_sec': 28.454085442551545, 'timesteps_total': 208000, 'num_env_steps_sampled_lifetime': 208000, 'num_agent_steps_sampled_lifetime': 208000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 208000, 'timers': {'training_iteration_time_ms': 152820.937, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 152820.937, 'sample_time_ms': 19340.981, 'load_time_ms': 4.308, 'load_throughput': 928585.36, 'learn_time_ms': 133460.279, 'learn_throughput': 29.971, 'synch_weights_time_ms': 14.66}, 'counters': {'num_env_steps_sampled': 208000, 'num_env_steps_trained': 208000, 'num_agent_steps_sampled': 208000, 'num_agent_steps_trained': 208000}, 'done': False, 'episodes_total': 281, 'training_iteration': 52, 'trial_id': 'default', 'date': '2024-05-10_14-32-21', 'timestamp': 1715347941, 'time_this_iter_s': 140.60635328292847, 'time_total_s': 7798.249269962311, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 7798.249269962311, 'iterations_since_restore': 52, 'perf': {'cpu_util_percent': 46.4321608040201, 'ram_util_percent': 58.28291457286433}}
	Step: 52
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.7408359075425774, 'cur_kl_coeff': 0.18984375000000006, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.00570696327313956, 'policy_loss': -0.005333712965410243, 'vf_loss': 0.009826087093942108, 'vf_explained_var': 0.2954008299817321, 'kl': 0.006397837451575624, 'entropy': 1.1953013599559825, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 48825.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 212000, 'num_env_steps_trained': 212000, 'num_agent_steps_sampled': 212000, 'num_agent_steps_trained': 212000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.79, 'episode_len_mean': 794.93, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 79493, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0], 'episode_lengths': [616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.603307778575245, 'mean_inference_ms': 8.674584655077192, 'mean_action_processing_ms': 0.11863600438131819, 'mean_env_wait_ms': 0.2236011435118217, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.23598027229309082, 'StateBufferConnector_ms': 0.007158517837524414, 'ViewRequirementAgentConnector_ms': 0.154526948928833}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.79}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.79, 'episode_len_mean': 794.93, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 79493, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0], 'episode_lengths': [616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.603307778575245, 'mean_inference_ms': 8.674584655077192, 'mean_action_processing_ms': 0.11863600438131819, 'mean_env_wait_ms': 0.2236011435118217, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.23598027229309082, 'StateBufferConnector_ms': 0.007158517837524414, 'ViewRequirementAgentConnector_ms': 0.154526948928833}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.79}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.79, 'episode_len_mean': 794.93, 'episodes_this_iter': 5, 'episodes_timesteps_total': 79493, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0], 'episode_lengths': [616, 509, 508, 681, 910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.603307778575245, 'mean_inference_ms': 8.674584655077192, 'mean_action_processing_ms': 0.11863600438131819, 'mean_env_wait_ms': 0.2236011435118217, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.23598027229309082, 'StateBufferConnector_ms': 0.007158517837524414, 'ViewRequirementAgentConnector_ms': 0.154526948928833}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.79, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 212000, 'num_agent_steps_trained': 212000, 'num_env_steps_sampled': 212000, 'num_env_steps_trained': 212000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 19.625745444109775, 'num_env_steps_trained_throughput_per_sec': 19.625745444109775, 'timesteps_total': 212000, 'num_env_steps_sampled_lifetime': 212000, 'num_agent_steps_sampled_lifetime': 212000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 212000, 'timers': {'training_iteration_time_ms': 153144.842, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 153144.842, 'sample_time_ms': 18626.304, 'load_time_ms': 4.049, 'load_throughput': 987894.576, 'learn_time_ms': 134498.91, 'learn_throughput': 29.74, 'synch_weights_time_ms': 14.969}, 'counters': {'num_env_steps_sampled': 212000, 'num_env_steps_trained': 212000, 'num_agent_steps_sampled': 212000, 'num_agent_steps_trained': 212000}, 'done': False, 'episodes_total': 286, 'training_iteration': 53, 'trial_id': 'default', 'date': '2024-05-10_14-35-45', 'timestamp': 1715348145, 'time_this_iter_s': 203.84510779380798, 'time_total_s': 8002.094377756119, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 8002.094377756119, 'iterations_since_restore': 53, 'perf': {'cpu_util_percent': 69.48076923076923, 'ram_util_percent': 82.56643356643356}}
	Step: 53
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.5560760800236015, 'cur_kl_coeff': 0.18984375000000006, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.008726536423989361, 'policy_loss': -0.0015429792425004384, 'vf_loss': 0.008267961808740691, 'vf_explained_var': 0.1454661988442944, 'kl': 0.010543184379271237, 'entropy': 1.1740892542305814, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 49755.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 216000, 'num_env_steps_trained': 216000, 'num_agent_steps_sampled': 216000, 'num_agent_steps_trained': 216000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.85, 'episode_len_mean': 804.82, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 80482, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0], 'episode_lengths': [910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.6043809385701121, 'mean_inference_ms': 8.678869429478505, 'mean_action_processing_ms': 0.11894716924100969, 'mean_env_wait_ms': 0.2240485113907893, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2381582260131836, 'StateBufferConnector_ms': 0.007158517837524414, 'ViewRequirementAgentConnector_ms': 0.15490031242370605}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.85}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.85, 'episode_len_mean': 804.82, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 80482, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0], 'episode_lengths': [910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.6043809385701121, 'mean_inference_ms': 8.678869429478505, 'mean_action_processing_ms': 0.11894716924100969, 'mean_env_wait_ms': 0.2240485113907893, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2381582260131836, 'StateBufferConnector_ms': 0.007158517837524414, 'ViewRequirementAgentConnector_ms': 0.15490031242370605}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.85}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.85, 'episode_len_mean': 804.82, 'episodes_this_iter': 4, 'episodes_timesteps_total': 80482, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [3.0, 1.0, 0.0, 2.0, 2.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0], 'episode_lengths': [910, 694, 501, 797, 803, 795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.6043809385701121, 'mean_inference_ms': 8.678869429478505, 'mean_action_processing_ms': 0.11894716924100969, 'mean_env_wait_ms': 0.2240485113907893, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2381582260131836, 'StateBufferConnector_ms': 0.007158517837524414, 'ViewRequirementAgentConnector_ms': 0.15490031242370605}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.85, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 216000, 'num_agent_steps_trained': 216000, 'num_env_steps_sampled': 216000, 'num_env_steps_trained': 216000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 21.732204531626905, 'num_env_steps_trained_throughput_per_sec': 21.732204531626905, 'timesteps_total': 216000, 'num_env_steps_sampled_lifetime': 216000, 'num_agent_steps_sampled_lifetime': 216000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 216000, 'timers': {'training_iteration_time_ms': 157052.545, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 157052.545, 'sample_time_ms': 19198.237, 'load_time_ms': 3.758, 'load_throughput': 1064287.545, 'learn_time_ms': 137836.385, 'learn_throughput': 29.02, 'synch_weights_time_ms': 13.556}, 'counters': {'num_env_steps_sampled': 216000, 'num_env_steps_trained': 216000, 'num_agent_steps_sampled': 216000, 'num_agent_steps_trained': 216000}, 'done': False, 'episodes_total': 290, 'training_iteration': 54, 'trial_id': 'default', 'date': '2024-05-10_14-38-49', 'timestamp': 1715348329, 'time_this_iter_s': 184.09324312210083, 'time_total_s': 8186.18762087822, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 8186.18762087822, 'iterations_since_restore': 54, 'perf': {'cpu_util_percent': 64.211583011583, 'ram_util_percent': 68.56409266409266}}
	Step: 54
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.6858585120849712, 'cur_kl_coeff': 0.18984375000000006, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.00823251337854452, 'policy_loss': -0.0024688424883029794, 'vf_loss': 0.008898588728600292, 'vf_explained_var': 0.2611133070402248, 'kl': 0.009496069710401303, 'entropy': 1.1440364322354717, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 50685.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 220000, 'num_env_steps_trained': 220000, 'num_agent_steps_sampled': 220000, 'num_agent_steps_trained': 220000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.91, 'episode_len_mean': 815.53, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 81553, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0], 'episode_lengths': [795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.6052160563901365, 'mean_inference_ms': 8.681910274143574, 'mean_action_processing_ms': 0.11911679210116637, 'mean_env_wait_ms': 0.2243992108796026, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2362518310546875, 'StateBufferConnector_ms': 0.008157968521118164, 'ViewRequirementAgentConnector_ms': 0.1510944366455078}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.91}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.91, 'episode_len_mean': 815.53, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 81553, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0], 'episode_lengths': [795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.6052160563901365, 'mean_inference_ms': 8.681910274143574, 'mean_action_processing_ms': 0.11911679210116637, 'mean_env_wait_ms': 0.2243992108796026, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2362518310546875, 'StateBufferConnector_ms': 0.008157968521118164, 'ViewRequirementAgentConnector_ms': 0.1510944366455078}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.91}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.91, 'episode_len_mean': 815.53, 'episodes_this_iter': 5, 'episodes_timesteps_total': 81553, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0], 'episode_lengths': [795, 501, 987, 493, 987, 496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.6052160563901365, 'mean_inference_ms': 8.681910274143574, 'mean_action_processing_ms': 0.11911679210116637, 'mean_env_wait_ms': 0.2243992108796026, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2362518310546875, 'StateBufferConnector_ms': 0.008157968521118164, 'ViewRequirementAgentConnector_ms': 0.1510944366455078}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.91, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 220000, 'num_agent_steps_trained': 220000, 'num_env_steps_sampled': 220000, 'num_env_steps_trained': 220000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 27.60721950974402, 'num_env_steps_trained_throughput_per_sec': 27.60721950974402, 'timesteps_total': 220000, 'num_env_steps_sampled_lifetime': 220000, 'num_agent_steps_sampled_lifetime': 220000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 220000, 'timers': {'training_iteration_time_ms': 156763.081, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 156763.081, 'sample_time_ms': 19124.791, 'load_time_ms': 3.856, 'load_throughput': 1037308.239, 'learn_time_ms': 137620.105, 'learn_throughput': 29.066, 'synch_weights_time_ms': 13.819}, 'counters': {'num_env_steps_sampled': 220000, 'num_env_steps_trained': 220000, 'num_agent_steps_sampled': 220000, 'num_agent_steps_trained': 220000}, 'done': False, 'episodes_total': 295, 'training_iteration': 55, 'trial_id': 'default', 'date': '2024-05-10_14-41-14', 'timestamp': 1715348474, 'time_this_iter_s': 144.9186930656433, 'time_total_s': 8331.106313943863, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 8331.106313943863, 'iterations_since_restore': 55, 'perf': {'cpu_util_percent': 47.11853658536585, 'ram_util_percent': 55.3370731707317}}
	Step: 55
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.2845372499797933, 'cur_kl_coeff': 0.18984375000000006, 'cur_lr': 5.0000000000000016e-05, 'total_loss': -0.0012706004884294284, 'policy_loss': -0.0071527047182924006, 'vf_loss': 0.00530586024722515, 'vf_explained_var': -0.37015909328255603, 'kl': 0.003035354731930058, 'entropy': 1.1404275668564663, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 51615.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 224000, 'num_env_steps_trained': 224000, 'num_agent_steps_sampled': 224000, 'num_agent_steps_trained': 224000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.87, 'episode_len_mean': 809.79, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 80979, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0], 'episode_lengths': [496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.6055767164584971, 'mean_inference_ms': 8.682791797865777, 'mean_action_processing_ms': 0.11925579379859774, 'mean_env_wait_ms': 0.22462109424654902, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.236785888671875, 'StateBufferConnector_ms': 0.008157968521118164, 'ViewRequirementAgentConnector_ms': 0.14710140228271484}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.87}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.87, 'episode_len_mean': 809.79, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 80979, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0], 'episode_lengths': [496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.6055767164584971, 'mean_inference_ms': 8.682791797865777, 'mean_action_processing_ms': 0.11925579379859774, 'mean_env_wait_ms': 0.22462109424654902, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.236785888671875, 'StateBufferConnector_ms': 0.008157968521118164, 'ViewRequirementAgentConnector_ms': 0.14710140228271484}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.87}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.87, 'episode_len_mean': 809.79, 'episodes_this_iter': 5, 'episodes_timesteps_total': 80979, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 0.0, 1.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0], 'episode_lengths': [496, 497, 503, 615, 997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.6055767164584971, 'mean_inference_ms': 8.682791797865777, 'mean_action_processing_ms': 0.11925579379859774, 'mean_env_wait_ms': 0.22462109424654902, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.236785888671875, 'StateBufferConnector_ms': 0.008157968521118164, 'ViewRequirementAgentConnector_ms': 0.14710140228271484}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.87, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 224000, 'num_agent_steps_trained': 224000, 'num_env_steps_sampled': 224000, 'num_env_steps_trained': 224000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 27.66799222684058, 'num_env_steps_trained_throughput_per_sec': 27.66799222684058, 'timesteps_total': 224000, 'num_env_steps_sampled_lifetime': 224000, 'num_agent_steps_sampled_lifetime': 224000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 224000, 'timers': {'training_iteration_time_ms': 155961.507, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 155961.507, 'sample_time_ms': 19469.679, 'load_time_ms': 3.705, 'load_throughput': 1079760.843, 'learn_time_ms': 136472.715, 'learn_throughput': 29.31, 'synch_weights_time_ms': 14.799}, 'counters': {'num_env_steps_sampled': 224000, 'num_env_steps_trained': 224000, 'num_agent_steps_sampled': 224000, 'num_agent_steps_trained': 224000}, 'done': False, 'episodes_total': 300, 'training_iteration': 56, 'trial_id': 'default', 'date': '2024-05-10_14-43-39', 'timestamp': 1715348619, 'time_this_iter_s': 144.60492157936096, 'time_total_s': 8475.711235523224, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 8475.711235523224, 'iterations_since_restore': 56, 'perf': {'cpu_util_percent': 47.53365853658537, 'ram_util_percent': 53.42097560975609}}
	Step: 56
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.490216038336036, 'cur_kl_coeff': 0.09492187500000003, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.0007588820211509223, 'policy_loss': -0.008893385088892394, 'vf_loss': 0.007453489212459454, 'vf_explained_var': 0.310911903906894, 'kl': 0.023164095434236275, 'entropy': 1.0945850786342415, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 52545.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 228000, 'num_env_steps_trained': 228000, 'num_agent_steps_sampled': 228000, 'num_agent_steps_trained': 228000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.97, 'episode_len_mean': 827.91, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 82791, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0], 'episode_lengths': [997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.6057515244483692, 'mean_inference_ms': 8.683016675154892, 'mean_action_processing_ms': 0.11925973468286888, 'mean_env_wait_ms': 0.22472908902502653, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.23237061500549316, 'StateBufferConnector_ms': 0.007982254028320312, 'ViewRequirementAgentConnector_ms': 0.14298534393310547}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.97}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.97, 'episode_len_mean': 827.91, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 82791, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0], 'episode_lengths': [997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.6057515244483692, 'mean_inference_ms': 8.683016675154892, 'mean_action_processing_ms': 0.11925973468286888, 'mean_env_wait_ms': 0.22472908902502653, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.23237061500549316, 'StateBufferConnector_ms': 0.007982254028320312, 'ViewRequirementAgentConnector_ms': 0.14298534393310547}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.97}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.97, 'episode_len_mean': 827.91, 'episodes_this_iter': 4, 'episodes_timesteps_total': 82791, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0], 'episode_lengths': [997, 820, 499, 796, 512, 791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.6057515244483692, 'mean_inference_ms': 8.683016675154892, 'mean_action_processing_ms': 0.11925973468286888, 'mean_env_wait_ms': 0.22472908902502653, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.23237061500549316, 'StateBufferConnector_ms': 0.007982254028320312, 'ViewRequirementAgentConnector_ms': 0.14298534393310547}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.97, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 228000, 'num_agent_steps_trained': 228000, 'num_env_steps_sampled': 228000, 'num_env_steps_trained': 228000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 27.704426522327864, 'num_env_steps_trained_throughput_per_sec': 27.704426522327864, 'timesteps_total': 228000, 'num_env_steps_sampled_lifetime': 228000, 'num_agent_steps_sampled_lifetime': 228000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 228000, 'timers': {'training_iteration_time_ms': 154775.6, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 154775.6, 'sample_time_ms': 19117.915, 'load_time_ms': 3.611, 'load_throughput': 1107684.832, 'learn_time_ms': 135638.609, 'learn_throughput': 29.49, 'synch_weights_time_ms': 14.772}, 'counters': {'num_env_steps_sampled': 228000, 'num_env_steps_trained': 228000, 'num_agent_steps_sampled': 228000, 'num_agent_steps_trained': 228000}, 'done': False, 'episodes_total': 304, 'training_iteration': 57, 'trial_id': 'default', 'date': '2024-05-10_14-46-03', 'timestamp': 1715348763, 'time_this_iter_s': 144.40625929832458, 'time_total_s': 8620.117494821548, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 8620.117494821548, 'iterations_since_restore': 57, 'perf': {'cpu_util_percent': 46.97512195121952, 'ram_util_percent': 54.31707317073171}}
	Step: 57
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.700497177291301, 'cur_kl_coeff': 0.14238281249999996, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.0003724041444960461, 'policy_loss': -0.009808732597257501, 'vf_loss': 0.00820646741388676, 'vf_explained_var': 0.03012758448559751, 'kl': 0.013868724766404389, 'entropy': 1.0257453090401105, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 53475.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 232000, 'num_env_steps_trained': 232000, 'num_agent_steps_sampled': 232000, 'num_agent_steps_trained': 232000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.03, 'episode_len_mean': 840.09, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 84009, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0], 'episode_lengths': [791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.6056491490062342, 'mean_inference_ms': 8.681859140633414, 'mean_action_processing_ms': 0.11931785202560664, 'mean_env_wait_ms': 0.22477492167795937, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.22427058219909668, 'StateBufferConnector_ms': 0.007982254028320312, 'ViewRequirementAgentConnector_ms': 0.14195871353149414}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.03}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.03, 'episode_len_mean': 840.09, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 84009, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0], 'episode_lengths': [791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.6056491490062342, 'mean_inference_ms': 8.681859140633414, 'mean_action_processing_ms': 0.11931785202560664, 'mean_env_wait_ms': 0.22477492167795937, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.22427058219909668, 'StateBufferConnector_ms': 0.007982254028320312, 'ViewRequirementAgentConnector_ms': 0.14195871353149414}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.03}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.03, 'episode_len_mean': 840.09, 'episodes_this_iter': 5, 'episodes_timesteps_total': 84009, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [2.0, 3.0, 3.0, 0.0, 3.0, 3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0], 'episode_lengths': [791, 996, 995, 509, 992, 999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.6056491490062342, 'mean_inference_ms': 8.681859140633414, 'mean_action_processing_ms': 0.11931785202560664, 'mean_env_wait_ms': 0.22477492167795937, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.22427058219909668, 'StateBufferConnector_ms': 0.007982254028320312, 'ViewRequirementAgentConnector_ms': 0.14195871353149414}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.03, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 232000, 'num_agent_steps_trained': 232000, 'num_env_steps_sampled': 232000, 'num_env_steps_trained': 232000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 27.440307080838615, 'num_env_steps_trained_throughput_per_sec': 27.440307080838615, 'timesteps_total': 232000, 'num_env_steps_sampled_lifetime': 232000, 'num_agent_steps_sampled_lifetime': 232000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 232000, 'timers': {'training_iteration_time_ms': 154657.554, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 154657.554, 'sample_time_ms': 18846.257, 'load_time_ms': 3.671, 'load_throughput': 1089769.279, 'learn_time_ms': 135792.322, 'learn_throughput': 29.457, 'synch_weights_time_ms': 14.712}, 'counters': {'num_env_steps_sampled': 232000, 'num_env_steps_trained': 232000, 'num_agent_steps_sampled': 232000, 'num_agent_steps_trained': 232000}, 'done': False, 'episodes_total': 309, 'training_iteration': 58, 'trial_id': 'default', 'date': '2024-05-10_14-48-29', 'timestamp': 1715348909, 'time_this_iter_s': 145.79996848106384, 'time_total_s': 8765.917463302612, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 8765.917463302612, 'iterations_since_restore': 58, 'perf': {'cpu_util_percent': 46.30631067961164, 'ram_util_percent': 55.122330097087385}}
	Step: 58
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.8588014008377187, 'cur_kl_coeff': 0.14238281249999996, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.007224089362388176, 'policy_loss': -0.0037019970556420663, 'vf_loss': 0.009662124852371973, 'vf_explained_var': -0.014809347801311042, 'kl': 0.0088771942176322, 'entropy': 1.0152877267329923, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 54405.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 236000, 'num_env_steps_trained': 236000, 'num_agent_steps_sampled': 236000, 'num_agent_steps_trained': 236000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.01, 'episode_len_mean': 838.3, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 83830, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0], 'episode_lengths': [999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.6055527221984438, 'mean_inference_ms': 8.68082173767729, 'mean_action_processing_ms': 0.11932032500425485, 'mean_env_wait_ms': 0.22480919424280657, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.23130464553833008, 'StateBufferConnector_ms': 0.00697636604309082, 'ViewRequirementAgentConnector_ms': 0.14397644996643066}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.01}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.01, 'episode_len_mean': 838.3, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 83830, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0], 'episode_lengths': [999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.6055527221984438, 'mean_inference_ms': 8.68082173767729, 'mean_action_processing_ms': 0.11932032500425485, 'mean_env_wait_ms': 0.22480919424280657, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.23130464553833008, 'StateBufferConnector_ms': 0.00697636604309082, 'ViewRequirementAgentConnector_ms': 0.14397644996643066}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.01}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.01, 'episode_len_mean': 838.3, 'episodes_this_iter': 5, 'episodes_timesteps_total': 83830, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [3.0, 0.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0], 'episode_lengths': [999, 567, 819, 1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.6055527221984438, 'mean_inference_ms': 8.68082173767729, 'mean_action_processing_ms': 0.11932032500425485, 'mean_env_wait_ms': 0.22480919424280657, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.23130464553833008, 'StateBufferConnector_ms': 0.00697636604309082, 'ViewRequirementAgentConnector_ms': 0.14397644996643066}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.01, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 236000, 'num_agent_steps_trained': 236000, 'num_env_steps_sampled': 236000, 'num_env_steps_trained': 236000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 27.268552650799787, 'num_env_steps_trained_throughput_per_sec': 27.268552650799787, 'timesteps_total': 236000, 'num_env_steps_sampled_lifetime': 236000, 'num_agent_steps_sampled_lifetime': 236000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 236000, 'timers': {'training_iteration_time_ms': 155252.019, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 155252.019, 'sample_time_ms': 18853.52, 'load_time_ms': 3.67, 'load_throughput': 1090052.498, 'learn_time_ms': 136379.524, 'learn_throughput': 29.33, 'synch_weights_time_ms': 14.712}, 'counters': {'num_env_steps_sampled': 236000, 'num_env_steps_trained': 236000, 'num_agent_steps_sampled': 236000, 'num_agent_steps_trained': 236000}, 'done': False, 'episodes_total': 314, 'training_iteration': 59, 'trial_id': 'default', 'date': '2024-05-10_14-50-56', 'timestamp': 1715349056, 'time_this_iter_s': 146.72142696380615, 'time_total_s': 8912.638890266418, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 8912.638890266418, 'iterations_since_restore': 59, 'perf': {'cpu_util_percent': 44.150000000000006, 'ram_util_percent': 56.03942307692308}}
	Step: 59
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.4255445356010108, 'cur_kl_coeff': 0.14238281249999996, 'cur_lr': 5.0000000000000016e-05, 'total_loss': -0.0027295581896298673, 'policy_loss': -0.0119676027707355, 'vf_loss': 0.008250388069083334, 'vf_explained_var': 0.4033980179217554, 'kl': 0.00693662514265891, 'entropy': 1.0555989031509687, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 55335.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 240000, 'num_env_steps_trained': 240000, 'num_agent_steps_sampled': 240000, 'num_agent_steps_trained': 240000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.08, 'episode_len_mean': 851.25, 'episode_media': {}, 'episodes_this_iter': 3, 'episodes_timesteps_total': 85125, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0], 'episode_lengths': [1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.6053955485961324, 'mean_inference_ms': 8.679758424171263, 'mean_action_processing_ms': 0.11934034128646719, 'mean_env_wait_ms': 0.2248014368671087, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.23206019401550293, 'StateBufferConnector_ms': 0.00697636604309082, 'ViewRequirementAgentConnector_ms': 0.14298605918884277}, 'num_episodes': 3, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.08}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.08, 'episode_len_mean': 851.25, 'episode_media': {}, 'episodes_this_iter': 3, 'episodes_timesteps_total': 85125, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0], 'episode_lengths': [1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.6053955485961324, 'mean_inference_ms': 8.679758424171263, 'mean_action_processing_ms': 0.11934034128646719, 'mean_env_wait_ms': 0.2248014368671087, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.23206019401550293, 'StateBufferConnector_ms': 0.00697636604309082, 'ViewRequirementAgentConnector_ms': 0.14298605918884277}, 'num_episodes': 3, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.08}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.08, 'episode_len_mean': 851.25, 'episodes_this_iter': 3, 'episodes_timesteps_total': 85125, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [3.0, 2.0, 2.0, 2.0, 2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0], 'episode_lengths': [1020, 821, 813, 829, 898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.6053955485961324, 'mean_inference_ms': 8.679758424171263, 'mean_action_processing_ms': 0.11934034128646719, 'mean_env_wait_ms': 0.2248014368671087, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.23206019401550293, 'StateBufferConnector_ms': 0.00697636604309082, 'ViewRequirementAgentConnector_ms': 0.14298605918884277}, 'num_episodes': 3, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.08, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 240000, 'num_agent_steps_trained': 240000, 'num_env_steps_sampled': 240000, 'num_env_steps_trained': 240000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 27.52456986986258, 'num_env_steps_trained_throughput_per_sec': 27.52456986986258, 'timesteps_total': 240000, 'num_env_steps_sampled_lifetime': 240000, 'num_agent_steps_sampled_lifetime': 240000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 240000, 'timers': {'training_iteration_time_ms': 155765.871, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 155765.771, 'sample_time_ms': 18845.28, 'load_time_ms': 3.679, 'load_throughput': 1087339.659, 'learn_time_ms': 136901.409, 'learn_throughput': 29.218, 'synch_weights_time_ms': 14.81}, 'counters': {'num_env_steps_sampled': 240000, 'num_env_steps_trained': 240000, 'num_agent_steps_sampled': 240000, 'num_agent_steps_trained': 240000}, 'done': False, 'episodes_total': 317, 'training_iteration': 60, 'trial_id': 'default', 'date': '2024-05-10_14-53-21', 'timestamp': 1715349201, 'time_this_iter_s': 145.35328912734985, 'time_total_s': 9057.992179393768, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 9057.992179393768, 'iterations_since_restore': 60, 'perf': {'cpu_util_percent': 47.072815533980574, 'ram_util_percent': 56.084466019417476}}
	Step: 60
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.54114158566921, 'cur_kl_coeff': 0.14238281249999996, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.009346963625441315, 'policy_loss': 0.000624097587280376, 'vf_loss': 0.007223059426459875, 'vf_explained_var': 0.03729605572198027, 'kl': 0.010533608279512413, 'entropy': 1.0637421736794133, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 56265.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 244000, 'num_env_steps_trained': 244000, 'num_agent_steps_sampled': 244000, 'num_agent_steps_trained': 244000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.07, 'episode_len_mean': 851.42, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 85142, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0], 'episode_lengths': [898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.6050902941273425, 'mean_inference_ms': 8.678035208183935, 'mean_action_processing_ms': 0.11932677430992591, 'mean_env_wait_ms': 0.22475968763260673, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2282414436340332, 'StateBufferConnector_ms': 0.00697636604309082, 'ViewRequirementAgentConnector_ms': 0.1427910327911377}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.07}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.07, 'episode_len_mean': 851.42, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 85142, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0], 'episode_lengths': [898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.6050902941273425, 'mean_inference_ms': 8.678035208183935, 'mean_action_processing_ms': 0.11932677430992591, 'mean_env_wait_ms': 0.22475968763260673, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2282414436340332, 'StateBufferConnector_ms': 0.00697636604309082, 'ViewRequirementAgentConnector_ms': 0.1427910327911377}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.07}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.07, 'episode_len_mean': 851.42, 'episodes_this_iter': 4, 'episodes_timesteps_total': 85142, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [2.0, 0.0, 2.0, 0.0, 3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0], 'episode_lengths': [898, 541, 897, 516, 1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.6050902941273425, 'mean_inference_ms': 8.678035208183935, 'mean_action_processing_ms': 0.11932677430992591, 'mean_env_wait_ms': 0.22475968763260673, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2282414436340332, 'StateBufferConnector_ms': 0.00697636604309082, 'ViewRequirementAgentConnector_ms': 0.1427910327911377}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.07, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 244000, 'num_agent_steps_trained': 244000, 'num_env_steps_sampled': 244000, 'num_env_steps_trained': 244000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 27.437407925005093, 'num_env_steps_trained_throughput_per_sec': 27.437407925005093, 'timesteps_total': 244000, 'num_env_steps_sampled_lifetime': 244000, 'num_agent_steps_sampled_lifetime': 244000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 244000, 'timers': {'training_iteration_time_ms': 154586.435, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 154586.334, 'sample_time_ms': 18604.573, 'load_time_ms': 3.232, 'load_throughput': 1237768.99, 'learn_time_ms': 135963.219, 'learn_throughput': 29.42, 'synch_weights_time_ms': 14.81}, 'counters': {'num_env_steps_sampled': 244000, 'num_env_steps_trained': 244000, 'num_agent_steps_sampled': 244000, 'num_agent_steps_trained': 244000}, 'done': False, 'episodes_total': 321, 'training_iteration': 61, 'trial_id': 'default', 'date': '2024-05-10_14-55-47', 'timestamp': 1715349347, 'time_this_iter_s': 145.83291220664978, 'time_total_s': 9203.825091600418, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 9203.825091600418, 'iterations_since_restore': 61, 'perf': {'cpu_util_percent': 48.03398058252427, 'ram_util_percent': 54.741747572815534}}
Saving weights...
	Step: 61
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 2.9163510130618207, 'cur_kl_coeff': 0.14238281249999996, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.0405252763290479, 'policy_loss': 0.01588891477934936, 'vf_loss': 0.023603280256715133, 'vf_explained_var': 0.05299191942778967, 'kl': 0.007255631206589377, 'entropy': 1.0775378472702477, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 57195.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 248000, 'num_env_steps_trained': 248000, 'num_agent_steps_sampled': 248000, 'num_agent_steps_trained': 248000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.14, 'episode_len_mean': 862.95, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 86295, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0], 'episode_lengths': [1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.6046825505493733, 'mean_inference_ms': 8.676065387365714, 'mean_action_processing_ms': 0.11925696607845326, 'mean_env_wait_ms': 0.22466223053814224, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.22371602058410645, 'StateBufferConnector_ms': 0.00747990608215332, 'ViewRequirementAgentConnector_ms': 0.13751840591430664}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.14}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.14, 'episode_len_mean': 862.95, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 86295, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0], 'episode_lengths': [1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.6046825505493733, 'mean_inference_ms': 8.676065387365714, 'mean_action_processing_ms': 0.11925696607845326, 'mean_env_wait_ms': 0.22466223053814224, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.22371602058410645, 'StateBufferConnector_ms': 0.00747990608215332, 'ViewRequirementAgentConnector_ms': 0.13751840591430664}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.14}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.14, 'episode_len_mean': 862.95, 'episodes_this_iter': 4, 'episodes_timesteps_total': 86295, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [3.0, 3.0, 0.0, 2.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0], 'episode_lengths': [1012, 993, 537, 813, 1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.6046825505493733, 'mean_inference_ms': 8.676065387365714, 'mean_action_processing_ms': 0.11925696607845326, 'mean_env_wait_ms': 0.22466223053814224, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.22371602058410645, 'StateBufferConnector_ms': 0.00747990608215332, 'ViewRequirementAgentConnector_ms': 0.13751840591430664}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.14, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 248000, 'num_agent_steps_trained': 248000, 'num_env_steps_sampled': 248000, 'num_env_steps_trained': 248000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 27.559634008369983, 'num_env_steps_trained_throughput_per_sec': 27.559634008369983, 'timesteps_total': 248000, 'num_env_steps_sampled_lifetime': 248000, 'num_agent_steps_sampled_lifetime': 248000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 248000, 'timers': {'training_iteration_time_ms': 155042.68, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 155042.58, 'sample_time_ms': 18602.968, 'load_time_ms': 3.338, 'load_throughput': 1198338.333, 'learn_time_ms': 136421.017, 'learn_throughput': 29.321, 'synch_weights_time_ms': 14.756}, 'counters': {'num_env_steps_sampled': 248000, 'num_env_steps_trained': 248000, 'num_agent_steps_sampled': 248000, 'num_agent_steps_trained': 248000}, 'done': False, 'episodes_total': 325, 'training_iteration': 62, 'trial_id': 'default', 'date': '2024-05-10_14-58-12', 'timestamp': 1715349492, 'time_this_iter_s': 145.1652228832245, 'time_total_s': 9348.990314483643, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 9348.990314483643, 'iterations_since_restore': 62, 'perf': {'cpu_util_percent': 48.56585365853658, 'ram_util_percent': 53.71463414634146}}
	Step: 62
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.7436457231480589, 'cur_kl_coeff': 0.14238281249999996, 'cur_lr': 5.0000000000000016e-05, 'total_loss': -0.0009673974667024869, 'policy_loss': -0.011330268136475996, 'vf_loss': 0.009551500033972765, 'vf_explained_var': 0.22903432320523007, 'kl': 0.005698518305121632, 'entropy': 1.05953986337108, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 58125.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 252000, 'num_env_steps_trained': 252000, 'num_agent_steps_sampled': 252000, 'num_agent_steps_trained': 252000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.17, 'episode_len_mean': 870.14, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 87014, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0], 'episode_lengths': [1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.6041909961603292, 'mean_inference_ms': 8.673660325311356, 'mean_action_processing_ms': 0.11919145670050552, 'mean_env_wait_ms': 0.2245362815745804, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.22593474388122559, 'StateBufferConnector_ms': 0.006480693817138672, 'ViewRequirementAgentConnector_ms': 0.13460373878479004}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.17}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.17, 'episode_len_mean': 870.14, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 87014, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0], 'episode_lengths': [1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.6041909961603292, 'mean_inference_ms': 8.673660325311356, 'mean_action_processing_ms': 0.11919145670050552, 'mean_env_wait_ms': 0.2245362815745804, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.22593474388122559, 'StateBufferConnector_ms': 0.006480693817138672, 'ViewRequirementAgentConnector_ms': 0.13460373878479004}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.17}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.17, 'episode_len_mean': 870.14, 'episodes_this_iter': 4, 'episodes_timesteps_total': 87014, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0], 'episode_lengths': [1196, 544, 1196, 532, 505, 797, 517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.6041909961603292, 'mean_inference_ms': 8.673660325311356, 'mean_action_processing_ms': 0.11919145670050552, 'mean_env_wait_ms': 0.2245362815745804, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.22593474388122559, 'StateBufferConnector_ms': 0.006480693817138672, 'ViewRequirementAgentConnector_ms': 0.13460373878479004}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.17, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 252000, 'num_agent_steps_trained': 252000, 'num_env_steps_sampled': 252000, 'num_env_steps_trained': 252000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 27.319644164628365, 'num_env_steps_trained_throughput_per_sec': 27.319644164628365, 'timesteps_total': 252000, 'num_env_steps_sampled_lifetime': 252000, 'num_agent_steps_sampled_lifetime': 252000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 252000, 'timers': {'training_iteration_time_ms': 149302.768, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 149302.668, 'sample_time_ms': 18587.785, 'load_time_ms': 3.744, 'load_throughput': 1068238.26, 'learn_time_ms': 130696.738, 'learn_throughput': 30.605, 'synch_weights_time_ms': 13.9}, 'counters': {'num_env_steps_sampled': 252000, 'num_env_steps_trained': 252000, 'num_agent_steps_sampled': 252000, 'num_agent_steps_trained': 252000}, 'done': False, 'episodes_total': 329, 'training_iteration': 63, 'trial_id': 'default', 'date': '2024-05-10_15-00-39', 'timestamp': 1715349639, 'time_this_iter_s': 146.4446861743927, 'time_total_s': 9495.435000658035, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 9495.435000658035, 'iterations_since_restore': 63, 'perf': {'cpu_util_percent': 49.27403846153846, 'ram_util_percent': 54.81634615384615}}
	Step: 63
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.4014783871430223, 'cur_kl_coeff': 0.14238281249999996, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.0025640459418276784, 'policy_loss': -0.006394511595448499, 'vf_loss': 0.005244791843823248, 'vf_explained_var': -0.24639864371668907, 'kl': 0.02608295516253558, 'entropy': 1.184678880501819, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 59055.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 256000, 'num_env_steps_trained': 256000, 'num_agent_steps_sampled': 256000, 'num_agent_steps_trained': 256000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.17, 'episode_len_mean': 871.17, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 87117, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0], 'episode_lengths': [517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.603229963736641, 'mean_inference_ms': 8.669033186101544, 'mean_action_processing_ms': 0.11903990171833952, 'mean_env_wait_ms': 0.2242399529523503, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.21668720245361328, 'StateBufferConnector_ms': 0.006480693817138672, 'ViewRequirementAgentConnector_ms': 0.12644195556640625}, 'num_episodes': 6, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.17}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.17, 'episode_len_mean': 871.17, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 87117, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0], 'episode_lengths': [517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.603229963736641, 'mean_inference_ms': 8.669033186101544, 'mean_action_processing_ms': 0.11903990171833952, 'mean_env_wait_ms': 0.2242399529523503, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.21668720245361328, 'StateBufferConnector_ms': 0.006480693817138672, 'ViewRequirementAgentConnector_ms': 0.12644195556640625}, 'num_episodes': 6, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.17}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.17, 'episode_len_mean': 871.17, 'episodes_this_iter': 6, 'episodes_timesteps_total': 87117, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0], 'episode_lengths': [517, 813, 801, 531, 812, 797, 1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.603229963736641, 'mean_inference_ms': 8.669033186101544, 'mean_action_processing_ms': 0.11903990171833952, 'mean_env_wait_ms': 0.2242399529523503, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.21668720245361328, 'StateBufferConnector_ms': 0.006480693817138672, 'ViewRequirementAgentConnector_ms': 0.12644195556640625}, 'num_episodes': 6, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.17, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 256000, 'num_agent_steps_trained': 256000, 'num_env_steps_sampled': 256000, 'num_env_steps_trained': 256000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 26.172259880789316, 'num_env_steps_trained_throughput_per_sec': 26.172259880789316, 'timesteps_total': 256000, 'num_env_steps_sampled_lifetime': 256000, 'num_agent_steps_sampled_lifetime': 256000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 256000, 'timers': {'training_iteration_time_ms': 146180.261, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 146180.161, 'sample_time_ms': 17922.262, 'load_time_ms': 3.76, 'load_throughput': 1063740.957, 'learn_time_ms': 128239.443, 'learn_throughput': 31.192, 'synch_weights_time_ms': 14.094}, 'counters': {'num_env_steps_sampled': 256000, 'num_env_steps_trained': 256000, 'num_agent_steps_sampled': 256000, 'num_agent_steps_trained': 256000}, 'done': False, 'episodes_total': 335, 'training_iteration': 64, 'trial_id': 'default', 'date': '2024-05-10_15-03-12', 'timestamp': 1715349792, 'time_this_iter_s': 152.86257910728455, 'time_total_s': 9648.29757976532, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 9648.29757976532, 'iterations_since_restore': 64, 'perf': {'cpu_util_percent': 48.6912037037037, 'ram_util_percent': 56.048611111111114}}
	Step: 64
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.3343323833359184, 'cur_kl_coeff': 0.21357421874999993, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.002164674574329007, 'policy_loss': -0.005292987402889036, 'vf_loss': 0.006121631710719998, 'vf_explained_var': -0.2539889589432747, 'kl': 0.0062555716716089, 'entropy': 1.1279622006800867, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 59985.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 260000, 'num_env_steps_trained': 260000, 'num_agent_steps_sampled': 260000, 'num_agent_steps_trained': 260000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.17, 'episode_len_mean': 873.16, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 87316, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0], 'episode_lengths': [1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.6017141691734027, 'mean_inference_ms': 8.661601535806481, 'mean_action_processing_ms': 0.1187458278836449, 'mean_env_wait_ms': 0.22377240986515218, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.20576930046081543, 'StateBufferConnector_ms': 0.007480144500732422, 'ViewRequirementAgentConnector_ms': 0.12819504737854004}, 'num_episodes': 6, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.17}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.17, 'episode_len_mean': 873.16, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 87316, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0], 'episode_lengths': [1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.6017141691734027, 'mean_inference_ms': 8.661601535806481, 'mean_action_processing_ms': 0.1187458278836449, 'mean_env_wait_ms': 0.22377240986515218, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.20576930046081543, 'StateBufferConnector_ms': 0.007480144500732422, 'ViewRequirementAgentConnector_ms': 0.12819504737854004}, 'num_episodes': 6, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.17}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.17, 'episode_len_mean': 873.16, 'episodes_this_iter': 6, 'episodes_timesteps_total': 87316, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [3.0, 3.0, 2.0, 2.0, 5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0], 'episode_lengths': [1016, 996, 795, 814, 1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.6017141691734027, 'mean_inference_ms': 8.661601535806481, 'mean_action_processing_ms': 0.1187458278836449, 'mean_env_wait_ms': 0.22377240986515218, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.20576930046081543, 'StateBufferConnector_ms': 0.007480144500732422, 'ViewRequirementAgentConnector_ms': 0.12819504737854004}, 'num_episodes': 6, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.17, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 260000, 'num_agent_steps_trained': 260000, 'num_env_steps_sampled': 260000, 'num_env_steps_trained': 260000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 26.87758246734988, 'num_env_steps_trained_throughput_per_sec': 26.87758246734988, 'timesteps_total': 260000, 'num_env_steps_sampled_lifetime': 260000, 'num_agent_steps_sampled_lifetime': 260000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 260000, 'timers': {'training_iteration_time_ms': 146573.588, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 146573.488, 'sample_time_ms': 17939.388, 'load_time_ms': 3.762, 'load_throughput': 1063181.455, 'learn_time_ms': 128615.655, 'learn_throughput': 31.1, 'synch_weights_time_ms': 14.082}, 'counters': {'num_env_steps_sampled': 260000, 'num_env_steps_trained': 260000, 'num_agent_steps_sampled': 260000, 'num_agent_steps_trained': 260000}, 'done': False, 'episodes_total': 341, 'training_iteration': 65, 'trial_id': 'default', 'date': '2024-05-10_15-05-41', 'timestamp': 1715349941, 'time_this_iter_s': 148.85091042518616, 'time_total_s': 9797.148490190506, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 9797.148490190506, 'iterations_since_restore': 65, 'perf': {'cpu_util_percent': 45.17156398104266, 'ram_util_percent': 55.71800947867298}}
	Step: 65
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.3606399034620613, 'cur_kl_coeff': 0.21357421874999993, 'cur_lr': 5.0000000000000016e-05, 'total_loss': -0.0006857563761533588, 'policy_loss': -0.009730794649290782, 'vf_loss': 0.006063133954309598, 'vf_explained_var': -0.10590291850028499, 'kl': 0.01396192141350963, 'entropy': 1.07869259824035, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 60915.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 264000, 'num_env_steps_trained': 264000, 'num_agent_steps_sampled': 264000, 'num_agent_steps_trained': 264000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.15, 'episode_len_mean': 872.44, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 87244, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0], 'episode_lengths': [1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.6007458019473445, 'mean_inference_ms': 8.656612024428977, 'mean_action_processing_ms': 0.11857943834853338, 'mean_env_wait_ms': 0.2234652033879549, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2057785987854004, 'StateBufferConnector_ms': 0.0064775943756103516, 'ViewRequirementAgentConnector_ms': 0.126173734664917}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.15}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.15, 'episode_len_mean': 872.44, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 87244, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0], 'episode_lengths': [1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.6007458019473445, 'mean_inference_ms': 8.656612024428977, 'mean_action_processing_ms': 0.11857943834853338, 'mean_env_wait_ms': 0.2234652033879549, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2057785987854004, 'StateBufferConnector_ms': 0.0064775943756103516, 'ViewRequirementAgentConnector_ms': 0.126173734664917}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.15}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.15, 'episode_len_mean': 872.44, 'episodes_this_iter': 4, 'episodes_timesteps_total': 87244, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [5.0, 4.0, 0.0, 2.0, 2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0], 'episode_lengths': [1397, 1188, 501, 792, 807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.6007458019473445, 'mean_inference_ms': 8.656612024428977, 'mean_action_processing_ms': 0.11857943834853338, 'mean_env_wait_ms': 0.2234652033879549, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2057785987854004, 'StateBufferConnector_ms': 0.0064775943756103516, 'ViewRequirementAgentConnector_ms': 0.126173734664917}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.15, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 264000, 'num_agent_steps_trained': 264000, 'num_env_steps_sampled': 264000, 'num_env_steps_trained': 264000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 26.9715934340235, 'num_env_steps_trained_throughput_per_sec': 26.9715934340235, 'timesteps_total': 264000, 'num_env_steps_sampled_lifetime': 264000, 'num_agent_steps_sampled_lifetime': 264000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 264000, 'timers': {'training_iteration_time_ms': 146946.868, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 146946.767, 'sample_time_ms': 17949.398, 'load_time_ms': 3.654, 'load_throughput': 1094661.238, 'learn_time_ms': 128980.201, 'learn_throughput': 31.013, 'synch_weights_time_ms': 12.903}, 'counters': {'num_env_steps_sampled': 264000, 'num_env_steps_trained': 264000, 'num_agent_steps_sampled': 264000, 'num_agent_steps_trained': 264000}, 'done': False, 'episodes_total': 345, 'training_iteration': 66, 'trial_id': 'default', 'date': '2024-05-10_15-08-09', 'timestamp': 1715350089, 'time_this_iter_s': 148.3327567577362, 'time_total_s': 9945.481246948242, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 9945.481246948242, 'iterations_since_restore': 66, 'perf': {'cpu_util_percent': 44.991904761904756, 'ram_util_percent': 55.41142857142857}}
	Step: 66
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.3734344671169916, 'cur_kl_coeff': 0.21357421874999993, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.0077124165431145695, 'policy_loss': 0.0004785592076919412, 'vf_loss': 0.006272873883598775, 'vf_explained_var': 0.07734752399947054, 'kl': 0.0044995356457125536, 'entropy': 1.0822173674260416, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 61845.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 268000, 'num_env_steps_trained': 268000, 'num_agent_steps_sampled': 268000, 'num_agent_steps_trained': 268000}, 'sampler_results': {'episode_reward_max': 4.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.11, 'episode_len_mean': 868.74, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 86874, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0], 'episode_lengths': [807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5997546967442123, 'mean_inference_ms': 8.652051904970223, 'mean_action_processing_ms': 0.11835406746533192, 'mean_env_wait_ms': 0.22313166466181336, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.21185564994812012, 'StateBufferConnector_ms': 0.0064775943756103516, 'ViewRequirementAgentConnector_ms': 0.12705755233764648}, 'num_episodes': 4, 'episode_return_max': 4.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.11}, 'env_runner_results': {'episode_reward_max': 4.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.11, 'episode_len_mean': 868.74, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 86874, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0], 'episode_lengths': [807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5997546967442123, 'mean_inference_ms': 8.652051904970223, 'mean_action_processing_ms': 0.11835406746533192, 'mean_env_wait_ms': 0.22313166466181336, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.21185564994812012, 'StateBufferConnector_ms': 0.0064775943756103516, 'ViewRequirementAgentConnector_ms': 0.12705755233764648}, 'num_episodes': 4, 'episode_return_max': 4.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.11}, 'episode_reward_max': 4.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.11, 'episode_len_mean': 868.74, 'episodes_this_iter': 4, 'episodes_timesteps_total': 86874, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [2.0, 4.0, 3.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0], 'episode_lengths': [807, 1244, 1004, 799, 996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5997546967442123, 'mean_inference_ms': 8.652051904970223, 'mean_action_processing_ms': 0.11835406746533192, 'mean_env_wait_ms': 0.22313166466181336, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.21185564994812012, 'StateBufferConnector_ms': 0.0064775943756103516, 'ViewRequirementAgentConnector_ms': 0.12705755233764648}, 'num_episodes': 4, 'episode_return_max': 4.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.11, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 268000, 'num_agent_steps_trained': 268000, 'num_env_steps_sampled': 268000, 'num_env_steps_trained': 268000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 26.825744765433917, 'num_env_steps_trained_throughput_per_sec': 26.825744765433917, 'timesteps_total': 268000, 'num_env_steps_sampled_lifetime': 268000, 'num_agent_steps_sampled_lifetime': 268000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 268000, 'timers': {'training_iteration_time_ms': 147419.791, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 147419.691, 'sample_time_ms': 17974.916, 'load_time_ms': 3.653, 'load_throughput': 1094846.97, 'learn_time_ms': 129427.906, 'learn_throughput': 30.905, 'synch_weights_time_ms': 12.804}, 'counters': {'num_env_steps_sampled': 268000, 'num_env_steps_trained': 268000, 'num_agent_steps_sampled': 268000, 'num_agent_steps_trained': 268000}, 'done': False, 'episodes_total': 349, 'training_iteration': 67, 'trial_id': 'default', 'date': '2024-05-10_15-10-38', 'timestamp': 1715350238, 'time_this_iter_s': 149.1421492099762, 'time_total_s': 10094.623396158218, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 10094.623396158218, 'iterations_since_restore': 67, 'perf': {'cpu_util_percent': 45.8829383886256, 'ram_util_percent': 56.07725118483414}}
	Step: 67
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.360721283638349, 'cur_kl_coeff': 0.10678710937499997, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.0017138387475247865, 'policy_loss': -0.007036712115520351, 'vf_loss': 0.007703494236514133, 'vf_explained_var': 0.39362309459717043, 'kl': 0.009805112082300761, 'entropy': 1.046958149569009, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 62775.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 272000, 'num_env_steps_trained': 272000, 'num_agent_steps_sampled': 272000, 'num_agent_steps_trained': 272000}, 'sampler_results': {'episode_reward_max': 4.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.1, 'episode_len_mean': 866.87, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 86687, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0], 'episode_lengths': [996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5986465860147642, 'mean_inference_ms': 8.648561987490615, 'mean_action_processing_ms': 0.11811823420419794, 'mean_env_wait_ms': 0.2227690410838979, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.20448017120361328, 'StateBufferConnector_ms': 0.007586479187011719, 'ViewRequirementAgentConnector_ms': 0.12294864654541016}, 'num_episodes': 4, 'episode_return_max': 4.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.1}, 'env_runner_results': {'episode_reward_max': 4.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.1, 'episode_len_mean': 866.87, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 86687, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0], 'episode_lengths': [996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5986465860147642, 'mean_inference_ms': 8.648561987490615, 'mean_action_processing_ms': 0.11811823420419794, 'mean_env_wait_ms': 0.2227690410838979, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.20448017120361328, 'StateBufferConnector_ms': 0.007586479187011719, 'ViewRequirementAgentConnector_ms': 0.12294864654541016}, 'num_episodes': 4, 'episode_return_max': 4.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.1}, 'episode_reward_max': 4.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.1, 'episode_len_mean': 866.87, 'episodes_this_iter': 4, 'episodes_timesteps_total': 86687, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [3.0, 2.0, 2.0, 4.0, 2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0], 'episode_lengths': [996, 788, 801, 1184, 826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5986465860147642, 'mean_inference_ms': 8.648561987490615, 'mean_action_processing_ms': 0.11811823420419794, 'mean_env_wait_ms': 0.2227690410838979, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.20448017120361328, 'StateBufferConnector_ms': 0.007586479187011719, 'ViewRequirementAgentConnector_ms': 0.12294864654541016}, 'num_episodes': 4, 'episode_return_max': 4.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.1, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 272000, 'num_agent_steps_trained': 272000, 'num_env_steps_sampled': 272000, 'num_env_steps_trained': 272000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 26.835881744485295, 'num_env_steps_trained_throughput_per_sec': 26.835881744485295, 'timesteps_total': 272000, 'num_env_steps_sampled_lifetime': 272000, 'num_agent_steps_sampled_lifetime': 272000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 272000, 'timers': {'training_iteration_time_ms': 147748.111, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 147748.011, 'sample_time_ms': 17979.259, 'load_time_ms': 3.594, 'load_throughput': 1112990.314, 'learn_time_ms': 129752.043, 'learn_throughput': 30.828, 'synch_weights_time_ms': 12.703}, 'counters': {'num_env_steps_sampled': 272000, 'num_env_steps_trained': 272000, 'num_agent_steps_sampled': 272000, 'num_agent_steps_trained': 272000}, 'done': False, 'episodes_total': 353, 'training_iteration': 68, 'trial_id': 'default', 'date': '2024-05-10_15-13-07', 'timestamp': 1715350387, 'time_this_iter_s': 149.08716702461243, 'time_total_s': 10243.71056318283, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 10243.71056318283, 'iterations_since_restore': 68, 'perf': {'cpu_util_percent': 45.05118483412322, 'ram_util_percent': 54.68199052132701}}
	Step: 68
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.2809569120807673, 'cur_kl_coeff': 0.10678710937499997, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.011627674623021996, 'policy_loss': 0.004936994773445912, 'vf_loss': 0.006069891779184071, 'vf_explained_var': 0.20514643390973408, 'kl': 0.005813312203212401, 'entropy': 1.023653454742124, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 63705.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 276000, 'num_env_steps_trained': 276000, 'num_agent_steps_sampled': 276000, 'num_agent_steps_trained': 276000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.11, 'episode_len_mean': 869.9, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 86990, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0], 'episode_lengths': [826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5974077776908917, 'mean_inference_ms': 8.644503935720964, 'mean_action_processing_ms': 0.11787419772509537, 'mean_env_wait_ms': 0.22231668027252993, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2058854103088379, 'StateBufferConnector_ms': 0.006604909896850586, 'ViewRequirementAgentConnector_ms': 0.12147355079650879}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.11}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.11, 'episode_len_mean': 869.9, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 86990, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0], 'episode_lengths': [826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5974077776908917, 'mean_inference_ms': 8.644503935720964, 'mean_action_processing_ms': 0.11787419772509537, 'mean_env_wait_ms': 0.22231668027252993, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2058854103088379, 'StateBufferConnector_ms': 0.006604909896850586, 'ViewRequirementAgentConnector_ms': 0.12147355079650879}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.11}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.11, 'episode_len_mean': 869.9, 'episodes_this_iter': 4, 'episodes_timesteps_total': 86990, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [2.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0], 'episode_lengths': [826, 801, 993, 524, 507, 819, 499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5974077776908917, 'mean_inference_ms': 8.644503935720964, 'mean_action_processing_ms': 0.11787419772509537, 'mean_env_wait_ms': 0.22231668027252993, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2058854103088379, 'StateBufferConnector_ms': 0.006604909896850586, 'ViewRequirementAgentConnector_ms': 0.12147355079650879}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.11, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 276000, 'num_agent_steps_trained': 276000, 'num_env_steps_sampled': 276000, 'num_env_steps_trained': 276000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 26.55477306482921, 'num_env_steps_trained_throughput_per_sec': 26.55477306482921, 'timesteps_total': 276000, 'num_env_steps_sampled_lifetime': 276000, 'num_agent_steps_sampled_lifetime': 276000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 276000, 'timers': {'training_iteration_time_ms': 148142.405, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 148142.304, 'sample_time_ms': 17984.945, 'load_time_ms': 3.711, 'load_throughput': 1077991.698, 'learn_time_ms': 130140.433, 'learn_throughput': 30.736, 'synch_weights_time_ms': 12.804}, 'counters': {'num_env_steps_sampled': 276000, 'num_env_steps_trained': 276000, 'num_agent_steps_sampled': 276000, 'num_agent_steps_trained': 276000}, 'done': False, 'episodes_total': 357, 'training_iteration': 69, 'trial_id': 'default', 'date': '2024-05-10_15-15-38', 'timestamp': 1715350538, 'time_this_iter_s': 150.66407942771912, 'time_total_s': 10394.37464261055, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 10394.37464261055, 'iterations_since_restore': 69, 'perf': {'cpu_util_percent': 45.85514018691589, 'ram_util_percent': 55.77570093457943}}
	Step: 69
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.3284142678303104, 'cur_kl_coeff': 0.10678710937499997, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.009275492940658844, 'policy_loss': 0.002052384591911749, 'vf_loss': 0.0057592977475192176, 'vf_explained_var': -0.17620052291500954, 'kl': 0.013707738282358169, 'entropy': 1.0665100285442926, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 64635.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 280000, 'num_env_steps_trained': 280000, 'num_agent_steps_sampled': 280000, 'num_agent_steps_trained': 280000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.11, 'episode_len_mean': 872.06, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 87206, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0], 'episode_lengths': [499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.595397618991887, 'mean_inference_ms': 8.637914306877562, 'mean_action_processing_ms': 0.11748758296629265, 'mean_env_wait_ms': 0.22163261497772782, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.19749236106872559, 'StateBufferConnector_ms': 0.006604909896850586, 'ViewRequirementAgentConnector_ms': 0.1148538589477539}, 'num_episodes': 6, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.11}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.11, 'episode_len_mean': 872.06, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 87206, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0], 'episode_lengths': [499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.595397618991887, 'mean_inference_ms': 8.637914306877562, 'mean_action_processing_ms': 0.11748758296629265, 'mean_env_wait_ms': 0.22163261497772782, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.19749236106872559, 'StateBufferConnector_ms': 0.006604909896850586, 'ViewRequirementAgentConnector_ms': 0.1148538589477539}, 'num_episodes': 6, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.11}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.11, 'episode_len_mean': 872.06, 'episodes_this_iter': 6, 'episodes_timesteps_total': 87206, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [0.0, 4.0, 0.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0], 'episode_lengths': [499, 1185, 499, 984, 797, 832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.595397618991887, 'mean_inference_ms': 8.637914306877562, 'mean_action_processing_ms': 0.11748758296629265, 'mean_env_wait_ms': 0.22163261497772782, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.19749236106872559, 'StateBufferConnector_ms': 0.006604909896850586, 'ViewRequirementAgentConnector_ms': 0.1148538589477539}, 'num_episodes': 6, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.11, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 280000, 'num_agent_steps_trained': 280000, 'num_env_steps_sampled': 280000, 'num_env_steps_trained': 280000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 26.48850771330614, 'num_env_steps_trained_throughput_per_sec': 26.48850771330614, 'timesteps_total': 280000, 'num_env_steps_sampled_lifetime': 280000, 'num_agent_steps_sampled_lifetime': 280000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 280000, 'timers': {'training_iteration_time_ms': 148710.722, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 148710.722, 'sample_time_ms': 18012.479, 'load_time_ms': 3.711, 'load_throughput': 1077846.263, 'learn_time_ms': 130681.416, 'learn_throughput': 30.609, 'synch_weights_time_ms': 12.704}, 'counters': {'num_env_steps_sampled': 280000, 'num_env_steps_trained': 280000, 'num_agent_steps_sampled': 280000, 'num_agent_steps_trained': 280000}, 'done': False, 'episodes_total': 363, 'training_iteration': 70, 'trial_id': 'default', 'date': '2024-05-10_15-18-09', 'timestamp': 1715350689, 'time_this_iter_s': 151.03888821601868, 'time_total_s': 10545.413530826569, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 10545.413530826569, 'iterations_since_restore': 70, 'perf': {'cpu_util_percent': 46.433802816901405, 'ram_util_percent': 57.44553990610329}}
	Step: 70
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.147362544555818, 'cur_kl_coeff': 0.10678710937499997, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.005584784036362043, 'policy_loss': -0.0004101905290798474, 'vf_loss': 0.005255589627483058, 'vf_explained_var': -0.4785427721597815, 'kl': 0.006923913189751157, 'entropy': 0.9983545267133302, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 65565.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 284000, 'num_env_steps_trained': 284000, 'num_agent_steps_sampled': 284000, 'num_agent_steps_trained': 284000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.09, 'episode_len_mean': 873.14, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 87314, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0], 'episode_lengths': [832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5937653195219365, 'mean_inference_ms': 8.63262336894969, 'mean_action_processing_ms': 0.11712537315752408, 'mean_env_wait_ms': 0.2210400758139272, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.19686627388000488, 'StateBufferConnector_ms': 0.006578922271728516, 'ViewRequirementAgentConnector_ms': 0.11482548713684082}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.09}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.09, 'episode_len_mean': 873.14, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 87314, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0], 'episode_lengths': [832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5937653195219365, 'mean_inference_ms': 8.63262336894969, 'mean_action_processing_ms': 0.11712537315752408, 'mean_env_wait_ms': 0.2210400758139272, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.19686627388000488, 'StateBufferConnector_ms': 0.006578922271728516, 'ViewRequirementAgentConnector_ms': 0.11482548713684082}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.09}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.09, 'episode_len_mean': 873.14, 'episodes_this_iter': 5, 'episodes_timesteps_total': 87314, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0], 'episode_lengths': [832, 793, 799, 793, 497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5937653195219365, 'mean_inference_ms': 8.63262336894969, 'mean_action_processing_ms': 0.11712537315752408, 'mean_env_wait_ms': 0.2210400758139272, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.19686627388000488, 'StateBufferConnector_ms': 0.006578922271728516, 'ViewRequirementAgentConnector_ms': 0.11482548713684082}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.09, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 284000, 'num_agent_steps_trained': 284000, 'num_env_steps_sampled': 284000, 'num_env_steps_trained': 284000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 19.51746616057599, 'num_env_steps_trained_throughput_per_sec': 19.51746616057599, 'timesteps_total': 284000, 'num_env_steps_sampled_lifetime': 284000, 'num_agent_steps_sampled_lifetime': 284000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 284000, 'timers': {'training_iteration_time_ms': 154626.549, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 154626.549, 'sample_time_ms': 18032.751, 'load_time_ms': 3.712, 'load_throughput': 1077444.786, 'learn_time_ms': 131157.918, 'learn_throughput': 30.498, 'synch_weights_time_ms': 5431.756}, 'counters': {'num_env_steps_sampled': 284000, 'num_env_steps_trained': 284000, 'num_agent_steps_sampled': 284000, 'num_agent_steps_trained': 284000}, 'done': False, 'episodes_total': 368, 'training_iteration': 71, 'trial_id': 'default', 'date': '2024-05-10_15-21-35', 'timestamp': 1715350895, 'time_this_iter_s': 205.7725534439087, 'time_total_s': 10751.186084270477, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 10751.186084270477, 'iterations_since_restore': 71, 'perf': {'cpu_util_percent': 45.21203703703704, 'ram_util_percent': 57.4611111111111}}
Saving weights...
	Step: 71
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.2091345558083186, 'cur_kl_coeff': 0.10678710937499997, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.0029781024508123157, 'policy_loss': -0.00337109595777527, 'vf_loss': 0.0051416531467268255, 'vf_explained_var': 0.016182104426045573, 'kl': 0.011307957312486103, 'entropy': 0.9565645747287299, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 66495.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 288000, 'num_env_steps_trained': 288000, 'num_agent_steps_sampled': 288000, 'num_agent_steps_trained': 288000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.11, 'episode_len_mean': 878.88, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 87888, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0], 'episode_lengths': [497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5925249182998874, 'mean_inference_ms': 8.628820830152645, 'mean_action_processing_ms': 0.11686096062165019, 'mean_env_wait_ms': 0.22058929740678068, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.19687271118164062, 'StateBufferConnector_ms': 0.006578922271728516, 'ViewRequirementAgentConnector_ms': 0.1138312816619873}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.11}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.11, 'episode_len_mean': 878.88, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 87888, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0], 'episode_lengths': [497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5925249182998874, 'mean_inference_ms': 8.628820830152645, 'mean_action_processing_ms': 0.11686096062165019, 'mean_env_wait_ms': 0.22058929740678068, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.19687271118164062, 'StateBufferConnector_ms': 0.006578922271728516, 'ViewRequirementAgentConnector_ms': 0.1138312816619873}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.11}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.11, 'episode_len_mean': 878.88, 'episodes_this_iter': 4, 'episodes_timesteps_total': 87888, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [0.0, 0.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0], 'episode_lengths': [497, 547, 1001, 1187, 804, 812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5925249182998874, 'mean_inference_ms': 8.628820830152645, 'mean_action_processing_ms': 0.11686096062165019, 'mean_env_wait_ms': 0.22058929740678068, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.19687271118164062, 'StateBufferConnector_ms': 0.006578922271728516, 'ViewRequirementAgentConnector_ms': 0.1138312816619873}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.11, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 288000, 'num_agent_steps_trained': 288000, 'num_env_steps_sampled': 288000, 'num_env_steps_trained': 288000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 22.405437111656386, 'num_env_steps_trained_throughput_per_sec': 22.405437111656386, 'timesteps_total': 288000, 'num_env_steps_sampled_lifetime': 288000, 'num_agent_steps_sampled_lifetime': 288000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 288000, 'timers': {'training_iteration_time_ms': 157965.378, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 157965.378, 'sample_time_ms': 18160.14, 'load_time_ms': 3.713, 'load_throughput': 1077216.494, 'learn_time_ms': 134369.064, 'learn_throughput': 29.769, 'synch_weights_time_ms': 5432.149}, 'counters': {'num_env_steps_sampled': 288000, 'num_env_steps_trained': 288000, 'num_agent_steps_sampled': 288000, 'num_agent_steps_trained': 288000}, 'done': False, 'episodes_total': 372, 'training_iteration': 72, 'trial_id': 'default', 'date': '2024-05-10_15-24-33', 'timestamp': 1715351073, 'time_this_iter_s': 178.56392288208008, 'time_total_s': 10929.750007152557, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 10929.750007152557, 'iterations_since_restore': 72, 'perf': {'cpu_util_percent': 55.548605577689244, 'ram_util_percent': 82.66095617529881}}
	Step: 72
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.3182348285230898, 'cur_kl_coeff': 0.10678710937499997, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.012121293445428212, 'policy_loss': 0.005152226632000298, 'vf_loss': 0.005056956670652595, 'vf_explained_var': -0.11798068579807076, 'kl': 0.017905813258320392, 'entropy': 0.9277696242896459, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 67425.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 292000, 'num_env_steps_trained': 292000, 'num_agent_steps_sampled': 292000, 'num_agent_steps_trained': 292000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.08, 'episode_len_mean': 876.37, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 87637, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0], 'episode_lengths': [812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5911898059197505, 'mean_inference_ms': 8.62523550889788, 'mean_action_processing_ms': 0.11654087990271943, 'mean_env_wait_ms': 0.22008117336805966, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.20084595680236816, 'StateBufferConnector_ms': 0.005581378936767578, 'ViewRequirementAgentConnector_ms': 0.11607646942138672}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.08}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.08, 'episode_len_mean': 876.37, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 87637, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0], 'episode_lengths': [812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5911898059197505, 'mean_inference_ms': 8.62523550889788, 'mean_action_processing_ms': 0.11654087990271943, 'mean_env_wait_ms': 0.22008117336805966, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.20084595680236816, 'StateBufferConnector_ms': 0.005581378936767578, 'ViewRequirementAgentConnector_ms': 0.11607646942138672}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.08}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.08, 'episode_len_mean': 876.37, 'episodes_this_iter': 5, 'episodes_timesteps_total': 87637, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0], 'episode_lengths': [812, 1001, 817, 548, 820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5911898059197505, 'mean_inference_ms': 8.62523550889788, 'mean_action_processing_ms': 0.11654087990271943, 'mean_env_wait_ms': 0.22008117336805966, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.20084595680236816, 'StateBufferConnector_ms': 0.005581378936767578, 'ViewRequirementAgentConnector_ms': 0.11607646942138672}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.08, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 292000, 'num_agent_steps_trained': 292000, 'num_env_steps_sampled': 292000, 'num_env_steps_trained': 292000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 15.04225327725478, 'num_env_steps_trained_throughput_per_sec': 15.04225327725478, 'timesteps_total': 292000, 'num_env_steps_sampled_lifetime': 292000, 'num_agent_steps_sampled_lifetime': 292000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 292000, 'timers': {'training_iteration_time_ms': 169915.66, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 169915.66, 'sample_time_ms': 18810.619, 'load_time_ms': 3.464, 'load_throughput': 1154676.32, 'learn_time_ms': 145668.436, 'learn_throughput': 27.46, 'synch_weights_time_ms': 5432.829}, 'counters': {'num_env_steps_sampled': 292000, 'num_env_steps_trained': 292000, 'num_agent_steps_sampled': 292000, 'num_agent_steps_trained': 292000}, 'done': False, 'episodes_total': 377, 'training_iteration': 73, 'trial_id': 'default', 'date': '2024-05-10_15-28-59', 'timestamp': 1715351339, 'time_this_iter_s': 265.9494159221649, 'time_total_s': 11195.699423074722, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 11195.699423074722, 'iterations_since_restore': 73, 'perf': {'cpu_util_percent': 78.201871657754, 'ram_util_percent': 80.19411764705882}}
	Step: 73
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.3776389647555607, 'cur_kl_coeff': 0.10678710937499997, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.003964468577854155, 'policy_loss': -0.004479309982590137, 'vf_loss': 0.006985753992577434, 'vf_explained_var': 0.2615185694668883, 'kl': 0.013653584341083425, 'entropy': 0.7922905978015674, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 68355.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 296000, 'num_env_steps_trained': 296000, 'num_agent_steps_sampled': 296000, 'num_agent_steps_trained': 296000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.11, 'episode_len_mean': 884.71, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 88471, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0], 'episode_lengths': [820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5902988369459115, 'mean_inference_ms': 8.62299716633736, 'mean_action_processing_ms': 0.1163399729283997, 'mean_env_wait_ms': 0.2197493898485242, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2012648582458496, 'StateBufferConnector_ms': 0.005581378936767578, 'ViewRequirementAgentConnector_ms': 0.12009000778198242}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.11}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.11, 'episode_len_mean': 884.71, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 88471, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0], 'episode_lengths': [820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5902988369459115, 'mean_inference_ms': 8.62299716633736, 'mean_action_processing_ms': 0.1163399729283997, 'mean_env_wait_ms': 0.2197493898485242, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2012648582458496, 'StateBufferConnector_ms': 0.005581378936767578, 'ViewRequirementAgentConnector_ms': 0.12009000778198242}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.11}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.11, 'episode_len_mean': 884.71, 'episodes_this_iter': 4, 'episodes_timesteps_total': 88471, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [2.0, 3.0, 2.0, 2.0, 4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0], 'episode_lengths': [820, 989, 800, 801, 1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5902988369459115, 'mean_inference_ms': 8.62299716633736, 'mean_action_processing_ms': 0.1163399729283997, 'mean_env_wait_ms': 0.2197493898485242, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2012648582458496, 'StateBufferConnector_ms': 0.005581378936767578, 'ViewRequirementAgentConnector_ms': 0.12009000778198242}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.11, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 296000, 'num_agent_steps_trained': 296000, 'num_env_steps_sampled': 296000, 'num_env_steps_trained': 296000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 23.389427308608944, 'num_env_steps_trained_throughput_per_sec': 23.389427308608944, 'timesteps_total': 296000, 'num_env_steps_sampled_lifetime': 296000, 'num_agent_steps_sampled_lifetime': 296000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 296000, 'timers': {'training_iteration_time_ms': 171734.046, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 171734.046, 'sample_time_ms': 19074.509, 'load_time_ms': 3.533, 'load_throughput': 1132241.576, 'learn_time_ms': 147223.014, 'learn_throughput': 27.17, 'synch_weights_time_ms': 5432.68}, 'counters': {'num_env_steps_sampled': 296000, 'num_env_steps_trained': 296000, 'num_agent_steps_sampled': 296000, 'num_agent_steps_trained': 296000}, 'done': False, 'episodes_total': 381, 'training_iteration': 74, 'trial_id': 'default', 'date': '2024-05-10_15-31-51', 'timestamp': 1715351511, 'time_this_iter_s': 171.05244398117065, 'time_total_s': 11366.751867055893, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 11366.751867055893, 'iterations_since_restore': 74, 'perf': {'cpu_util_percent': 44.151652892561984, 'ram_util_percent': 59.542561983471074}}
	Step: 74
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.0919501515485908, 'cur_kl_coeff': 0.10678710937499997, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.0021144636234478845, 'policy_loss': -0.003322554804304595, 'vf_loss': 0.0038655749844795253, 'vf_explained_var': -0.19310840464407397, 'kl': 0.014715673520580529, 'entropy': 0.8147544492957413, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 69285.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 300000, 'num_env_steps_trained': 300000, 'num_agent_steps_sampled': 300000, 'num_agent_steps_trained': 300000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.08, 'episode_len_mean': 884.39, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 88439, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0], 'episode_lengths': [1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5894673888721766, 'mean_inference_ms': 8.620993811759554, 'mean_action_processing_ms': 0.11617091339749117, 'mean_env_wait_ms': 0.21946103977898965, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.20617389678955078, 'StateBufferConnector_ms': 0.004584312438964844, 'ViewRequirementAgentConnector_ms': 0.12053847312927246}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.08}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.08, 'episode_len_mean': 884.39, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 88439, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0], 'episode_lengths': [1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5894673888721766, 'mean_inference_ms': 8.620993811759554, 'mean_action_processing_ms': 0.11617091339749117, 'mean_env_wait_ms': 0.21946103977898965, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.20617389678955078, 'StateBufferConnector_ms': 0.004584312438964844, 'ViewRequirementAgentConnector_ms': 0.12053847312927246}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.08}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.08, 'episode_len_mean': 884.39, 'episodes_this_iter': 4, 'episodes_timesteps_total': 88439, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [4.0, 2.0, 0.0, 3.0, 3.0, 2.0, 2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0], 'episode_lengths': [1180, 798, 505, 1012, 988, 793, 799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5894673888721766, 'mean_inference_ms': 8.620993811759554, 'mean_action_processing_ms': 0.11617091339749117, 'mean_env_wait_ms': 0.21946103977898965, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.20617389678955078, 'StateBufferConnector_ms': 0.004584312438964844, 'ViewRequirementAgentConnector_ms': 0.12053847312927246}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.08, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 300000, 'num_agent_steps_trained': 300000, 'num_env_steps_sampled': 300000, 'num_env_steps_trained': 300000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 25.94143473884084, 'num_env_steps_trained_throughput_per_sec': 25.94143473884084, 'timesteps_total': 300000, 'num_env_steps_sampled_lifetime': 300000, 'num_agent_steps_sampled_lifetime': 300000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 300000, 'timers': {'training_iteration_time_ms': 172271.103, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 172271.103, 'sample_time_ms': 19125.439, 'load_time_ms': 3.49, 'load_throughput': 1146188.257, 'learn_time_ms': 147709.183, 'learn_throughput': 27.08, 'synch_weights_time_ms': 5432.68}, 'counters': {'num_env_steps_sampled': 300000, 'num_env_steps_trained': 300000, 'num_agent_steps_sampled': 300000, 'num_agent_steps_trained': 300000}, 'done': False, 'episodes_total': 385, 'training_iteration': 75, 'trial_id': 'default', 'date': '2024-05-10_15-34-25', 'timestamp': 1715351665, 'time_this_iter_s': 154.2273771762848, 'time_total_s': 11520.979244232178, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 11520.979244232178, 'iterations_since_restore': 75, 'perf': {'cpu_util_percent': 45.71238532110091, 'ram_util_percent': 60.32431192660551}}
	Step: 75
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 0.678280503078494, 'cur_kl_coeff': 0.10678710937499997, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.0073879451686215975, 'policy_loss': 0.004999095159933292, 'vf_loss': 0.0016261889009206976, 'vf_explained_var': 0.036093446452130556, 'kl': 0.007141888086370048, 'entropy': 0.8236919430635309, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 70215.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 304000, 'num_env_steps_trained': 304000, 'num_agent_steps_sampled': 304000, 'num_agent_steps_trained': 304000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.06, 'episode_len_mean': 885.43, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 88543, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0], 'episode_lengths': [799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5878833702081746, 'mean_inference_ms': 8.616248727904262, 'mean_action_processing_ms': 0.11579314891873312, 'mean_env_wait_ms': 0.21887106106001858, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.20281338691711426, 'StateBufferConnector_ms': 0.004584312438964844, 'ViewRequirementAgentConnector_ms': 0.11786746978759766}, 'num_episodes': 6, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.06}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.06, 'episode_len_mean': 885.43, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 88543, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0], 'episode_lengths': [799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5878833702081746, 'mean_inference_ms': 8.616248727904262, 'mean_action_processing_ms': 0.11579314891873312, 'mean_env_wait_ms': 0.21887106106001858, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.20281338691711426, 'StateBufferConnector_ms': 0.004584312438964844, 'ViewRequirementAgentConnector_ms': 0.11786746978759766}, 'num_episodes': 6, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.06}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.06, 'episode_len_mean': 885.43, 'episodes_this_iter': 6, 'episodes_timesteps_total': 88543, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [2.0, 2.0, 4.0, 4.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0], 'episode_lengths': [799, 791, 1201, 1192, 835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5878833702081746, 'mean_inference_ms': 8.616248727904262, 'mean_action_processing_ms': 0.11579314891873312, 'mean_env_wait_ms': 0.21887106106001858, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.20281338691711426, 'StateBufferConnector_ms': 0.004584312438964844, 'ViewRequirementAgentConnector_ms': 0.11786746978759766}, 'num_episodes': 6, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.06, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 304000, 'num_agent_steps_trained': 304000, 'num_env_steps_sampled': 304000, 'num_env_steps_trained': 304000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 25.188202181157624, 'num_env_steps_trained_throughput_per_sec': 25.188202181157624, 'timesteps_total': 304000, 'num_env_steps_sampled_lifetime': 304000, 'num_agent_steps_sampled_lifetime': 304000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 304000, 'timers': {'training_iteration_time_ms': 173321.136, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 173321.136, 'sample_time_ms': 19244.457, 'load_time_ms': 3.499, 'load_throughput': 1143220.355, 'learn_time_ms': 148639.9, 'learn_throughput': 26.911, 'synch_weights_time_ms': 5433.08}, 'counters': {'num_env_steps_sampled': 304000, 'num_env_steps_trained': 304000, 'num_agent_steps_sampled': 304000, 'num_agent_steps_trained': 304000}, 'done': False, 'episodes_total': 391, 'training_iteration': 76, 'trial_id': 'default', 'date': '2024-05-10_15-37-04', 'timestamp': 1715351824, 'time_this_iter_s': 158.834534406662, 'time_total_s': 11679.81377863884, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 11679.81377863884, 'iterations_since_restore': 76, 'perf': {'cpu_util_percent': 45.04017857142857, 'ram_util_percent': 60.55625}}
	Step: 76
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.2497138065195852, 'cur_kl_coeff': 0.10678710937499997, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.004606268695125016, 'policy_loss': -0.0008340000104840084, 'vf_loss': 0.005149035923222395, 'vf_explained_var': -0.2199012673670246, 'kl': 0.0027272172363445534, 'entropy': 0.671433941202779, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 71145.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 308000, 'num_env_steps_trained': 308000, 'num_agent_steps_sampled': 308000, 'num_agent_steps_trained': 308000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.01, 'episode_len_mean': 881.17, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 88117, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0], 'episode_lengths': [835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5868362566954928, 'mean_inference_ms': 8.613170082944114, 'mean_action_processing_ms': 0.11555035898948866, 'mean_env_wait_ms': 0.21848993707984832, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.21121644973754883, 'StateBufferConnector_ms': 0.0035848617553710938, 'ViewRequirementAgentConnector_ms': 0.11486458778381348}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.01}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.01, 'episode_len_mean': 881.17, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 88117, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0], 'episode_lengths': [835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5868362566954928, 'mean_inference_ms': 8.613170082944114, 'mean_action_processing_ms': 0.11555035898948866, 'mean_env_wait_ms': 0.21848993707984832, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.21121644973754883, 'StateBufferConnector_ms': 0.0035848617553710938, 'ViewRequirementAgentConnector_ms': 0.11486458778381348}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.01}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.01, 'episode_len_mean': 881.17, 'episodes_this_iter': 4, 'episodes_timesteps_total': 88117, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0], 'episode_lengths': [835, 793, 533, 523, 505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5868362566954928, 'mean_inference_ms': 8.613170082944114, 'mean_action_processing_ms': 0.11555035898948866, 'mean_env_wait_ms': 0.21848993707984832, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.21121644973754883, 'StateBufferConnector_ms': 0.0035848617553710938, 'ViewRequirementAgentConnector_ms': 0.11486458778381348}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.01, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 308000, 'num_agent_steps_trained': 308000, 'num_env_steps_sampled': 308000, 'num_env_steps_trained': 308000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 25.309374494850502, 'num_env_steps_trained_throughput_per_sec': 25.309374494850502, 'timesteps_total': 308000, 'num_env_steps_sampled_lifetime': 308000, 'num_agent_steps_sampled_lifetime': 308000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 308000, 'timers': {'training_iteration_time_ms': 174214.507, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 174214.507, 'sample_time_ms': 19355.524, 'load_time_ms': 3.35, 'load_throughput': 1193869.976, 'learn_time_ms': 149422.154, 'learn_throughput': 26.77, 'synch_weights_time_ms': 5433.279}, 'counters': {'num_env_steps_sampled': 308000, 'num_env_steps_trained': 308000, 'num_agent_steps_sampled': 308000, 'num_agent_steps_trained': 308000}, 'done': False, 'episodes_total': 395, 'training_iteration': 77, 'trial_id': 'default', 'date': '2024-05-10_15-39-42', 'timestamp': 1715351982, 'time_this_iter_s': 158.0746204853058, 'time_total_s': 11837.888399124146, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 11837.888399124146, 'iterations_since_restore': 77, 'perf': {'cpu_util_percent': 43.604910714285715, 'ram_util_percent': 61.191071428571426}}
	Step: 77
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.2832077072072092, 'cur_kl_coeff': 0.05339355468749998, 'cur_lr': 5.0000000000000016e-05, 'total_loss': -0.004940908814289717, 'policy_loss': -0.010165230895803179, 'vf_loss': 0.005034552819345282, 'vf_explained_var': -0.007590242291009555, 'kl': 0.0035541276033786125, 'entropy': 0.6946132825106703, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 72075.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 312000, 'num_env_steps_trained': 312000, 'num_agent_steps_sampled': 312000, 'num_agent_steps_trained': 312000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.03, 'episode_len_mean': 890.79, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 89079, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0], 'episode_lengths': [505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5858449768881294, 'mean_inference_ms': 8.610363071950879, 'mean_action_processing_ms': 0.11531424242781016, 'mean_env_wait_ms': 0.21812856675081746, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.20157265663146973, 'StateBufferConnector_ms': 0.005094289779663086, 'ViewRequirementAgentConnector_ms': 0.11910033226013184}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.03}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.03, 'episode_len_mean': 890.79, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 89079, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0], 'episode_lengths': [505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5858449768881294, 'mean_inference_ms': 8.610363071950879, 'mean_action_processing_ms': 0.11531424242781016, 'mean_env_wait_ms': 0.21812856675081746, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.20157265663146973, 'StateBufferConnector_ms': 0.005094289779663086, 'ViewRequirementAgentConnector_ms': 0.11910033226013184}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.03}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.03, 'episode_len_mean': 890.79, 'episodes_this_iter': 4, 'episodes_timesteps_total': 89079, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [0.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0], 'episode_lengths': [505, 800, 1088, 1036, 999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5858449768881294, 'mean_inference_ms': 8.610363071950879, 'mean_action_processing_ms': 0.11531424242781016, 'mean_env_wait_ms': 0.21812856675081746, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.20157265663146973, 'StateBufferConnector_ms': 0.005094289779663086, 'ViewRequirementAgentConnector_ms': 0.11910033226013184}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.03, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 312000, 'num_agent_steps_trained': 312000, 'num_env_steps_sampled': 312000, 'num_env_steps_trained': 312000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 25.712644184550793, 'num_env_steps_trained_throughput_per_sec': 25.712644184550793, 'timesteps_total': 312000, 'num_env_steps_sampled_lifetime': 312000, 'num_agent_steps_sampled_lifetime': 312000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 312000, 'timers': {'training_iteration_time_ms': 174865.639, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 174865.639, 'sample_time_ms': 19419.09, 'load_time_ms': 3.35, 'load_throughput': 1194082.404, 'learn_time_ms': 150009.515, 'learn_throughput': 26.665, 'synch_weights_time_ms': 5433.485}, 'counters': {'num_env_steps_sampled': 312000, 'num_env_steps_trained': 312000, 'num_agent_steps_sampled': 312000, 'num_agent_steps_trained': 312000}, 'done': False, 'episodes_total': 399, 'training_iteration': 78, 'trial_id': 'default', 'date': '2024-05-10_15-42-17', 'timestamp': 1715352137, 'time_this_iter_s': 155.5953381061554, 'time_total_s': 11993.4837372303, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 11993.4837372303, 'iterations_since_restore': 78, 'perf': {'cpu_util_percent': 44.63999999999999, 'ram_util_percent': 61.907272727272726}}
	Step: 78
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.5494521446766392, 'cur_kl_coeff': 0.02669677734374999, 'cur_lr': 5.0000000000000016e-05, 'total_loss': -0.0012232567297585147, 'policy_loss': -0.008506934329747192, 'vf_loss': 0.0069992111917893075, 'vf_explained_var': 0.04565832223943485, 'kl': 0.010655532098628502, 'entropy': 0.7006330780444606, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 73005.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 316000, 'num_env_steps_trained': 316000, 'num_agent_steps_sampled': 316000, 'num_agent_steps_trained': 316000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.06, 'episode_len_mean': 897.78, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 89778, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0], 'episode_lengths': [999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5848589556729052, 'mean_inference_ms': 8.607683173374575, 'mean_action_processing_ms': 0.11508109522003823, 'mean_env_wait_ms': 0.2177710410068654, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.1985337734222412, 'StateBufferConnector_ms': 0.005094289779663086, 'ViewRequirementAgentConnector_ms': 0.12158584594726562}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.06}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.06, 'episode_len_mean': 897.78, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 89778, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0], 'episode_lengths': [999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5848589556729052, 'mean_inference_ms': 8.607683173374575, 'mean_action_processing_ms': 0.11508109522003823, 'mean_env_wait_ms': 0.2177710410068654, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.1985337734222412, 'StateBufferConnector_ms': 0.005094289779663086, 'ViewRequirementAgentConnector_ms': 0.12158584594726562}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.06}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.06, 'episode_len_mean': 897.78, 'episodes_this_iter': 4, 'episodes_timesteps_total': 89778, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [3.0, 4.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0], 'episode_lengths': [999, 1256, 1020, 831, 840, 895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5848589556729052, 'mean_inference_ms': 8.607683173374575, 'mean_action_processing_ms': 0.11508109522003823, 'mean_env_wait_ms': 0.2177710410068654, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.1985337734222412, 'StateBufferConnector_ms': 0.005094289779663086, 'ViewRequirementAgentConnector_ms': 0.12158584594726562}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.06, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 316000, 'num_agent_steps_trained': 316000, 'num_env_steps_sampled': 316000, 'num_env_steps_trained': 316000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 26.175184583848832, 'num_env_steps_trained_throughput_per_sec': 26.175184583848832, 'timesteps_total': 316000, 'num_env_steps_sampled_lifetime': 316000, 'num_agent_steps_sampled_lifetime': 316000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 316000, 'timers': {'training_iteration_time_ms': 175084.083, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 175084.083, 'sample_time_ms': 19411.752, 'load_time_ms': 3.229, 'load_throughput': 1238884.081, 'learn_time_ms': 150235.419, 'learn_throughput': 26.625, 'synch_weights_time_ms': 5433.484}, 'counters': {'num_env_steps_sampled': 316000, 'num_env_steps_trained': 316000, 'num_agent_steps_sampled': 316000, 'num_agent_steps_trained': 316000}, 'done': False, 'episodes_total': 403, 'training_iteration': 79, 'trial_id': 'default', 'date': '2024-05-10_15-44-50', 'timestamp': 1715352290, 'time_this_iter_s': 152.8473606109619, 'time_total_s': 12146.331097841263, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 12146.331097841263, 'iterations_since_restore': 79, 'perf': {'cpu_util_percent': 49.59166666666666, 'ram_util_percent': 61.72222222222222}}
	Step: 79
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 0.9883693112240683, 'cur_kl_coeff': 0.02669677734374999, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.010296495735485066, 'policy_loss': 0.006717669855683081, 'vf_loss': 0.0033561095361649, 'vf_explained_var': -0.10671077697507797, 'kl': 0.00834243800689378, 'entropy': 0.790185774029583, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 73935.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 320000, 'num_env_steps_trained': 320000, 'num_agent_steps_sampled': 320000, 'num_agent_steps_trained': 320000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.99, 'episode_len_mean': 889.56, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 88956, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0], 'episode_lengths': [895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5836629921231937, 'mean_inference_ms': 8.60459575979801, 'mean_action_processing_ms': 0.11478551616814567, 'mean_env_wait_ms': 0.21732839857921998, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.19807100296020508, 'StateBufferConnector_ms': 0.005094289779663086, 'ViewRequirementAgentConnector_ms': 0.12459707260131836}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.99}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.99, 'episode_len_mean': 889.56, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 88956, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0], 'episode_lengths': [895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5836629921231937, 'mean_inference_ms': 8.60459575979801, 'mean_action_processing_ms': 0.11478551616814567, 'mean_env_wait_ms': 0.21732839857921998, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.19807100296020508, 'StateBufferConnector_ms': 0.005094289779663086, 'ViewRequirementAgentConnector_ms': 0.12459707260131836}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.99}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.99, 'episode_len_mean': 889.56, 'episodes_this_iter': 5, 'episodes_timesteps_total': 88956, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [2.0, 3.0, 2.0, 0.0, 0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0], 'episode_lengths': [895, 1013, 825, 540, 545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5836629921231937, 'mean_inference_ms': 8.60459575979801, 'mean_action_processing_ms': 0.11478551616814567, 'mean_env_wait_ms': 0.21732839857921998, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.19807100296020508, 'StateBufferConnector_ms': 0.005094289779663086, 'ViewRequirementAgentConnector_ms': 0.12459707260131836}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.99, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 320000, 'num_agent_steps_trained': 320000, 'num_env_steps_sampled': 320000, 'num_env_steps_trained': 320000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 21.75236934311697, 'num_env_steps_trained_throughput_per_sec': 21.75236934311697, 'timesteps_total': 320000, 'num_env_steps_sampled_lifetime': 320000, 'num_agent_steps_sampled_lifetime': 320000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 320000, 'timers': {'training_iteration_time_ms': 178371.996, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 178371.996, 'sample_time_ms': 19418.416, 'load_time_ms': 3.228, 'load_throughput': 1239186.049, 'learn_time_ms': 153516.598, 'learn_throughput': 26.056, 'synch_weights_time_ms': 5433.456}, 'counters': {'num_env_steps_sampled': 320000, 'num_env_steps_trained': 320000, 'num_agent_steps_sampled': 320000, 'num_agent_steps_trained': 320000}, 'done': False, 'episodes_total': 408, 'training_iteration': 80, 'trial_id': 'default', 'date': '2024-05-10_15-47-54', 'timestamp': 1715352474, 'time_this_iter_s': 183.91708755493164, 'time_total_s': 12330.248185396194, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 12330.248185396194, 'iterations_since_restore': 80, 'perf': {'cpu_util_percent': 46.28352490421456, 'ram_util_percent': 65.53333333333332}}
	Step: 80
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.4518033386718843, 'cur_kl_coeff': 0.02669677734374999, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.0007302666183120461, 'policy_loss': -0.0050736738348840385, 'vf_loss': 0.005372713655856142, 'vf_explained_var': 0.14756461164002777, 'kl': 0.016152769209915804, 'entropy': 0.8128732541716227, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 74865.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 324000, 'num_env_steps_trained': 324000, 'num_agent_steps_sampled': 324000, 'num_agent_steps_trained': 324000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.99, 'episode_len_mean': 888.76, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 88876, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0], 'episode_lengths': [545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5829017013004394, 'mean_inference_ms': 8.602881590735292, 'mean_action_processing_ms': 0.11463210537424189, 'mean_env_wait_ms': 0.21705495355062662, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.19556713104248047, 'StateBufferConnector_ms': 0.005094289779663086, 'ViewRequirementAgentConnector_ms': 0.13121557235717773}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.99}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.99, 'episode_len_mean': 888.76, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 88876, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0], 'episode_lengths': [545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5829017013004394, 'mean_inference_ms': 8.602881590735292, 'mean_action_processing_ms': 0.11463210537424189, 'mean_env_wait_ms': 0.21705495355062662, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.19556713104248047, 'StateBufferConnector_ms': 0.005094289779663086, 'ViewRequirementAgentConnector_ms': 0.13121557235717773}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.99}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.99, 'episode_len_mean': 888.76, 'episodes_this_iter': 4, 'episodes_timesteps_total': 88876, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [0.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0], 'episode_lengths': [545, 1181, 1220, 1224, 1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5829017013004394, 'mean_inference_ms': 8.602881590735292, 'mean_action_processing_ms': 0.11463210537424189, 'mean_env_wait_ms': 0.21705495355062662, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.19556713104248047, 'StateBufferConnector_ms': 0.005094289779663086, 'ViewRequirementAgentConnector_ms': 0.13121557235717773}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.99, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 324000, 'num_agent_steps_trained': 324000, 'num_env_steps_sampled': 324000, 'num_env_steps_trained': 324000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 20.68260714273598, 'num_env_steps_trained_throughput_per_sec': 20.68260714273598, 'timesteps_total': 324000, 'num_env_steps_sampled_lifetime': 324000, 'num_agent_steps_sampled_lifetime': 324000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 324000, 'timers': {'training_iteration_time_ms': 177217.454, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 177217.454, 'sample_time_ms': 19778.855, 'load_time_ms': 3.292, 'load_throughput': 1214965.529, 'learn_time_ms': 157420.303, 'learn_throughput': 25.41, 'synch_weights_time_ms': 14.556}, 'counters': {'num_env_steps_sampled': 324000, 'num_env_steps_trained': 324000, 'num_agent_steps_sampled': 324000, 'num_agent_steps_trained': 324000}, 'done': False, 'episodes_total': 412, 'training_iteration': 81, 'trial_id': 'default', 'date': '2024-05-10_15-51-08', 'timestamp': 1715352668, 'time_this_iter_s': 193.4284679889679, 'time_total_s': 12523.676653385162, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 12523.676653385162, 'iterations_since_restore': 81, 'perf': {'cpu_util_percent': 43.00622710622711, 'ram_util_percent': 67.5956043956044}}
Saving weights...
	Step: 81
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.3797253969856489, 'cur_kl_coeff': 0.02669677734374999, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.0008116373100057645, 'policy_loss': -0.006091964618372981, 'vf_loss': 0.006704108562553301, 'vf_explained_var': 0.1901419726110274, 'kl': 0.007472527291681651, 'entropy': 0.7009302745222725, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 75795.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 328000, 'num_env_steps_trained': 328000, 'num_agent_steps_sampled': 328000, 'num_agent_steps_trained': 328000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.01, 'episode_len_mean': 893.18, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 89318, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0], 'episode_lengths': [1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5822534925558509, 'mean_inference_ms': 8.601931284979814, 'mean_action_processing_ms': 0.11445911381538153, 'mean_env_wait_ms': 0.21682445011677898, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.19362139701843262, 'StateBufferConnector_ms': 0.005094289779663086, 'ViewRequirementAgentConnector_ms': 0.13290810585021973}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.01}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.01, 'episode_len_mean': 893.18, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 89318, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0], 'episode_lengths': [1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5822534925558509, 'mean_inference_ms': 8.601931284979814, 'mean_action_processing_ms': 0.11445911381538153, 'mean_env_wait_ms': 0.21682445011677898, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.19362139701843262, 'StateBufferConnector_ms': 0.005094289779663086, 'ViewRequirementAgentConnector_ms': 0.13290810585021973}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.01}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.01, 'episode_len_mean': 893.18, 'episodes_this_iter': 4, 'episodes_timesteps_total': 89318, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [4.0, 3.0, 3.0, 0.0, 2.0, 3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0], 'episode_lengths': [1236, 1020, 1032, 609, 839, 1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5822534925558509, 'mean_inference_ms': 8.601931284979814, 'mean_action_processing_ms': 0.11445911381538153, 'mean_env_wait_ms': 0.21682445011677898, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.19362139701843262, 'StateBufferConnector_ms': 0.005094289779663086, 'ViewRequirementAgentConnector_ms': 0.13290810585021973}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.01, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 328000, 'num_agent_steps_trained': 328000, 'num_env_steps_sampled': 328000, 'num_env_steps_trained': 328000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 21.437768609229973, 'num_env_steps_trained_throughput_per_sec': 21.437768609229973, 'timesteps_total': 328000, 'num_env_steps_sampled_lifetime': 328000, 'num_agent_steps_sampled_lifetime': 328000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 328000, 'timers': {'training_iteration_time_ms': 178023.303, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 178023.303, 'sample_time_ms': 20021.88, 'load_time_ms': 3.705, 'load_throughput': 1079746.945, 'learn_time_ms': 157983.099, 'learn_throughput': 25.319, 'synch_weights_time_ms': 14.17}, 'counters': {'num_env_steps_sampled': 328000, 'num_env_steps_trained': 328000, 'num_agent_steps_sampled': 328000, 'num_agent_steps_trained': 328000}, 'done': False, 'episodes_total': 416, 'training_iteration': 82, 'trial_id': 'default', 'date': '2024-05-10_15-54-14', 'timestamp': 1715352854, 'time_this_iter_s': 186.61988282203674, 'time_total_s': 12710.2965362072, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 12710.2965362072, 'iterations_since_restore': 82, 'perf': {'cpu_util_percent': 40.16856060606061, 'ram_util_percent': 68.02462121212122}}
	Step: 82
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.0990177240262748, 'cur_kl_coeff': 0.02669677734374999, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.004537399762099789, 'policy_loss': -2.2579445153154354e-05, 'vf_loss': 0.004446072905009577, 'vf_explained_var': -0.11537449488075831, 'kl': 0.004266653453060446, 'entropy': 0.8410468946180998, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 76725.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 332000, 'num_env_steps_trained': 332000, 'num_agent_steps_sampled': 332000, 'num_agent_steps_trained': 332000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.93, 'episode_len_mean': 880.5, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 88050, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0], 'episode_lengths': [1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5817016148832507, 'mean_inference_ms': 8.601763991520842, 'mean_action_processing_ms': 0.11432261933282606, 'mean_env_wait_ms': 0.21662724888757146, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.19955205917358398, 'StateBufferConnector_ms': 0.006078958511352539, 'ViewRequirementAgentConnector_ms': 0.13582563400268555}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.93}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.93, 'episode_len_mean': 880.5, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 88050, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0], 'episode_lengths': [1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5817016148832507, 'mean_inference_ms': 8.601763991520842, 'mean_action_processing_ms': 0.11432261933282606, 'mean_env_wait_ms': 0.21662724888757146, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.19955205917358398, 'StateBufferConnector_ms': 0.006078958511352539, 'ViewRequirementAgentConnector_ms': 0.13582563400268555}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.93}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.93, 'episode_len_mean': 880.5, 'episodes_this_iter': 5, 'episodes_timesteps_total': 88050, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [3.0, 4.0, 2.0, 2.0, 3.0, 4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0], 'episode_lengths': [1033, 1240, 840, 892, 1040, 1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5817016148832507, 'mean_inference_ms': 8.601763991520842, 'mean_action_processing_ms': 0.11432261933282606, 'mean_env_wait_ms': 0.21662724888757146, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.19955205917358398, 'StateBufferConnector_ms': 0.006078958511352539, 'ViewRequirementAgentConnector_ms': 0.13582563400268555}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.93, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 332000, 'num_agent_steps_trained': 332000, 'num_env_steps_sampled': 332000, 'num_env_steps_trained': 332000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 21.46717707365408, 'num_env_steps_trained_throughput_per_sec': 21.46717707365408, 'timesteps_total': 332000, 'num_env_steps_sampled_lifetime': 332000, 'num_agent_steps_sampled_lifetime': 332000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 332000, 'timers': {'training_iteration_time_ms': 170064.64, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 170064.64, 'sample_time_ms': 19700.57, 'load_time_ms': 3.555, 'load_throughput': 1125028.734, 'learn_time_ms': 150346.002, 'learn_throughput': 26.605, 'synch_weights_time_ms': 14.062}, 'counters': {'num_env_steps_sampled': 332000, 'num_env_steps_trained': 332000, 'num_agent_steps_sampled': 332000, 'num_agent_steps_trained': 332000}, 'done': False, 'episodes_total': 421, 'training_iteration': 83, 'trial_id': 'default', 'date': '2024-05-10_15-57-21', 'timestamp': 1715353041, 'time_this_iter_s': 186.3601622581482, 'time_total_s': 12896.656698465347, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 12896.656698465347, 'iterations_since_restore': 83, 'perf': {'cpu_util_percent': 41.08522727272727, 'ram_util_percent': 67.99318181818181}}
	Step: 83
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.1590468061787467, 'cur_kl_coeff': 0.013348388671874996, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.0011758766507589688, 'policy_loss': -0.004759730002091777, 'vf_loss': 0.005592068548702951, 'vf_explained_var': -0.0055148989282628545, 'kl': 0.025736368879985726, 'entropy': 0.7576695500943129, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 77655.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 336000, 'num_env_steps_trained': 336000, 'num_agent_steps_sampled': 336000, 'num_agent_steps_trained': 336000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.91, 'episode_len_mean': 876.73, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 87673, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0], 'episode_lengths': [1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5813456772471826, 'mean_inference_ms': 8.602595427725374, 'mean_action_processing_ms': 0.11423448982579634, 'mean_env_wait_ms': 0.21650490003824335, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.20665502548217773, 'StateBufferConnector_ms': 0.005575418472290039, 'ViewRequirementAgentConnector_ms': 0.13882923126220703}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.91}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.91, 'episode_len_mean': 876.73, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 87673, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0], 'episode_lengths': [1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5813456772471826, 'mean_inference_ms': 8.602595427725374, 'mean_action_processing_ms': 0.11423448982579634, 'mean_env_wait_ms': 0.21650490003824335, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.20665502548217773, 'StateBufferConnector_ms': 0.005575418472290039, 'ViewRequirementAgentConnector_ms': 0.13882923126220703}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.91}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.91, 'episode_len_mean': 876.73, 'episodes_this_iter': 5, 'episodes_timesteps_total': 87673, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [4.0, 4.0, 0.0, 2.0, 0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0], 'episode_lengths': [1228, 1201, 605, 825, 553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5813456772471826, 'mean_inference_ms': 8.602595427725374, 'mean_action_processing_ms': 0.11423448982579634, 'mean_env_wait_ms': 0.21650490003824335, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.20665502548217773, 'StateBufferConnector_ms': 0.005575418472290039, 'ViewRequirementAgentConnector_ms': 0.13882923126220703}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.91, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 336000, 'num_agent_steps_trained': 336000, 'num_env_steps_sampled': 336000, 'num_env_steps_trained': 336000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 21.396476189216287, 'num_env_steps_trained_throughput_per_sec': 21.396476189216287, 'timesteps_total': 336000, 'num_env_steps_sampled_lifetime': 336000, 'num_agent_steps_sampled_lifetime': 336000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 336000, 'timers': {'training_iteration_time_ms': 171657.563, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 171657.563, 'sample_time_ms': 19751.11, 'load_time_ms': 3.627, 'load_throughput': 1102951.509, 'learn_time_ms': 151888.142, 'learn_throughput': 26.335, 'synch_weights_time_ms': 14.334}, 'counters': {'num_env_steps_sampled': 336000, 'num_env_steps_trained': 336000, 'num_agent_steps_sampled': 336000, 'num_agent_steps_trained': 336000}, 'done': False, 'episodes_total': 426, 'training_iteration': 84, 'trial_id': 'default', 'date': '2024-05-10_16-00-28', 'timestamp': 1715353228, 'time_this_iter_s': 186.9754719734192, 'time_total_s': 13083.632170438766, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 13083.632170438766, 'iterations_since_restore': 84, 'perf': {'cpu_util_percent': 40.93787878787878, 'ram_util_percent': 68.37537878787879}}
	Step: 84
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.19663648624574, 'cur_kl_coeff': 0.0200225830078125, 'cur_lr': 5.0000000000000016e-05, 'total_loss': -0.011269196515692578, 'policy_loss': -0.016262938083720303, 'vf_loss': 0.004437140619002974, 'vf_explained_var': 0.3668022369184802, 'kl': 0.027798688461638212, 'entropy': 0.704468559962447, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 78585.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 340000, 'num_env_steps_trained': 340000, 'num_agent_steps_sampled': 340000, 'num_agent_steps_trained': 340000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.92, 'episode_len_mean': 876.82, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 87682, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0], 'episode_lengths': [553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5812256800574644, 'mean_inference_ms': 8.603924831153975, 'mean_action_processing_ms': 0.11419539349061976, 'mean_env_wait_ms': 0.21646161594821522, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.21127057075500488, 'StateBufferConnector_ms': 0.005575418472290039, 'ViewRequirementAgentConnector_ms': 0.1424713134765625}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.92}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.92, 'episode_len_mean': 876.82, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 87682, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0], 'episode_lengths': [553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5812256800574644, 'mean_inference_ms': 8.603924831153975, 'mean_action_processing_ms': 0.11419539349061976, 'mean_env_wait_ms': 0.21646161594821522, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.21127057075500488, 'StateBufferConnector_ms': 0.005575418472290039, 'ViewRequirementAgentConnector_ms': 0.1424713134765625}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.92}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.92, 'episode_len_mean': 876.82, 'episodes_this_iter': 4, 'episodes_timesteps_total': 87682, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [0.0, 2.0, 4.0, 0.0, 2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0], 'episode_lengths': [553, 840, 1208, 597, 850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5812256800574644, 'mean_inference_ms': 8.603924831153975, 'mean_action_processing_ms': 0.11419539349061976, 'mean_env_wait_ms': 0.21646161594821522, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.21127057075500488, 'StateBufferConnector_ms': 0.005575418472290039, 'ViewRequirementAgentConnector_ms': 0.1424713134765625}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.92, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 340000, 'num_agent_steps_trained': 340000, 'num_env_steps_sampled': 340000, 'num_env_steps_trained': 340000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 20.80177597392182, 'num_env_steps_trained_throughput_per_sec': 20.80177597392182, 'timesteps_total': 340000, 'num_env_steps_sampled_lifetime': 340000, 'num_agent_steps_sampled_lifetime': 340000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 340000, 'timers': {'training_iteration_time_ms': 175467.343, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 175467.343, 'sample_time_ms': 20015.802, 'load_time_ms': 3.829, 'load_throughput': 1044528.452, 'learn_time_ms': 155433.106, 'learn_throughput': 25.735, 'synch_weights_time_ms': 14.256}, 'counters': {'num_env_steps_sampled': 340000, 'num_env_steps_trained': 340000, 'num_agent_steps_sampled': 340000, 'num_agent_steps_trained': 340000}, 'done': False, 'episodes_total': 430, 'training_iteration': 85, 'trial_id': 'default', 'date': '2024-05-10_16-03-40', 'timestamp': 1715353420, 'time_this_iter_s': 192.32229852676392, 'time_total_s': 13275.95446896553, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 13275.95446896553, 'iterations_since_restore': 85, 'perf': {'cpu_util_percent': 41.63382352941177, 'ram_util_percent': 68.56875}}
	Step: 85
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.1185105071593355, 'cur_kl_coeff': 0.030033874511718742, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.003856388980495213, 'policy_loss': -0.0006088541359991155, 'vf_loss': 0.004312757707622793, 'vf_explained_var': 0.4152468567894351, 'kl': 0.005077092714136534, 'entropy': 0.7931977973830315, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 79515.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 344000, 'num_env_steps_trained': 344000, 'num_agent_steps_sampled': 344000, 'num_agent_steps_trained': 344000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.96, 'episode_len_mean': 881.92, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 88192, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 3.0], 'episode_lengths': [850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021, 1016, 816, 856, 1020]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5812254606001043, 'mean_inference_ms': 8.60583176873624, 'mean_action_processing_ms': 0.11418462402076496, 'mean_env_wait_ms': 0.21646819998527975, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.21847248077392578, 'StateBufferConnector_ms': 0.005575418472290039, 'ViewRequirementAgentConnector_ms': 0.14755940437316895}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.96}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.96, 'episode_len_mean': 881.92, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 88192, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 3.0], 'episode_lengths': [850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021, 1016, 816, 856, 1020]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5812254606001043, 'mean_inference_ms': 8.60583176873624, 'mean_action_processing_ms': 0.11418462402076496, 'mean_env_wait_ms': 0.21646819998527975, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.21847248077392578, 'StateBufferConnector_ms': 0.005575418472290039, 'ViewRequirementAgentConnector_ms': 0.14755940437316895}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.96}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.96, 'episode_len_mean': 881.92, 'episodes_this_iter': 4, 'episodes_timesteps_total': 88192, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [2.0, 0.0, 3.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 3.0], 'episode_lengths': [850, 545, 1008, 561, 815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021, 1016, 816, 856, 1020]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5812254606001043, 'mean_inference_ms': 8.60583176873624, 'mean_action_processing_ms': 0.11418462402076496, 'mean_env_wait_ms': 0.21646819998527975, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.21847248077392578, 'StateBufferConnector_ms': 0.005575418472290039, 'ViewRequirementAgentConnector_ms': 0.14755940437316895}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.96, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 344000, 'num_agent_steps_trained': 344000, 'num_env_steps_sampled': 344000, 'num_env_steps_trained': 344000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 21.09384070371456, 'num_env_steps_trained_throughput_per_sec': 21.09384070371456, 'timesteps_total': 344000, 'num_env_steps_sampled_lifetime': 344000, 'num_agent_steps_sampled_lifetime': 344000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 344000, 'timers': {'training_iteration_time_ms': 178549.773, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 178549.773, 'sample_time_ms': 20240.891, 'load_time_ms': 4.035, 'load_throughput': 991303.444, 'learn_time_ms': 158290.174, 'learn_throughput': 25.27, 'synch_weights_time_ms': 14.127}, 'counters': {'num_env_steps_sampled': 344000, 'num_env_steps_trained': 344000, 'num_agent_steps_sampled': 344000, 'num_agent_steps_trained': 344000}, 'done': False, 'episodes_total': 434, 'training_iteration': 86, 'trial_id': 'default', 'date': '2024-05-10_16-06-50', 'timestamp': 1715353610, 'time_this_iter_s': 189.65584778785706, 'time_total_s': 13465.610316753387, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 13465.610316753387, 'iterations_since_restore': 86, 'perf': {'cpu_util_percent': 41.06208178438661, 'ram_util_percent': 67.79256505576207}}
	Step: 86
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.255631909158922, 'cur_kl_coeff': 0.030033874511718742, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.0019023362767472062, 'policy_loss': -0.00345619208710168, 'vf_loss': 0.005139480544202861, 'vf_explained_var': 0.4682844013296148, 'kl': 0.007293317076995032, 'entropy': 0.7537468752553386, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 80445.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 348000, 'num_env_steps_trained': 348000, 'num_agent_steps_sampled': 348000, 'num_agent_steps_trained': 348000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.04, 'episode_len_mean': 895.23, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 89523, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 3.0, 4.0, 4.0, 3.0, 2.0], 'episode_lengths': [815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021, 1016, 816, 856, 1020, 1232, 1240, 1020, 803]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5813714139305208, 'mean_inference_ms': 8.608300648842999, 'mean_action_processing_ms': 0.11423026994569063, 'mean_env_wait_ms': 0.2165115173875376, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2247464656829834, 'StateBufferConnector_ms': 0.004575967788696289, 'ViewRequirementAgentConnector_ms': 0.14936161041259766}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.04}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.04, 'episode_len_mean': 895.23, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 89523, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 3.0, 4.0, 4.0, 3.0, 2.0], 'episode_lengths': [815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021, 1016, 816, 856, 1020, 1232, 1240, 1020, 803]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5813714139305208, 'mean_inference_ms': 8.608300648842999, 'mean_action_processing_ms': 0.11423026994569063, 'mean_env_wait_ms': 0.2165115173875376, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2247464656829834, 'StateBufferConnector_ms': 0.004575967788696289, 'ViewRequirementAgentConnector_ms': 0.14936161041259766}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.04}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.04, 'episode_len_mean': 895.23, 'episodes_this_iter': 4, 'episodes_timesteps_total': 89523, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 3.0, 4.0, 4.0, 3.0, 2.0], 'episode_lengths': [815, 1013, 528, 667, 1028, 1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021, 1016, 816, 856, 1020, 1232, 1240, 1020, 803]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5813714139305208, 'mean_inference_ms': 8.608300648842999, 'mean_action_processing_ms': 0.11423026994569063, 'mean_env_wait_ms': 0.2165115173875376, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2247464656829834, 'StateBufferConnector_ms': 0.004575967788696289, 'ViewRequirementAgentConnector_ms': 0.14936161041259766}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.04, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 348000, 'num_agent_steps_trained': 348000, 'num_env_steps_sampled': 348000, 'num_env_steps_trained': 348000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 20.438242340658977, 'num_env_steps_trained_throughput_per_sec': 20.438242340658977, 'timesteps_total': 348000, 'num_env_steps_sampled_lifetime': 348000, 'num_agent_steps_sampled_lifetime': 348000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 348000, 'timers': {'training_iteration_time_ms': 182316.507, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 182316.507, 'sample_time_ms': 20477.362, 'load_time_ms': 4.544, 'load_throughput': 880213.217, 'learn_time_ms': 161819.878, 'learn_throughput': 24.719, 'synch_weights_time_ms': 14.177}, 'counters': {'num_env_steps_sampled': 348000, 'num_env_steps_trained': 348000, 'num_agent_steps_sampled': 348000, 'num_agent_steps_trained': 348000}, 'done': False, 'episodes_total': 438, 'training_iteration': 87, 'trial_id': 'default', 'date': '2024-05-10_16-10-06', 'timestamp': 1715353806, 'time_this_iter_s': 195.74303770065308, 'time_total_s': 13661.35335445404, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 13661.35335445404, 'iterations_since_restore': 87, 'perf': {'cpu_util_percent': 41.99927797833935, 'ram_util_percent': 68.2032490974729}}
	Step: 87
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.2757999696558522, 'cur_kl_coeff': 0.030033874511718742, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.007252276648757278, 'policy_loss': 0.0016806166819346847, 'vf_loss': 0.005472794265495062, 'vf_explained_var': -0.018212748663399808, 'kl': 0.0032917815624442957, 'entropy': 0.7199775854746501, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 81375.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 352000, 'num_env_steps_trained': 352000, 'num_agent_steps_sampled': 352000, 'num_agent_steps_trained': 352000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.06, 'episode_len_mean': 898.82, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 89882, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 3.0, 4.0, 4.0, 3.0, 2.0, 3.0, 0.0, 0.0, 3.0, 4.0], 'episode_lengths': [1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021, 1016, 816, 856, 1020, 1232, 1240, 1020, 803, 1052, 545, 559, 1053, 1201]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5816336582397146, 'mean_inference_ms': 8.612057509059385, 'mean_action_processing_ms': 0.11426130746853151, 'mean_env_wait_ms': 0.21660676951184094, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2335343360900879, 'StateBufferConnector_ms': 0.005647420883178711, 'ViewRequirementAgentConnector_ms': 0.1470801830291748}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.06}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.06, 'episode_len_mean': 898.82, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 89882, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 3.0, 4.0, 4.0, 3.0, 2.0, 3.0, 0.0, 0.0, 3.0, 4.0], 'episode_lengths': [1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021, 1016, 816, 856, 1020, 1232, 1240, 1020, 803, 1052, 545, 559, 1053, 1201]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5816336582397146, 'mean_inference_ms': 8.612057509059385, 'mean_action_processing_ms': 0.11426130746853151, 'mean_env_wait_ms': 0.21660676951184094, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2335343360900879, 'StateBufferConnector_ms': 0.005647420883178711, 'ViewRequirementAgentConnector_ms': 0.1470801830291748}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.06}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.06, 'episode_len_mean': 898.82, 'episodes_this_iter': 5, 'episodes_timesteps_total': 89882, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [3.0, 2.0, 2.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 3.0, 4.0, 4.0, 3.0, 2.0, 3.0, 0.0, 0.0, 3.0, 4.0], 'episode_lengths': [1008, 846, 896, 595, 997, 1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021, 1016, 816, 856, 1020, 1232, 1240, 1020, 803, 1052, 545, 559, 1053, 1201]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5816336582397146, 'mean_inference_ms': 8.612057509059385, 'mean_action_processing_ms': 0.11426130746853151, 'mean_env_wait_ms': 0.21660676951184094, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2335343360900879, 'StateBufferConnector_ms': 0.005647420883178711, 'ViewRequirementAgentConnector_ms': 0.1470801830291748}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.06, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 352000, 'num_agent_steps_trained': 352000, 'num_env_steps_sampled': 352000, 'num_env_steps_trained': 352000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 21.068953956970244, 'num_env_steps_trained_throughput_per_sec': 21.068953956970244, 'timesteps_total': 352000, 'num_env_steps_sampled_lifetime': 352000, 'num_agent_steps_sampled_lifetime': 352000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 352000, 'timers': {'training_iteration_time_ms': 185745.239, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 185745.239, 'sample_time_ms': 20763.043, 'load_time_ms': 4.732, 'load_throughput': 845255.155, 'learn_time_ms': 164962.76, 'learn_throughput': 24.248, 'synch_weights_time_ms': 14.158}, 'counters': {'num_env_steps_sampled': 352000, 'num_env_steps_trained': 352000, 'num_agent_steps_sampled': 352000, 'num_agent_steps_trained': 352000}, 'done': False, 'episodes_total': 443, 'training_iteration': 88, 'trial_id': 'default', 'date': '2024-05-10_16-13-16', 'timestamp': 1715353996, 'time_this_iter_s': 189.88348269462585, 'time_total_s': 13851.236837148666, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 13851.236837148666, 'iterations_since_restore': 88, 'perf': {'cpu_util_percent': 41.52164179104477, 'ram_util_percent': 68.34067164179105}}
	Step: 88
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.0257441619230856, 'cur_kl_coeff': 0.015016937255859371, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.0032512879820280178, 'policy_loss': -0.0011497665717396684, 'vf_loss': 0.004118535088053504, 'vf_explained_var': -0.21196176960904112, 'kl': 0.01881328802038143, 'entropy': 0.5494323279267999, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 82305.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 356000, 'num_env_steps_trained': 356000, 'num_agent_steps_sampled': 356000, 'num_agent_steps_trained': 356000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.04, 'episode_len_mean': 893.95, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 89395, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 3.0, 4.0, 4.0, 3.0, 2.0, 3.0, 0.0, 0.0, 3.0, 4.0, 3.0, 2.0, 0.0, 2.0, 0.0], 'episode_lengths': [1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021, 1016, 816, 856, 1020, 1232, 1240, 1020, 803, 1052, 545, 559, 1053, 1201, 1004, 849, 608, 857, 537]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5821028802109067, 'mean_inference_ms': 8.616562250154672, 'mean_action_processing_ms': 0.11435706581262622, 'mean_env_wait_ms': 0.21678831852199873, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.23516345024108887, 'StateBufferConnector_ms': 0.006651639938354492, 'ViewRequirementAgentConnector_ms': 0.14626145362854004}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.04}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.04, 'episode_len_mean': 893.95, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 89395, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 3.0, 4.0, 4.0, 3.0, 2.0, 3.0, 0.0, 0.0, 3.0, 4.0, 3.0, 2.0, 0.0, 2.0, 0.0], 'episode_lengths': [1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021, 1016, 816, 856, 1020, 1232, 1240, 1020, 803, 1052, 545, 559, 1053, 1201, 1004, 849, 608, 857, 537]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5821028802109067, 'mean_inference_ms': 8.616562250154672, 'mean_action_processing_ms': 0.11435706581262622, 'mean_env_wait_ms': 0.21678831852199873, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.23516345024108887, 'StateBufferConnector_ms': 0.006651639938354492, 'ViewRequirementAgentConnector_ms': 0.14626145362854004}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.04}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.04, 'episode_len_mean': 893.95, 'episodes_this_iter': 5, 'episodes_timesteps_total': 89395, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [3.0, 3.0, 2.0, 3.0, 2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 3.0, 4.0, 4.0, 3.0, 2.0, 3.0, 0.0, 0.0, 3.0, 4.0, 3.0, 2.0, 0.0, 2.0, 0.0], 'episode_lengths': [1020, 1003, 845, 1012, 807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021, 1016, 816, 856, 1020, 1232, 1240, 1020, 803, 1052, 545, 559, 1053, 1201, 1004, 849, 608, 857, 537]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5821028802109067, 'mean_inference_ms': 8.616562250154672, 'mean_action_processing_ms': 0.11435706581262622, 'mean_env_wait_ms': 0.21678831852199873, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.23516345024108887, 'StateBufferConnector_ms': 0.006651639938354492, 'ViewRequirementAgentConnector_ms': 0.14626145362854004}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.04, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 356000, 'num_agent_steps_trained': 356000, 'num_env_steps_sampled': 356000, 'num_env_steps_trained': 356000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 20.56762007005508, 'num_env_steps_trained_throughput_per_sec': 20.56762007005508, 'timesteps_total': 356000, 'num_env_steps_sampled_lifetime': 356000, 'num_agent_steps_sampled_lifetime': 356000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 356000, 'timers': {'training_iteration_time_ms': 189911.635, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 189911.635, 'sample_time_ms': 21089.579, 'load_time_ms': 4.894, 'load_throughput': 817380.052, 'learn_time_ms': 168802.481, 'learn_throughput': 23.696, 'synch_weights_time_ms': 14.135}, 'counters': {'num_env_steps_sampled': 356000, 'num_env_steps_trained': 356000, 'num_agent_steps_sampled': 356000, 'num_agent_steps_trained': 356000}, 'done': False, 'episodes_total': 448, 'training_iteration': 89, 'trial_id': 'default', 'date': '2024-05-10_16-16-30', 'timestamp': 1715354190, 'time_this_iter_s': 194.51372170448303, 'time_total_s': 14045.75055885315, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 14045.75055885315, 'iterations_since_restore': 89, 'perf': {'cpu_util_percent': 41.461231884057966, 'ram_util_percent': 68.19673913043478}}
	Step: 89
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 0.9374710187235827, 'cur_kl_coeff': 0.015016937255859371, 'cur_lr': 5.0000000000000016e-05, 'total_loss': -0.003464508569368752, 'policy_loss': -0.006522424096461906, 'vf_loss': 0.00299949977734384, 'vf_explained_var': 0.26953266621917804, 'kl': 0.003889979026131401, 'entropy': 0.5538343634977135, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 83235.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 360000, 'num_env_steps_trained': 360000, 'num_agent_steps_sampled': 360000, 'num_agent_steps_trained': 360000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.01, 'episode_len_mean': 889.66, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 88966, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 3.0, 4.0, 4.0, 3.0, 2.0, 3.0, 0.0, 0.0, 3.0, 4.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0], 'episode_lengths': [807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021, 1016, 816, 856, 1020, 1232, 1240, 1020, 803, 1052, 545, 559, 1053, 1201, 1004, 849, 608, 857, 537, 869, 872, 872, 838]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.582636750964254, 'mean_inference_ms': 8.62077586075547, 'mean_action_processing_ms': 0.1144934537015266, 'mean_env_wait_ms': 0.21697499040043997, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.23883581161499023, 'StateBufferConnector_ms': 0.006082773208618164, 'ViewRequirementAgentConnector_ms': 0.14736127853393555}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.01}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.01, 'episode_len_mean': 889.66, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 88966, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 3.0, 4.0, 4.0, 3.0, 2.0, 3.0, 0.0, 0.0, 3.0, 4.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0], 'episode_lengths': [807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021, 1016, 816, 856, 1020, 1232, 1240, 1020, 803, 1052, 545, 559, 1053, 1201, 1004, 849, 608, 857, 537, 869, 872, 872, 838]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.582636750964254, 'mean_inference_ms': 8.62077586075547, 'mean_action_processing_ms': 0.1144934537015266, 'mean_env_wait_ms': 0.21697499040043997, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.23883581161499023, 'StateBufferConnector_ms': 0.006082773208618164, 'ViewRequirementAgentConnector_ms': 0.14736127853393555}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.01}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.01, 'episode_len_mean': 889.66, 'episodes_this_iter': 4, 'episodes_timesteps_total': 88966, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [2.0, 2.0, 5.0, 3.0, 2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 3.0, 4.0, 4.0, 3.0, 2.0, 3.0, 0.0, 0.0, 3.0, 4.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0], 'episode_lengths': [807, 815, 1417, 1004, 836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021, 1016, 816, 856, 1020, 1232, 1240, 1020, 803, 1052, 545, 559, 1053, 1201, 1004, 849, 608, 857, 537, 869, 872, 872, 838]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.582636750964254, 'mean_inference_ms': 8.62077586075547, 'mean_action_processing_ms': 0.1144934537015266, 'mean_env_wait_ms': 0.21697499040043997, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.23883581161499023, 'StateBufferConnector_ms': 0.006082773208618164, 'ViewRequirementAgentConnector_ms': 0.14736127853393555}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.01, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 360000, 'num_agent_steps_trained': 360000, 'num_env_steps_sampled': 360000, 'num_env_steps_trained': 360000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 21.114460410153903, 'num_env_steps_trained_throughput_per_sec': 21.114460410153903, 'timesteps_total': 360000, 'num_env_steps_sampled_lifetime': 360000, 'num_agent_steps_sampled_lifetime': 360000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 360000, 'timers': {'training_iteration_time_ms': 190467.196, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 190467.196, 'sample_time_ms': 21409.338, 'load_time_ms': 5.062, 'load_throughput': 790170.494, 'learn_time_ms': 169038.029, 'learn_throughput': 23.663, 'synch_weights_time_ms': 14.319}, 'counters': {'num_env_steps_sampled': 360000, 'num_env_steps_trained': 360000, 'num_agent_steps_sampled': 360000, 'num_agent_steps_trained': 360000}, 'done': False, 'episodes_total': 452, 'training_iteration': 90, 'trial_id': 'default', 'date': '2024-05-10_16-19-40', 'timestamp': 1715354380, 'time_this_iter_s': 189.47278690338135, 'time_total_s': 14235.22334575653, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 14235.22334575653, 'iterations_since_restore': 90, 'perf': {'cpu_util_percent': 39.772014925373135, 'ram_util_percent': 68.20111940298509}}
	Step: 90
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.3697523161448457, 'cur_kl_coeff': 0.007508468627929686, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.0018198153506013095, 'policy_loss': -0.005132274261565619, 'vf_loss': 0.00689782597561447, 'vf_explained_var': 0.0052445815455529, 'kl': 0.0072269119543444844, 'entropy': 0.5533571045565349, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 84165.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 364000, 'num_env_steps_trained': 364000, 'num_agent_steps_sampled': 364000, 'num_agent_steps_trained': 364000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.99, 'episode_len_mean': 888.47, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 88847, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 3.0, 4.0, 4.0, 3.0, 2.0, 3.0, 0.0, 0.0, 3.0, 4.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 5.0, 0.0], 'episode_lengths': [836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021, 1016, 816, 856, 1020, 1232, 1240, 1020, 803, 1052, 545, 559, 1053, 1201, 1004, 849, 608, 857, 537, 869, 872, 872, 838, 815, 1084, 1486, 539]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5832660417921163, 'mean_inference_ms': 8.62549442111587, 'mean_action_processing_ms': 0.11460659476925951, 'mean_env_wait_ms': 0.21719567671896733, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.23623013496398926, 'StateBufferConnector_ms': 0.006082773208618164, 'ViewRequirementAgentConnector_ms': 0.15182280540466309}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.99}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.99, 'episode_len_mean': 888.47, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 88847, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 3.0, 4.0, 4.0, 3.0, 2.0, 3.0, 0.0, 0.0, 3.0, 4.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 5.0, 0.0], 'episode_lengths': [836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021, 1016, 816, 856, 1020, 1232, 1240, 1020, 803, 1052, 545, 559, 1053, 1201, 1004, 849, 608, 857, 537, 869, 872, 872, 838, 815, 1084, 1486, 539]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5832660417921163, 'mean_inference_ms': 8.62549442111587, 'mean_action_processing_ms': 0.11460659476925951, 'mean_env_wait_ms': 0.21719567671896733, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.23623013496398926, 'StateBufferConnector_ms': 0.006082773208618164, 'ViewRequirementAgentConnector_ms': 0.15182280540466309}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.99}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.99, 'episode_len_mean': 888.47, 'episodes_this_iter': 4, 'episodes_timesteps_total': 88847, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [2.0, 4.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 3.0, 4.0, 4.0, 3.0, 2.0, 3.0, 0.0, 0.0, 3.0, 4.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 5.0, 0.0], 'episode_lengths': [836, 1220, 515, 1028, 565, 531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021, 1016, 816, 856, 1020, 1232, 1240, 1020, 803, 1052, 545, 559, 1053, 1201, 1004, 849, 608, 857, 537, 869, 872, 872, 838, 815, 1084, 1486, 539]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5832660417921163, 'mean_inference_ms': 8.62549442111587, 'mean_action_processing_ms': 0.11460659476925951, 'mean_env_wait_ms': 0.21719567671896733, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.23623013496398926, 'StateBufferConnector_ms': 0.006082773208618164, 'ViewRequirementAgentConnector_ms': 0.15182280540466309}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.99, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 364000, 'num_agent_steps_trained': 364000, 'num_env_steps_sampled': 364000, 'num_env_steps_trained': 364000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 20.933568695968333, 'num_env_steps_trained_throughput_per_sec': 20.933568695968333, 'timesteps_total': 364000, 'num_env_steps_sampled_lifetime': 364000, 'num_agent_steps_sampled_lifetime': 364000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 364000, 'timers': {'training_iteration_time_ms': 190235.34, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 190235.34, 'sample_time_ms': 21375.654, 'load_time_ms': 5.161, 'load_throughput': 774993.579, 'learn_time_ms': 168838.964, 'learn_throughput': 23.691, 'synch_weights_time_ms': 15.264}, 'counters': {'num_env_steps_sampled': 364000, 'num_env_steps_trained': 364000, 'num_agent_steps_sampled': 364000, 'num_agent_steps_trained': 364000}, 'done': False, 'episodes_total': 456, 'training_iteration': 91, 'trial_id': 'default', 'date': '2024-05-10_16-22-51', 'timestamp': 1715354571, 'time_this_iter_s': 191.10992193222046, 'time_total_s': 14426.333267688751, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 14426.333267688751, 'iterations_since_restore': 91, 'perf': {'cpu_util_percent': 41.849259259259256, 'ram_util_percent': 67.48703703703706}}
Saving weights...
	Step: 91
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 0.8069134540214974, 'cur_kl_coeff': 0.007508468627929686, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.003668428789223394, 'policy_loss': 4.393679480398855e-06, 'vf_loss': 0.0036297877032812984, 'vf_explained_var': -0.18362983747195172, 'kl': 0.00456115148720001, 'entropy': 0.40537202547314344, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 85095.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 368000, 'num_env_steps_trained': 368000, 'num_agent_steps_sampled': 368000, 'num_agent_steps_trained': 368000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.97, 'episode_len_mean': 886.65, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 88665, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 3.0, 4.0, 4.0, 3.0, 2.0, 3.0, 0.0, 0.0, 3.0, 4.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 5.0, 0.0, 2.0, 0.0, 2.0, 3.0, 0.0], 'episode_lengths': [531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021, 1016, 816, 856, 1020, 1232, 1240, 1020, 803, 1052, 545, 559, 1053, 1201, 1004, 849, 608, 857, 537, 869, 872, 872, 838, 815, 1084, 1486, 539, 870, 589, 854, 1053, 616]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.584222568047427, 'mean_inference_ms': 8.632172792422757, 'mean_action_processing_ms': 0.1148128086209865, 'mean_env_wait_ms': 0.21753618431303046, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2419435977935791, 'StateBufferConnector_ms': 0.007082700729370117, 'ViewRequirementAgentConnector_ms': 0.1547834873199463}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.97}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.97, 'episode_len_mean': 886.65, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 88665, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 3.0, 4.0, 4.0, 3.0, 2.0, 3.0, 0.0, 0.0, 3.0, 4.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 5.0, 0.0, 2.0, 0.0, 2.0, 3.0, 0.0], 'episode_lengths': [531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021, 1016, 816, 856, 1020, 1232, 1240, 1020, 803, 1052, 545, 559, 1053, 1201, 1004, 849, 608, 857, 537, 869, 872, 872, 838, 815, 1084, 1486, 539, 870, 589, 854, 1053, 616]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.584222568047427, 'mean_inference_ms': 8.632172792422757, 'mean_action_processing_ms': 0.1148128086209865, 'mean_env_wait_ms': 0.21753618431303046, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2419435977935791, 'StateBufferConnector_ms': 0.007082700729370117, 'ViewRequirementAgentConnector_ms': 0.1547834873199463}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.97}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 1.97, 'episode_len_mean': 886.65, 'episodes_this_iter': 5, 'episodes_timesteps_total': 88665, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [0.0, 2.0, 2.0, 0.0, 0.0, 3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 3.0, 4.0, 4.0, 3.0, 2.0, 3.0, 0.0, 0.0, 3.0, 4.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 5.0, 0.0, 2.0, 0.0, 2.0, 3.0, 0.0], 'episode_lengths': [531, 827, 849, 636, 612, 1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021, 1016, 816, 856, 1020, 1232, 1240, 1020, 803, 1052, 545, 559, 1053, 1201, 1004, 849, 608, 857, 537, 869, 872, 872, 838, 815, 1084, 1486, 539, 870, 589, 854, 1053, 616]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.584222568047427, 'mean_inference_ms': 8.632172792422757, 'mean_action_processing_ms': 0.1148128086209865, 'mean_env_wait_ms': 0.21753618431303046, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2419435977935791, 'StateBufferConnector_ms': 0.007082700729370117, 'ViewRequirementAgentConnector_ms': 0.1547834873199463}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 1.97, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 368000, 'num_agent_steps_trained': 368000, 'num_env_steps_sampled': 368000, 'num_env_steps_trained': 368000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 21.080032100239997, 'num_env_steps_trained_throughput_per_sec': 21.080032100239997, 'timesteps_total': 368000, 'num_env_steps_sampled_lifetime': 368000, 'num_agent_steps_sampled_lifetime': 368000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 368000, 'timers': {'training_iteration_time_ms': 190551.985, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 190551.985, 'sample_time_ms': 21390.775, 'load_time_ms': 5.208, 'load_throughput': 768099.622, 'learn_time_ms': 169139.725, 'learn_throughput': 23.649, 'synch_weights_time_ms': 15.872}, 'counters': {'num_env_steps_sampled': 368000, 'num_env_steps_trained': 368000, 'num_agent_steps_sampled': 368000, 'num_agent_steps_trained': 368000}, 'done': False, 'episodes_total': 461, 'training_iteration': 92, 'trial_id': 'default', 'date': '2024-05-10_16-26-01', 'timestamp': 1715354761, 'time_this_iter_s': 189.78171396255493, 'time_total_s': 14616.114981651306, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 14616.114981651306, 'iterations_since_restore': 92, 'perf': {'cpu_util_percent': 39.615985130111525, 'ram_util_percent': 68.15390334572491}}
	Step: 92
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 0.9197875039071165, 'cur_kl_coeff': 0.003754234313964843, 'cur_lr': 5.0000000000000016e-05, 'total_loss': -0.0030571014810633914, 'policy_loss': -0.006861992114253582, 'vf_loss': 0.0037680622728501435, 'vf_explained_var': 0.25405657201684934, 'kl': 0.009809653506342652, 'entropy': 0.4748137756701439, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 86025.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 372000, 'num_env_steps_trained': 372000, 'num_agent_steps_sampled': 372000, 'num_agent_steps_trained': 372000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.03, 'episode_len_mean': 896.45, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 89645, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 3.0, 4.0, 4.0, 3.0, 2.0, 3.0, 0.0, 0.0, 3.0, 4.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 5.0, 0.0, 2.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0], 'episode_lengths': [1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021, 1016, 816, 856, 1020, 1232, 1240, 1020, 803, 1052, 545, 559, 1053, 1201, 1004, 849, 608, 857, 537, 869, 872, 872, 838, 815, 1084, 1486, 539, 870, 589, 854, 1053, 616, 580, 1029, 1057, 906, 863]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5853429026747797, 'mean_inference_ms': 8.639433732922456, 'mean_action_processing_ms': 0.11507739640587031, 'mean_env_wait_ms': 0.21792833853011195, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2453320026397705, 'StateBufferConnector_ms': 0.008084297180175781, 'ViewRequirementAgentConnector_ms': 0.15758490562438965}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.03}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.03, 'episode_len_mean': 896.45, 'episode_media': {}, 'episodes_this_iter': 5, 'episodes_timesteps_total': 89645, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 3.0, 4.0, 4.0, 3.0, 2.0, 3.0, 0.0, 0.0, 3.0, 4.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 5.0, 0.0, 2.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0], 'episode_lengths': [1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021, 1016, 816, 856, 1020, 1232, 1240, 1020, 803, 1052, 545, 559, 1053, 1201, 1004, 849, 608, 857, 537, 869, 872, 872, 838, 815, 1084, 1486, 539, 870, 589, 854, 1053, 616, 580, 1029, 1057, 906, 863]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5853429026747797, 'mean_inference_ms': 8.639433732922456, 'mean_action_processing_ms': 0.11507739640587031, 'mean_env_wait_ms': 0.21792833853011195, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2453320026397705, 'StateBufferConnector_ms': 0.008084297180175781, 'ViewRequirementAgentConnector_ms': 0.15758490562438965}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.03}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.03, 'episode_len_mean': 896.45, 'episodes_this_iter': 5, 'episodes_timesteps_total': 89645, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [3.0, 2.0, 3.0, 2.0, 3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 3.0, 4.0, 4.0, 3.0, 2.0, 3.0, 0.0, 0.0, 3.0, 4.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 5.0, 0.0, 2.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0], 'episode_lengths': [1053, 922, 1032, 829, 1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021, 1016, 816, 856, 1020, 1232, 1240, 1020, 803, 1052, 545, 559, 1053, 1201, 1004, 849, 608, 857, 537, 869, 872, 872, 838, 815, 1084, 1486, 539, 870, 589, 854, 1053, 616, 580, 1029, 1057, 906, 863]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5853429026747797, 'mean_inference_ms': 8.639433732922456, 'mean_action_processing_ms': 0.11507739640587031, 'mean_env_wait_ms': 0.21792833853011195, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2453320026397705, 'StateBufferConnector_ms': 0.008084297180175781, 'ViewRequirementAgentConnector_ms': 0.15758490562438965}, 'num_episodes': 5, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.03, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 372000, 'num_agent_steps_trained': 372000, 'num_env_steps_sampled': 372000, 'num_env_steps_trained': 372000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 20.143304614195728, 'num_env_steps_trained_throughput_per_sec': 20.143304614195728, 'timesteps_total': 372000, 'num_env_steps_sampled_lifetime': 372000, 'num_agent_steps_sampled_lifetime': 372000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 372000, 'timers': {'training_iteration_time_ms': 191776.602, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 191776.602, 'sample_time_ms': 21392.011, 'load_time_ms': 5.428, 'load_throughput': 736864.075, 'learn_time_ms': 170362.319, 'learn_throughput': 23.479, 'synch_weights_time_ms': 16.541}, 'counters': {'num_env_steps_sampled': 372000, 'num_env_steps_trained': 372000, 'num_agent_steps_sampled': 372000, 'num_agent_steps_trained': 372000}, 'done': False, 'episodes_total': 466, 'training_iteration': 93, 'trial_id': 'default', 'date': '2024-05-10_16-29-19', 'timestamp': 1715354959, 'time_this_iter_s': 198.61782836914062, 'time_total_s': 14814.732810020447, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 14814.732810020447, 'iterations_since_restore': 93, 'perf': {'cpu_util_percent': 41.661921708185055, 'ram_util_percent': 67.30427046263345}}
	Step: 93
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 0.962347709603848, 'cur_kl_coeff': 0.003754234313964843, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.003009110410767858, 'policy_loss': -0.0009777296374561967, 'vf_loss': 0.0039758697740238545, 'vf_explained_var': -0.04966876622169249, 'kl': 0.0029227017806448736, 'entropy': 0.4782220426746594, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 86955.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 376000, 'num_env_steps_trained': 376000, 'num_agent_steps_sampled': 376000, 'num_agent_steps_trained': 376000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.01, 'episode_len_mean': 896.05, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 89605, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 3.0, 4.0, 4.0, 3.0, 2.0, 3.0, 0.0, 0.0, 3.0, 4.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 5.0, 0.0, 2.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 3.0, 3.0, 0.0, 2.0], 'episode_lengths': [1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021, 1016, 816, 856, 1020, 1232, 1240, 1020, 803, 1052, 545, 559, 1053, 1201, 1004, 849, 608, 857, 537, 869, 872, 872, 838, 815, 1084, 1486, 539, 870, 589, 854, 1053, 616, 580, 1029, 1057, 906, 863, 1023, 1076, 683, 1014]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.586302898119209, 'mean_inference_ms': 8.64560610895456, 'mean_action_processing_ms': 0.11529010021278076, 'mean_env_wait_ms': 0.21827397106368007, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.24883365631103516, 'StateBufferConnector_ms': 0.007111310958862305, 'ViewRequirementAgentConnector_ms': 0.15897893905639648}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.01}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.01, 'episode_len_mean': 896.05, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 89605, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 3.0, 4.0, 4.0, 3.0, 2.0, 3.0, 0.0, 0.0, 3.0, 4.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 5.0, 0.0, 2.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 3.0, 3.0, 0.0, 2.0], 'episode_lengths': [1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021, 1016, 816, 856, 1020, 1232, 1240, 1020, 803, 1052, 545, 559, 1053, 1201, 1004, 849, 608, 857, 537, 869, 872, 872, 838, 815, 1084, 1486, 539, 870, 589, 854, 1053, 616, 580, 1029, 1057, 906, 863, 1023, 1076, 683, 1014]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.586302898119209, 'mean_inference_ms': 8.64560610895456, 'mean_action_processing_ms': 0.11529010021278076, 'mean_env_wait_ms': 0.21827397106368007, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.24883365631103516, 'StateBufferConnector_ms': 0.007111310958862305, 'ViewRequirementAgentConnector_ms': 0.15897893905639648}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.01}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.01, 'episode_len_mean': 896.05, 'episodes_this_iter': 4, 'episodes_timesteps_total': 89605, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [3.0, 2.0, 0.0, 2.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 3.0, 4.0, 4.0, 3.0, 2.0, 3.0, 0.0, 0.0, 3.0, 4.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 5.0, 0.0, 2.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 3.0, 3.0, 0.0, 2.0], 'episode_lengths': [1025, 905, 576, 843, 941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021, 1016, 816, 856, 1020, 1232, 1240, 1020, 803, 1052, 545, 559, 1053, 1201, 1004, 849, 608, 857, 537, 869, 872, 872, 838, 815, 1084, 1486, 539, 870, 589, 854, 1053, 616, 580, 1029, 1057, 906, 863, 1023, 1076, 683, 1014]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.586302898119209, 'mean_inference_ms': 8.64560610895456, 'mean_action_processing_ms': 0.11529010021278076, 'mean_env_wait_ms': 0.21827397106368007, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.24883365631103516, 'StateBufferConnector_ms': 0.007111310958862305, 'ViewRequirementAgentConnector_ms': 0.15897893905639648}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.01, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 376000, 'num_agent_steps_trained': 376000, 'num_env_steps_sampled': 376000, 'num_env_steps_trained': 376000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 20.52796213514472, 'num_env_steps_trained_throughput_per_sec': 20.52796213514472, 'timesteps_total': 376000, 'num_env_steps_sampled_lifetime': 376000, 'num_agent_steps_sampled_lifetime': 376000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 376000, 'timers': {'training_iteration_time_ms': 192567.552, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 192567.552, 'sample_time_ms': 21406.721, 'load_time_ms': 5.407, 'load_throughput': 739723.109, 'learn_time_ms': 171138.615, 'learn_throughput': 23.373, 'synch_weights_time_ms': 16.454}, 'counters': {'num_env_steps_sampled': 376000, 'num_env_steps_trained': 376000, 'num_agent_steps_sampled': 376000, 'num_agent_steps_trained': 376000}, 'done': False, 'episodes_total': 470, 'training_iteration': 94, 'trial_id': 'default', 'date': '2024-05-10_16-32-34', 'timestamp': 1715355154, 'time_this_iter_s': 194.88540935516357, 'time_total_s': 15009.61821937561, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 15009.61821937561, 'iterations_since_restore': 94, 'perf': {'cpu_util_percent': 39.93745454545454, 'ram_util_percent': 66.58872727272728}}
	Step: 94
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 0.9718028741578261, 'cur_kl_coeff': 0.0018771171569824214, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.0012578829722378843, 'policy_loss': -0.0024439779821262566, 'vf_loss': 0.003688401644350022, 'vf_explained_var': 0.13529028174697713, 'kl': 0.007171240271069074, 'entropy': 0.536488345361525, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 87885.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 380000, 'num_env_steps_trained': 380000, 'num_agent_steps_sampled': 380000, 'num_agent_steps_trained': 380000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.05, 'episode_len_mean': 907.18, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 90718, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 3.0, 4.0, 4.0, 3.0, 2.0, 3.0, 0.0, 0.0, 3.0, 4.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 5.0, 0.0, 2.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 3.0, 3.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0], 'episode_lengths': [941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021, 1016, 816, 856, 1020, 1232, 1240, 1020, 803, 1052, 545, 559, 1053, 1201, 1004, 849, 608, 857, 537, 869, 872, 872, 838, 815, 1084, 1486, 539, 870, 589, 854, 1053, 616, 580, 1029, 1057, 906, 863, 1023, 1076, 683, 1014, 1147, 1240, 946, 1129]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5872213710564976, 'mean_inference_ms': 8.651466443338945, 'mean_action_processing_ms': 0.11549467474923797, 'mean_env_wait_ms': 0.2186108066642818, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2493300437927246, 'StateBufferConnector_ms': 0.007111310958862305, 'ViewRequirementAgentConnector_ms': 0.16119909286499023}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.05}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.05, 'episode_len_mean': 907.18, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 90718, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 3.0, 4.0, 4.0, 3.0, 2.0, 3.0, 0.0, 0.0, 3.0, 4.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 5.0, 0.0, 2.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 3.0, 3.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0], 'episode_lengths': [941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021, 1016, 816, 856, 1020, 1232, 1240, 1020, 803, 1052, 545, 559, 1053, 1201, 1004, 849, 608, 857, 537, 869, 872, 872, 838, 815, 1084, 1486, 539, 870, 589, 854, 1053, 616, 580, 1029, 1057, 906, 863, 1023, 1076, 683, 1014, 1147, 1240, 946, 1129]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5872213710564976, 'mean_inference_ms': 8.651466443338945, 'mean_action_processing_ms': 0.11549467474923797, 'mean_env_wait_ms': 0.2186108066642818, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2493300437927246, 'StateBufferConnector_ms': 0.007111310958862305, 'ViewRequirementAgentConnector_ms': 0.16119909286499023}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.05}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.05, 'episode_len_mean': 907.18, 'episodes_this_iter': 4, 'episodes_timesteps_total': 90718, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 3.0, 4.0, 4.0, 3.0, 2.0, 3.0, 0.0, 0.0, 3.0, 4.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 5.0, 0.0, 2.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 3.0, 3.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0], 'episode_lengths': [941, 834, 591, 627, 1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021, 1016, 816, 856, 1020, 1232, 1240, 1020, 803, 1052, 545, 559, 1053, 1201, 1004, 849, 608, 857, 537, 869, 872, 872, 838, 815, 1084, 1486, 539, 870, 589, 854, 1053, 616, 580, 1029, 1057, 906, 863, 1023, 1076, 683, 1014, 1147, 1240, 946, 1129]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5872213710564976, 'mean_inference_ms': 8.651466443338945, 'mean_action_processing_ms': 0.11549467474923797, 'mean_env_wait_ms': 0.2186108066642818, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2493300437927246, 'StateBufferConnector_ms': 0.007111310958862305, 'ViewRequirementAgentConnector_ms': 0.16119909286499023}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.05, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 380000, 'num_agent_steps_trained': 380000, 'num_env_steps_sampled': 380000, 'num_env_steps_trained': 380000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 20.461737374861094, 'num_env_steps_trained_throughput_per_sec': 20.461737374861094, 'timesteps_total': 380000, 'num_env_steps_sampled_lifetime': 380000, 'num_agent_steps_sampled_lifetime': 380000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 380000, 'timers': {'training_iteration_time_ms': 192887.107, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 192887.107, 'sample_time_ms': 21404.469, 'load_time_ms': 5.401, 'load_throughput': 740588.42, 'learn_time_ms': 171460.556, 'learn_throughput': 23.329, 'synch_weights_time_ms': 16.327}, 'counters': {'num_env_steps_sampled': 380000, 'num_env_steps_trained': 380000, 'num_agent_steps_sampled': 380000, 'num_agent_steps_trained': 380000}, 'done': False, 'episodes_total': 474, 'training_iteration': 95, 'trial_id': 'default', 'date': '2024-05-10_16-35-50', 'timestamp': 1715355350, 'time_this_iter_s': 195.51636934280396, 'time_total_s': 15205.134588718414, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 15205.134588718414, 'iterations_since_restore': 95, 'perf': {'cpu_util_percent': 40.417328519855594, 'ram_util_percent': 66.01696750902528}}
	Step: 95
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.412538655462765, 'cur_kl_coeff': 0.0018771171569824214, 'cur_lr': 5.0000000000000016e-05, 'total_loss': -0.0011418835370130436, 'policy_loss': -0.007130049872061899, 'vf_loss': 0.0059778563709246115, 'vf_explained_var': 0.09381544250313954, 'kl': 0.005491538527818931, 'entropy': 0.566357920022421, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 88815.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 384000, 'num_env_steps_trained': 384000, 'num_agent_steps_sampled': 384000, 'num_agent_steps_trained': 384000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.11, 'episode_len_mean': 921.24, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 92124, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 3.0, 4.0, 4.0, 3.0, 2.0, 3.0, 0.0, 0.0, 3.0, 4.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 5.0, 0.0, 2.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 3.0, 3.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 5.0, 0.0, 3.0, 2.0], 'episode_lengths': [1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021, 1016, 816, 856, 1020, 1232, 1240, 1020, 803, 1052, 545, 559, 1053, 1201, 1004, 849, 608, 857, 537, 869, 872, 872, 838, 815, 1084, 1486, 539, 870, 589, 854, 1053, 616, 580, 1029, 1057, 906, 863, 1023, 1076, 683, 1014, 1147, 1240, 946, 1129, 1522, 620, 1183, 1074]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5880758195298413, 'mean_inference_ms': 8.657000460430856, 'mean_action_processing_ms': 0.11568819192809224, 'mean_env_wait_ms': 0.21892350551040207, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2507810592651367, 'StateBufferConnector_ms': 0.007111310958862305, 'ViewRequirementAgentConnector_ms': 0.1582627296447754}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.11}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.11, 'episode_len_mean': 921.24, 'episode_media': {}, 'episodes_this_iter': 4, 'episodes_timesteps_total': 92124, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 3.0, 4.0, 4.0, 3.0, 2.0, 3.0, 0.0, 0.0, 3.0, 4.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 5.0, 0.0, 2.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 3.0, 3.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 5.0, 0.0, 3.0, 2.0], 'episode_lengths': [1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021, 1016, 816, 856, 1020, 1232, 1240, 1020, 803, 1052, 545, 559, 1053, 1201, 1004, 849, 608, 857, 537, 869, 872, 872, 838, 815, 1084, 1486, 539, 870, 589, 854, 1053, 616, 580, 1029, 1057, 906, 863, 1023, 1076, 683, 1014, 1147, 1240, 946, 1129, 1522, 620, 1183, 1074]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5880758195298413, 'mean_inference_ms': 8.657000460430856, 'mean_action_processing_ms': 0.11568819192809224, 'mean_env_wait_ms': 0.21892350551040207, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2507810592651367, 'StateBufferConnector_ms': 0.007111310958862305, 'ViewRequirementAgentConnector_ms': 0.1582627296447754}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.11}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.11, 'episode_len_mean': 921.24, 'episodes_this_iter': 4, 'episodes_timesteps_total': 92124, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 3.0, 4.0, 4.0, 3.0, 2.0, 3.0, 0.0, 0.0, 3.0, 4.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 5.0, 0.0, 2.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 3.0, 3.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 5.0, 0.0, 3.0, 2.0], 'episode_lengths': [1057, 1140, 1188, 823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021, 1016, 816, 856, 1020, 1232, 1240, 1020, 803, 1052, 545, 559, 1053, 1201, 1004, 849, 608, 857, 537, 869, 872, 872, 838, 815, 1084, 1486, 539, 870, 589, 854, 1053, 616, 580, 1029, 1057, 906, 863, 1023, 1076, 683, 1014, 1147, 1240, 946, 1129, 1522, 620, 1183, 1074]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5880758195298413, 'mean_inference_ms': 8.657000460430856, 'mean_action_processing_ms': 0.11568819192809224, 'mean_env_wait_ms': 0.21892350551040207, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2507810592651367, 'StateBufferConnector_ms': 0.007111310958862305, 'ViewRequirementAgentConnector_ms': 0.1582627296447754}, 'num_episodes': 4, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.11, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 384000, 'num_agent_steps_trained': 384000, 'num_env_steps_sampled': 384000, 'num_env_steps_trained': 384000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 20.876814445047504, 'num_env_steps_trained_throughput_per_sec': 20.876814445047504, 'timesteps_total': 384000, 'num_env_steps_sampled_lifetime': 384000, 'num_agent_steps_sampled_lifetime': 384000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 384000, 'timers': {'training_iteration_time_ms': 193084.236, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 193084.236, 'sample_time_ms': 21389.445, 'load_time_ms': 5.336, 'load_throughput': 749565.109, 'learn_time_ms': 171672.981, 'learn_throughput': 23.3, 'synch_weights_time_ms': 16.217}, 'counters': {'num_env_steps_sampled': 384000, 'num_env_steps_trained': 384000, 'num_agent_steps_sampled': 384000, 'num_agent_steps_trained': 384000}, 'done': False, 'episodes_total': 478, 'training_iteration': 96, 'trial_id': 'default', 'date': '2024-05-10_16-39-02', 'timestamp': 1715355542, 'time_this_iter_s': 191.6298632621765, 'time_total_s': 15396.76445198059, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 15396.76445198059, 'iterations_since_restore': 96, 'perf': {'cpu_util_percent': 41.16605166051661, 'ram_util_percent': 65.92546125461256}}
	Step: 96
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.0791555510893944, 'cur_kl_coeff': 0.0018771171569824214, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.003409507464785229, 'policy_loss': -0.0004371777116771667, 'vf_loss': 0.0038357852363235427, 'vf_explained_var': 0.42160268451577876, 'kl': 0.005805286839905418, 'entropy': 0.5841343807917769, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 89745.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 388000, 'num_env_steps_trained': 388000, 'num_agent_steps_sampled': 388000, 'num_agent_steps_trained': 388000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.08, 'episode_len_mean': 916.43, 'episode_media': {}, 'episodes_this_iter': 3, 'episodes_timesteps_total': 91643, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 3.0, 4.0, 4.0, 3.0, 2.0, 3.0, 0.0, 0.0, 3.0, 4.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 5.0, 0.0, 2.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 3.0, 3.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 5.0, 0.0, 3.0, 2.0, 2.0, 2.0, 3.0], 'episode_lengths': [823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021, 1016, 816, 856, 1020, 1232, 1240, 1020, 803, 1052, 545, 559, 1053, 1201, 1004, 849, 608, 857, 537, 869, 872, 872, 838, 815, 1084, 1486, 539, 870, 589, 854, 1053, 616, 580, 1029, 1057, 906, 863, 1023, 1076, 683, 1014, 1147, 1240, 946, 1129, 1522, 620, 1183, 1074, 956, 895, 1053]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5886951244839829, 'mean_inference_ms': 8.66123947224174, 'mean_action_processing_ms': 0.1158100234172598, 'mean_env_wait_ms': 0.21915523481633678, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.253833532333374, 'StateBufferConnector_ms': 0.007111310958862305, 'ViewRequirementAgentConnector_ms': 0.15567231178283691}, 'num_episodes': 3, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.08}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.08, 'episode_len_mean': 916.43, 'episode_media': {}, 'episodes_this_iter': 3, 'episodes_timesteps_total': 91643, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 3.0, 4.0, 4.0, 3.0, 2.0, 3.0, 0.0, 0.0, 3.0, 4.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 5.0, 0.0, 2.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 3.0, 3.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 5.0, 0.0, 3.0, 2.0, 2.0, 2.0, 3.0], 'episode_lengths': [823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021, 1016, 816, 856, 1020, 1232, 1240, 1020, 803, 1052, 545, 559, 1053, 1201, 1004, 849, 608, 857, 537, 869, 872, 872, 838, 815, 1084, 1486, 539, 870, 589, 854, 1053, 616, 580, 1029, 1057, 906, 863, 1023, 1076, 683, 1014, 1147, 1240, 946, 1129, 1522, 620, 1183, 1074, 956, 895, 1053]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5886951244839829, 'mean_inference_ms': 8.66123947224174, 'mean_action_processing_ms': 0.1158100234172598, 'mean_env_wait_ms': 0.21915523481633678, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.253833532333374, 'StateBufferConnector_ms': 0.007111310958862305, 'ViewRequirementAgentConnector_ms': 0.15567231178283691}, 'num_episodes': 3, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.08}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.08, 'episode_len_mean': 916.43, 'episodes_this_iter': 3, 'episodes_timesteps_total': 91643, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [2.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 3.0, 4.0, 4.0, 3.0, 2.0, 3.0, 0.0, 0.0, 3.0, 4.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 5.0, 0.0, 2.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 3.0, 3.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 5.0, 0.0, 3.0, 2.0, 2.0, 2.0, 3.0], 'episode_lengths': [823, 986, 910, 659, 873, 869, 855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021, 1016, 816, 856, 1020, 1232, 1240, 1020, 803, 1052, 545, 559, 1053, 1201, 1004, 849, 608, 857, 537, 869, 872, 872, 838, 815, 1084, 1486, 539, 870, 589, 854, 1053, 616, 580, 1029, 1057, 906, 863, 1023, 1076, 683, 1014, 1147, 1240, 946, 1129, 1522, 620, 1183, 1074, 956, 895, 1053]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5886951244839829, 'mean_inference_ms': 8.66123947224174, 'mean_action_processing_ms': 0.1158100234172598, 'mean_env_wait_ms': 0.21915523481633678, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.253833532333374, 'StateBufferConnector_ms': 0.007111310958862305, 'ViewRequirementAgentConnector_ms': 0.15567231178283691}, 'num_episodes': 3, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.08, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 388000, 'num_agent_steps_trained': 388000, 'num_env_steps_sampled': 388000, 'num_env_steps_trained': 388000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 20.40583458071924, 'num_env_steps_trained_throughput_per_sec': 20.40583458071924, 'timesteps_total': 388000, 'num_env_steps_sampled_lifetime': 388000, 'num_agent_steps_sampled_lifetime': 388000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 388000, 'timers': {'training_iteration_time_ms': 193115.319, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 193115.319, 'sample_time_ms': 21406.054, 'load_time_ms': 4.936, 'load_throughput': 810415.226, 'learn_time_ms': 171687.927, 'learn_throughput': 23.298, 'synch_weights_time_ms': 16.144}, 'counters': {'num_env_steps_sampled': 388000, 'num_env_steps_trained': 388000, 'num_agent_steps_sampled': 388000, 'num_agent_steps_trained': 388000}, 'done': False, 'episodes_total': 481, 'training_iteration': 97, 'trial_id': 'default', 'date': '2024-05-10_16-42-18', 'timestamp': 1715355738, 'time_this_iter_s': 196.05406260490417, 'time_total_s': 15592.818514585495, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 15592.818514585495, 'iterations_since_restore': 97, 'perf': {'cpu_util_percent': 40.64837545126353, 'ram_util_percent': 65.6653429602888}}
	Step: 97
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 1.1027507118319952, 'cur_kl_coeff': 0.0018771171569824214, 'cur_lr': 5.0000000000000016e-05, 'total_loss': 0.005904311545553707, 'policy_loss': 0.001246683978505673, 'vf_loss': 0.0046443180431128646, 'vf_explained_var': -0.22039429910721317, 'kl': 0.007090157331005151, 'entropy': 0.5332779423844429, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 90675.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 392000, 'num_env_steps_trained': 392000, 'num_agent_steps_sampled': 392000, 'num_agent_steps_trained': 392000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.09, 'episode_len_mean': 916.33, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 91633, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 3.0, 4.0, 4.0, 3.0, 2.0, 3.0, 0.0, 0.0, 3.0, 4.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 5.0, 0.0, 2.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 3.0, 3.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 5.0, 0.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 4.0, 0.0], 'episode_lengths': [855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021, 1016, 816, 856, 1020, 1232, 1240, 1020, 803, 1052, 545, 559, 1053, 1201, 1004, 849, 608, 857, 537, 869, 872, 872, 838, 815, 1084, 1486, 539, 870, 589, 854, 1053, 616, 580, 1029, 1057, 906, 863, 1023, 1076, 683, 1014, 1147, 1240, 946, 1129, 1522, 620, 1183, 1074, 956, 895, 1053, 891, 547, 828, 1020, 1212, 612]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5901792147286937, 'mean_inference_ms': 8.670252325617902, 'mean_action_processing_ms': 0.11617301859369293, 'mean_env_wait_ms': 0.21969279560159097, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.26178526878356934, 'StateBufferConnector_ms': 0.007111310958862305, 'ViewRequirementAgentConnector_ms': 0.15343260765075684}, 'num_episodes': 6, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.09}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.09, 'episode_len_mean': 916.33, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 91633, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 3.0, 4.0, 4.0, 3.0, 2.0, 3.0, 0.0, 0.0, 3.0, 4.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 5.0, 0.0, 2.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 3.0, 3.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 5.0, 0.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 4.0, 0.0], 'episode_lengths': [855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021, 1016, 816, 856, 1020, 1232, 1240, 1020, 803, 1052, 545, 559, 1053, 1201, 1004, 849, 608, 857, 537, 869, 872, 872, 838, 815, 1084, 1486, 539, 870, 589, 854, 1053, 616, 580, 1029, 1057, 906, 863, 1023, 1076, 683, 1014, 1147, 1240, 946, 1129, 1522, 620, 1183, 1074, 956, 895, 1053, 891, 547, 828, 1020, 1212, 612]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5901792147286937, 'mean_inference_ms': 8.670252325617902, 'mean_action_processing_ms': 0.11617301859369293, 'mean_env_wait_ms': 0.21969279560159097, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.26178526878356934, 'StateBufferConnector_ms': 0.007111310958862305, 'ViewRequirementAgentConnector_ms': 0.15343260765075684}, 'num_episodes': 6, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.09}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.09, 'episode_len_mean': 916.33, 'episodes_this_iter': 6, 'episodes_timesteps_total': 91633, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 3.0, 4.0, 4.0, 3.0, 2.0, 3.0, 0.0, 0.0, 3.0, 4.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 5.0, 0.0, 2.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 3.0, 3.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 5.0, 0.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 4.0, 0.0], 'episode_lengths': [855, 972, 891, 920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021, 1016, 816, 856, 1020, 1232, 1240, 1020, 803, 1052, 545, 559, 1053, 1201, 1004, 849, 608, 857, 537, 869, 872, 872, 838, 815, 1084, 1486, 539, 870, 589, 854, 1053, 616, 580, 1029, 1057, 906, 863, 1023, 1076, 683, 1014, 1147, 1240, 946, 1129, 1522, 620, 1183, 1074, 956, 895, 1053, 891, 547, 828, 1020, 1212, 612]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5901792147286937, 'mean_inference_ms': 8.670252325617902, 'mean_action_processing_ms': 0.11617301859369293, 'mean_env_wait_ms': 0.21969279560159097, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.26178526878356934, 'StateBufferConnector_ms': 0.007111310958862305, 'ViewRequirementAgentConnector_ms': 0.15343260765075684}, 'num_episodes': 6, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.09, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 392000, 'num_agent_steps_trained': 392000, 'num_env_steps_sampled': 392000, 'num_env_steps_trained': 392000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 19.61017801071501, 'num_env_steps_trained_throughput_per_sec': 19.61017801071501, 'timesteps_total': 392000, 'num_env_steps_sampled_lifetime': 392000, 'num_agent_steps_sampled_lifetime': 392000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 392000, 'timers': {'training_iteration_time_ms': 194527.609, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 194527.609, 'sample_time_ms': 21397.864, 'load_time_ms': 5.37, 'load_throughput': 744833.073, 'learn_time_ms': 173107.239, 'learn_throughput': 23.107, 'synch_weights_time_ms': 16.776}, 'counters': {'num_env_steps_sampled': 392000, 'num_env_steps_trained': 392000, 'num_agent_steps_sampled': 392000, 'num_agent_steps_trained': 392000}, 'done': False, 'episodes_total': 487, 'training_iteration': 98, 'trial_id': 'default', 'date': '2024-05-10_16-45-42', 'timestamp': 1715355942, 'time_this_iter_s': 204.00317573547363, 'time_total_s': 15796.821690320969, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 15796.821690320969, 'iterations_since_restore': 98, 'perf': {'cpu_util_percent': 48.248096885813155, 'ram_util_percent': 65.34359861591695}}
	Step: 98
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 0.9809221952432586, 'cur_kl_coeff': 0.0018771171569824214, 'cur_lr': 5.0000000000000016e-05, 'total_loss': -0.005612144836535057, 'policy_loss': -0.009764465503394604, 'vf_loss': 0.004141854034938289, 'vf_explained_var': -0.026408246512054114, 'kl': 0.005575267796276073, 'entropy': 0.5303719839742107, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 91605.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 396000, 'num_env_steps_trained': 396000, 'num_agent_steps_sampled': 396000, 'num_agent_steps_trained': 396000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.07, 'episode_len_mean': 915.13, 'episode_media': {}, 'episodes_this_iter': 3, 'episodes_timesteps_total': 91513, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 3.0, 4.0, 4.0, 3.0, 2.0, 3.0, 0.0, 0.0, 3.0, 4.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 5.0, 0.0, 2.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 3.0, 3.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 5.0, 0.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 4.0, 0.0, 0.0, 0.0, 4.0], 'episode_lengths': [920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021, 1016, 816, 856, 1020, 1232, 1240, 1020, 803, 1052, 545, 559, 1053, 1201, 1004, 849, 608, 857, 537, 869, 872, 872, 838, 815, 1084, 1486, 539, 870, 589, 854, 1053, 616, 580, 1029, 1057, 906, 863, 1023, 1076, 683, 1014, 1147, 1240, 946, 1129, 1522, 620, 1183, 1074, 956, 895, 1053, 891, 547, 828, 1020, 1212, 612, 629, 684, 1285]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5909652350414727, 'mean_inference_ms': 8.675137747731148, 'mean_action_processing_ms': 0.11633357997022832, 'mean_env_wait_ms': 0.21998191103492915, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2600517272949219, 'StateBufferConnector_ms': 0.007111310958862305, 'ViewRequirementAgentConnector_ms': 0.15748357772827148}, 'num_episodes': 3, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.07}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.07, 'episode_len_mean': 915.13, 'episode_media': {}, 'episodes_this_iter': 3, 'episodes_timesteps_total': 91513, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 3.0, 4.0, 4.0, 3.0, 2.0, 3.0, 0.0, 0.0, 3.0, 4.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 5.0, 0.0, 2.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 3.0, 3.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 5.0, 0.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 4.0, 0.0, 0.0, 0.0, 4.0], 'episode_lengths': [920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021, 1016, 816, 856, 1020, 1232, 1240, 1020, 803, 1052, 545, 559, 1053, 1201, 1004, 849, 608, 857, 537, 869, 872, 872, 838, 815, 1084, 1486, 539, 870, 589, 854, 1053, 616, 580, 1029, 1057, 906, 863, 1023, 1076, 683, 1014, 1147, 1240, 946, 1129, 1522, 620, 1183, 1074, 956, 895, 1053, 891, 547, 828, 1020, 1212, 612, 629, 684, 1285]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5909652350414727, 'mean_inference_ms': 8.675137747731148, 'mean_action_processing_ms': 0.11633357997022832, 'mean_env_wait_ms': 0.21998191103492915, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2600517272949219, 'StateBufferConnector_ms': 0.007111310958862305, 'ViewRequirementAgentConnector_ms': 0.15748357772827148}, 'num_episodes': 3, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.07}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.07, 'episode_len_mean': 915.13, 'episodes_this_iter': 3, 'episodes_timesteps_total': 91513, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [2.0, 2.0, 2.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 3.0, 4.0, 4.0, 3.0, 2.0, 3.0, 0.0, 0.0, 3.0, 4.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 5.0, 0.0, 2.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 3.0, 3.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 5.0, 0.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 4.0, 0.0, 0.0, 0.0, 4.0], 'episode_lengths': [920, 844, 948, 1069, 696, 645, 936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021, 1016, 816, 856, 1020, 1232, 1240, 1020, 803, 1052, 545, 559, 1053, 1201, 1004, 849, 608, 857, 537, 869, 872, 872, 838, 815, 1084, 1486, 539, 870, 589, 854, 1053, 616, 580, 1029, 1057, 906, 863, 1023, 1076, 683, 1014, 1147, 1240, 946, 1129, 1522, 620, 1183, 1074, 956, 895, 1053, 891, 547, 828, 1020, 1212, 612, 629, 684, 1285]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.5909652350414727, 'mean_inference_ms': 8.675137747731148, 'mean_action_processing_ms': 0.11633357997022832, 'mean_env_wait_ms': 0.21998191103492915, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.2600517272949219, 'StateBufferConnector_ms': 0.007111310958862305, 'ViewRequirementAgentConnector_ms': 0.15748357772827148}, 'num_episodes': 3, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.07, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 396000, 'num_agent_steps_trained': 396000, 'num_env_steps_sampled': 396000, 'num_env_steps_trained': 396000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 19.376936121024837, 'num_env_steps_trained_throughput_per_sec': 19.376936121024837, 'timesteps_total': 396000, 'num_env_steps_sampled_lifetime': 396000, 'num_agent_steps_sampled_lifetime': 396000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 396000, 'timers': {'training_iteration_time_ms': 195722.663, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 195722.663, 'sample_time_ms': 21584.65, 'load_time_ms': 5.521, 'load_throughput': 724520.584, 'learn_time_ms': 174115.191, 'learn_throughput': 22.973, 'synch_weights_time_ms': 16.891}, 'counters': {'num_env_steps_sampled': 396000, 'num_env_steps_trained': 396000, 'num_agent_steps_sampled': 396000, 'num_agent_steps_trained': 396000}, 'done': False, 'episodes_total': 490, 'training_iteration': 99, 'trial_id': 'default', 'date': '2024-05-10_16-49-08', 'timestamp': 1715356148, 'time_this_iter_s': 206.4614963531494, 'time_total_s': 16003.283186674118, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 16003.283186674118, 'iterations_since_restore': 99, 'perf': {'cpu_util_percent': 51.66597938144329, 'ram_util_percent': 65.40137457044673}}
	Step: 99
{'custom_metrics': {}, 'episode_media': {}, 'info': {'learner': {'default_policy': {'learner_stats': {'allreduce_latency': 0.0, 'grad_gnorm': 0.8831239355948343, 'cur_kl_coeff': 0.0018771171569824214, 'cur_lr': 5.0000000000000016e-05, 'total_loss': -0.0004982707401116689, 'policy_loss': -0.003439254698253447, 'vf_loss': 0.0029248485171309013, 'vf_explained_var': -0.10901017522299161, 'kl': 0.008595311488862736, 'entropy': 0.4924059379805801, 'entropy_coeff': 0.0}, 'model': {}, 'custom_metrics': {}, 'num_agent_steps_trained': 128.0, 'num_grad_updates_lifetime': 92535.5, 'diff_num_grad_updates_vs_sampler_policy': 464.5}}, 'num_env_steps_sampled': 400000, 'num_env_steps_trained': 400000, 'num_agent_steps_sampled': 400000, 'num_agent_steps_trained': 400000}, 'sampler_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.09, 'episode_len_mean': 914.75, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 91475, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 3.0, 4.0, 4.0, 3.0, 2.0, 3.0, 0.0, 0.0, 3.0, 4.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 5.0, 0.0, 2.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 3.0, 3.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 5.0, 0.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 4.0, 0.0, 0.0, 0.0, 4.0, 2.0, 2.0, 0.0, 3.0, 2.0, 2.0], 'episode_lengths': [936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021, 1016, 816, 856, 1020, 1232, 1240, 1020, 803, 1052, 545, 559, 1053, 1201, 1004, 849, 608, 857, 537, 869, 872, 872, 838, 815, 1084, 1486, 539, 870, 589, 854, 1053, 616, 580, 1029, 1057, 906, 863, 1023, 1076, 683, 1014, 1147, 1240, 946, 1129, 1522, 620, 1183, 1074, 956, 895, 1053, 891, 547, 828, 1020, 1212, 612, 629, 684, 1285, 835, 851, 597, 991, 848, 962]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.592787052097564, 'mean_inference_ms': 8.685958891146274, 'mean_action_processing_ms': 0.11674803762667238, 'mean_env_wait_ms': 0.2206237659169766, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.25771641731262207, 'StateBufferConnector_ms': 0.007111310958862305, 'ViewRequirementAgentConnector_ms': 0.1529245376586914}, 'num_episodes': 6, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.09}, 'env_runner_results': {'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.09, 'episode_len_mean': 914.75, 'episode_media': {}, 'episodes_this_iter': 6, 'episodes_timesteps_total': 91475, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'custom_metrics': {}, 'hist_stats': {'episode_reward': [0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 3.0, 4.0, 4.0, 3.0, 2.0, 3.0, 0.0, 0.0, 3.0, 4.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 5.0, 0.0, 2.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 3.0, 3.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 5.0, 0.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 4.0, 0.0, 0.0, 0.0, 4.0, 2.0, 2.0, 0.0, 3.0, 2.0, 2.0], 'episode_lengths': [936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021, 1016, 816, 856, 1020, 1232, 1240, 1020, 803, 1052, 545, 559, 1053, 1201, 1004, 849, 608, 857, 537, 869, 872, 872, 838, 815, 1084, 1486, 539, 870, 589, 854, 1053, 616, 580, 1029, 1057, 906, 863, 1023, 1076, 683, 1014, 1147, 1240, 946, 1129, 1522, 620, 1183, 1074, 956, 895, 1053, 891, 547, 828, 1020, 1212, 612, 629, 684, 1285, 835, 851, 597, 991, 848, 962]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.592787052097564, 'mean_inference_ms': 8.685958891146274, 'mean_action_processing_ms': 0.11674803762667238, 'mean_env_wait_ms': 0.2206237659169766, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.25771641731262207, 'StateBufferConnector_ms': 0.007111310958862305, 'ViewRequirementAgentConnector_ms': 0.1529245376586914}, 'num_episodes': 6, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.09}, 'episode_reward_max': 5.0, 'episode_reward_min': 0.0, 'episode_reward_mean': 2.09, 'episode_len_mean': 914.75, 'episodes_this_iter': 6, 'episodes_timesteps_total': 91475, 'policy_reward_min': {}, 'policy_reward_max': {}, 'policy_reward_mean': {}, 'hist_stats': {'episode_reward': [0.0, 3.0, 3.0, 4.0, 2.0, 2.0, 3.0, 2.0, 2.0, 0.0, 3.0, 0.0, 2.0, 0.0, 3.0, 2.0, 3.0, 3.0, 4.0, 4.0, 2.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 2.0, 2.0, 4.0, 2.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 3.0, 4.0, 4.0, 3.0, 2.0, 3.0, 0.0, 0.0, 3.0, 4.0, 3.0, 2.0, 0.0, 2.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 5.0, 0.0, 2.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 2.0, 2.0, 3.0, 3.0, 0.0, 2.0, 3.0, 3.0, 2.0, 3.0, 5.0, 0.0, 3.0, 2.0, 2.0, 2.0, 3.0, 2.0, 0.0, 2.0, 3.0, 4.0, 0.0, 0.0, 0.0, 4.0, 2.0, 2.0, 0.0, 3.0, 2.0, 2.0], 'episode_lengths': [936, 1060, 1005, 1248, 950, 897, 1033, 807, 876, 728, 1033, 680, 813, 548, 1005, 827, 1056, 1052, 1288, 1216, 850, 545, 914, 556, 603, 1268, 508, 839, 868, 1185, 822, 1029, 996, 1021, 1016, 816, 856, 1020, 1232, 1240, 1020, 803, 1052, 545, 559, 1053, 1201, 1004, 849, 608, 857, 537, 869, 872, 872, 838, 815, 1084, 1486, 539, 870, 589, 854, 1053, 616, 580, 1029, 1057, 906, 863, 1023, 1076, 683, 1014, 1147, 1240, 946, 1129, 1522, 620, 1183, 1074, 956, 895, 1053, 891, 547, 828, 1020, 1212, 612, 629, 684, 1285, 835, 851, 597, 991, 848, 962]}, 'sampler_perf': {'mean_raw_obs_processing_ms': 0.592787052097564, 'mean_inference_ms': 8.685958891146274, 'mean_action_processing_ms': 0.11674803762667238, 'mean_env_wait_ms': 0.2206237659169766, 'mean_env_render_ms': 0.0}, 'num_faulty_episodes': 0, 'connector_metrics': {'ObsPreprocessorConnector_ms': 0.25771641731262207, 'StateBufferConnector_ms': 0.007111310958862305, 'ViewRequirementAgentConnector_ms': 0.1529245376586914}, 'num_episodes': 6, 'episode_return_max': 5.0, 'episode_return_min': 0.0, 'episode_return_mean': 2.09, 'num_healthy_workers': 2, 'num_in_flight_async_reqs': 0, 'num_remote_worker_restarts': 0, 'num_agent_steps_sampled': 400000, 'num_agent_steps_trained': 400000, 'num_env_steps_sampled': 400000, 'num_env_steps_trained': 400000, 'num_env_steps_sampled_this_iter': 4000, 'num_env_steps_trained_this_iter': 4000, 'num_env_steps_sampled_throughput_per_sec': 19.873915918911866, 'num_env_steps_trained_throughput_per_sec': 19.873915918911866, 'timesteps_total': 400000, 'num_env_steps_sampled_lifetime': 400000, 'num_agent_steps_sampled_lifetime': 400000, 'num_steps_trained_this_iter': 4000, 'agent_timesteps_total': 400000, 'timers': {'training_iteration_time_ms': 196905.184, 'restore_workers_time_ms': 0.0, 'training_step_time_ms': 196905.184, 'sample_time_ms': 21830.147, 'load_time_ms': 5.482, 'load_throughput': 729663.073, 'learn_time_ms': 175052.344, 'learn_throughput': 22.85, 'synch_weights_time_ms': 16.702}, 'counters': {'num_env_steps_sampled': 400000, 'num_env_steps_trained': 400000, 'num_agent_steps_sampled': 400000, 'num_agent_steps_trained': 400000}, 'done': False, 'episodes_total': 496, 'training_iteration': 100, 'trial_id': 'default', 'date': '2024-05-10_16-52-30', 'timestamp': 1715356350, 'time_this_iter_s': 201.30028796195984, 'time_total_s': 16204.583474636078, 'pid': 18320, 'hostname': 'LAPTOP-BH8MNAUL', 'node_ip': '127.0.0.1', 'config': {'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0.1, '_fake_gpus': False, 'num_learner_workers': 0, 'num_gpus_per_learner_worker': 0, 'num_cpus_per_learner_worker': 1, 'local_gpu_idx': 0, 'custom_resources_per_worker': {}, 'placement_strategy': 'PACK', 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'inductor', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'onnxrt', 'torch_compile_worker_dynamo_mode': None, 'env': 'BreakoutNoFrameskip-v4', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'env_task_fn': None, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_envs_per_env_runner': 1, 'validate_env_runners_after_construction': True, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'NoFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'enable_connectors': True, 'sampler_perf_stats_ema_coef': None, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': None, 'grad_clip_by': 'global_norm', 'train_batch_size': 4000, 'train_batch_size_per_learner': None, 'model': {'_disable_preprocessor_api': False, '_disable_action_flattening': False, 'fcnet_hiddens': [3], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': [[16, [4, 4], 2], [32, [4, 4], 2], [512, [11, 11], 1]], 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 42, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'optimizer': {}, 'max_requests_in_flight_per_sampler_worker': 2, '_learner_class': None, 'explore': True, 'exploration_config': {'type': 'StochasticSampling'}, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002A3AAB65620>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'offline_sampling': False, 'evaluation_interval': None, 'evaluation_duration': 10, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': False, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': None, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'always_attach_evaluation_results': True, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'WARN', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, '_run_training_always_in_thread': False, '_evaluation_parallel_to_training_wo_thread': False, 'ignore_env_runner_failures': False, 'recreate_failed_env_runners': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 60, 'env_runner_restore_timeout_s': 1800, '_model_config_dict': {}, '_rl_module_spec': None, '_AlgorithmConfig__prior_exploration_config': None, '_enable_new_api_stack': False, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, 'evaluation_num_workers': -1, 'simple_optimizer': False, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'disable_env_checking': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'lr_schedule': None, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'sgd_minibatch_size': 128, 'mini_batch_size_per_learner': None, 'num_sgd_iter': 30, 'shuffle_sequences': True, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'entropy_coeff_schedule': None, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'vf_share_layers': -1, 'lambda': 1.0, 'input': 'sampler', 'policies': {'default_policy': (None, None, None, None)}, 'callbacks': <class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch', 'num_cpus_for_driver': 1, 'num_workers': 2}, 'time_since_restore': 16204.583474636078, 'iterations_since_restore': 100, 'perf': {'cpu_util_percent': 45.968771929824555, 'ram_util_percent': 65.65438596491228}}
Saving weights...
[36m(RolloutWorker pid=22672)[39m   logger.warn([32m [repeated 2x across cluster]